{"pages":[{"title":"About me","permalink":"http://yuannow.com/about/index.html","text":"Yuan Zhang"},{"title":"Gallary","permalink":"http://yuannow.com/gallary/index.html","text":"ç¬¬ä¸€æ³¢ ç¬¬äºŒæ³¢æœªå®Œå¾…ç»­â€¦â€¦"},{"title":"Links","permalink":"http://yuannow.com/links/index.html","text":""}],"posts":[{"title":"ç”¨Pythonåœ¨Hadoopä¸Šå®ç°æœç´¢è‡ªåŠ¨è¡¥å…¨","permalink":"http://yuannow.com/2017/10/09/Implement-Search-Auto-Complete-by-Python-Hadoop/","text":"è®°å¾—å¾ˆæ—©çš„æ—¶å€™ï¼Œåˆšå¼€å§‹æ¥è§¦æœç´¢å¼•æ“ï¼Œé‚£æ—¶å€™Googleè¿˜æ²¡æœ‰è¢«å¢™ï¼Œç™¾åº¦ä¹Ÿæ˜¯åˆšåˆšè¯ç”Ÿæ²¡å¤šä¹…ï¼Œæ— è®ºæˆ‘åœ¨è¾“å…¥æ¡†å†…è¾“å…¥ä»€ä¹ˆï¼Œåªæ˜¯æ˜¾ç¤ºæˆ‘è¾“å…¥çš„å†…å®¹ï¼Œå¹¶æ²¡æœ‰ä»»ä½•è”æƒ³åŠŸèƒ½æç¤ºæˆ‘æ¥ä¸‹æ¥å¯èƒ½åŒ¹é…çš„å†…å®¹ã€‚æœ‰æ—¶å€™æƒ³æ‰¾ä¸ªä¸œè¥¿ï¼Œå¯å°±æ˜¯æ­»æ´»æƒ³ä¸èµ·æ¥å‡†ç¡®çš„åå­—æˆ–è€…æè¿°æ–¹å¼ï¼Œè¿™ä¸ªæ—¶å€™æœç´¢å¼•æ“ä¹Ÿå¸®ä¸äº†ä½ ï¼Œä½ åªèƒ½å˜ç€æ³•çš„å°è¯•å„ç§è¾“å…¥ï¼Œæ¥å¯»æ±‚æœ€ç»ˆä½ æƒ³è¦çš„ç»“æœã€‚åæ¥æœç´¢å¼•æ“åŠ å…¥äº†è”æƒ³åŠŸèƒ½ï¼Œè¿™ç€å®æ˜¯ä¸€å¤§è¿›æ­¥ï¼Œæå¤§åœ°æé«˜äº†æœç´¢æ•ˆç‡ã€‚æœ‰çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯¹äºæƒ³æŸ¥è¯¢çš„æŸä¸€é—®é¢˜çš„æé—®æ–¹å¼æ˜¯å¾ˆæ¨¡ç³Šçš„ï¼Œè¿™ä¸ªæ—¶å€™å½“ä½ è¾“å…¥äº†ä¸€äº›å…³é”®è¯ï¼Œå‘ç°æœç´¢å¼•æ“ä¼šæ ¹æ®ä½ çš„è¾“å…¥ç»™ä½ ä¸€äº›åç»­å†…å®¹çš„å»ºè®®ï¼Œä¼šè®©ä½ æ›´å®¹æ˜“çš„æ‰¾åˆ°è‡ªå·±æƒ³è¦çš„ç­”æ¡ˆã€‚ æœ¬æ–‡ç›®çš„ä¸Šä¸€ç¯‡æˆ‘åœ¨ã€Šç”¨Pythonåœ¨Hadoopä¸Šè·‘MapReduceã€‹ä¸­ä»‹ç»äº†ä¸€äº›å…³äºå¦‚ä½•åˆ©ç”¨Hadoop Streamingè¿è¡ŒPythonç‰ˆMapReduceçš„ç®€å•æ“ä½œï¼Œå¦‚ä½•å®ç°è¯é¢‘ç»Ÿè®¡å°±åƒæ˜¯MapReduceä¸­çš„Hello Worldï¼Œä¸è¿‡åšå®Œäº†å…¥é—¨æ•™ç¨‹ï¼Œä¸ºäº†æ·±å…¥å­¦ä¹ ï¼Œè¿˜å¾—éœ€è¦æ›´å¤šçš„ç»ƒä¹ ã€‚ åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘å°†ä¼šå¸¦å„ä½å®ç°ä¸€ä¸ªå¾ˆç®€å•çš„æœç´¢è”æƒ³åŠŸèƒ½ï¼Œæ¯”è¾ƒç²—ç³™ï¼Œä½†æ˜¯çœ‹èµ·æ¥ä¹ŸæŒºåƒé‚£ä¹ˆå›äº‹çš„~ æ­£æ–‡ä¸ºäº†å®ç°autocompleteï¼Œé¦–å…ˆéœ€è¦ææ¸…æ¥šå®ƒèƒŒåçš„åŸç†ï¼Œæœç´¢å¼•æ“ç©¶ç«Ÿæ˜¯æ ¹æ®ä»€ä¹ˆæ¥ç»™å‡ºæç¤ºçš„ï¼Ÿæ¯”å¦‚æˆ‘è¾“å…¥ä¸€ä¸ªautocompleteä¹‹åï¼Œä¸ºä»€ä¹ˆåé¢æ¨èçš„æ˜¯pythonï¼Œalgorithmä¹‹ç±»çš„ï¼Œè€Œä¸æ˜¯Narutoï¼ŒOne Pieceè¿™äº›å‘¢ï¼Ÿ æ— è®ºæ˜¯ç™¾åº¦è¿˜æ˜¯è°·æ­Œï¼Œå…¶å®åœ¨å¤§å®¶ç”¨å®ƒä»¬çš„æœç´¢å¼•æ“æ”¶é›†ä½ éœ€è¦çš„ä¿¡æ¯çš„æ—¶å€™ï¼Œå®ƒä»¬ä¹ŸåŒæ ·åœ¨æ”¶é›†ä¿¡æ¯ã€‚å®ƒä»¬æ”¶é›†äº†å¤§é‡çš„ç”¨æˆ·æœç´¢çš„è¾“å…¥ä¿¡æ¯ï¼ŒåŒæ—¶è¿˜åœ¨æŠ“å–å„ç§ç½‘é¡µå†…å®¹çš„ä¿¡æ¯ï¼Œç®€å•æ¥è¯´ï¼Œæœç´¢å¼•æ“é€šè¿‡æŸç§ç®—æ³•å°†å„ç§æ”¶é›†åˆ°çš„èµ„æ–™ç»¼åˆåˆ°ä¸€èµ·ï¼Œæœ€ç»ˆç»™å‡ºäº†ä¸€ä¸ªè¾“å…¥è”æƒ³çš„åˆ—è¡¨ï¼Œè¿™å°±æ˜¯è‡ªåŠ¨è¡¥å…¨åŠŸèƒ½ã€‚ ç§ä¸‹é‡Œä½œä¸ºå­¦ä¹ MapReduceçš„é¡¹ç›®ï¼Œæˆ‘ä»¬è‚¯å®šä¸å¯èƒ½å»è¯•å›¾å®ç°çœŸæ­£çš„æœç´¢å¼•æ“ã€‚ä¸è¿‡åšä¸€ä¸ªç®€é™‹ç‰ˆçš„ï¼Œå¸®åŠ©è‡ªå·±ç†è§£autocompleteèƒŒåçš„å®ç°åŸç†ï¼Œä»¥åŠå¦‚ä½•åˆ©ç”¨MapReduceæ¥å®ç°ï¼Œä¹Ÿæ˜¯è¶³å¤Ÿçš„ã€‚ N-Gramå¯¹äºautocompleteèƒŒåå®ç°çš„åŸç†ï¼Œå¾ˆé‡è¦çš„ä¸€ç‚¹å°±æ˜¯N-Gramï¼Œè¿™ç¯‡æ–‡ç« æœ‰ç®€æ˜çš„ä»‹ç»ï¼Œä¸¾ä¸ªä¾‹å­å¥½äº†ï¼šimplement search autocomplete in python è¿™å¥è¯å¦‚æœæŒ‰2-Gramåˆ’åˆ†çš„è¯ï¼Œå°±æ˜¯implement searchï¼Œsearch autocompleteï¼Œautocomplete inï¼Œin pythonï¼› é‚£ä¹ˆæŒ‰ç…§3-Gramåˆ’åˆ†çš„è¯ï¼Œå°±æ˜¯implement search autocompleteï¼Œsearch autocomplete inï¼Œautocomplete in pythonï¼› æŒ‰ç…§4-Gramåˆ’åˆ†çš„è¯ï¼Œå°±æ˜¯implement search autocomplete inï¼Œsearch autocomplete in pythonï¼› æŒ‰ç…§5-Gramåˆ’åˆ†çš„è¯ï¼Œå°±æ˜¯ä¸€æ•´å¥è¯ï¼Œä¸ä½œä»»ä½•åˆ‡å‰²ã€‚ è¿™é‡Œæˆ‘æ²¡æœ‰ç»™å‡º1-Gramçš„ä¾‹å­ï¼Œå„ä½å¯ä»¥æ€è€ƒä¸€ä¸‹æ˜¯ä¸ºä»€ä¹ˆï¼Œè¿™é‡Œå…ˆå–ä¸ªå…³å­ï¼Œä¸‹é¢ä¼šæåˆ°åŸå› ã€‚è¿™é‡Œæˆ‘ä»¬å…ˆå›å¤´æ€è€ƒä¸€ä¸‹æœç´¢å¼•æ“ç»™å‡ºçš„è”æƒ³è¯æ±‡ï¼Œæ¯”å¦‚æˆ‘è¾“å…¥äº†ä¸€ä¸ªautocompleteï¼Œé‚£ä¹ˆåé¢ä½ è§‰å¾—æ˜¯ç»™å‡ºin pythonçœ‹ä¸Šå»æ›´è‡ªç„¶è¿˜æ˜¯Transformeræ›´åˆç†ï¼Ÿæ˜¾ç„¶æ˜¯å‰è€…å¯¹ä¹ˆï¼Œå¦‚æœç»™å‡ºäº†åè€…ï¼Œä½ å¯èƒ½ä¼šæƒ³ï¼šautocomplete Transformeræ˜¯ä»€ä¹ˆé¬¼ï¼Ÿï¼éš¾é“æ˜¯æŸç§æ–°å‹å˜å½¢é‡‘åˆšä¹ˆï¼Ÿæ²¡å¬è¿‡å•Šï¼é‚£ä¹‹æ‰€ä»¥ä¼šæœ‰è¿™æ ·çš„æ„Ÿè§‰ï¼Œæ˜¯å› ä¸ºä»æˆ‘ä»¬å¹³æ—¶è·å–çš„ä¿¡æ¯ä¸­ï¼Œæˆ‘ä»¬å¯¹äºautocompleteè¿™ä¸ªè¯åé¢çš„è¡”æ¥è¯æ¥æ”¶åˆ°çš„ä¹Ÿæ˜¯in pythonè¿œè¿œå¤šäºTransformerï¼Œå¯¹å§ï¼Ÿæ‰€ä»¥è¯´åˆ°è¿™é‡Œå°±å¤§æ¦‚æœ‰ç‚¹æ˜æ™°äº†ï¼Œæœç´¢å¼•æ“å¯¹äºè”æƒ³è¯æ±‡çš„æ¨èä¹Ÿæœ‰è¿™æ–¹é¢çš„è€ƒè™‘ï¼Œæˆ‘ä»¬ç»™è¾“å…¥ä¸€ä¸ªæˆ–å¤šä¸ªå¼•å¯¼è¯ï¼ŒautocompleteåŠŸèƒ½å°†åé¢æœ€æœ‰å¯èƒ½å‡ºç°çš„å‡ ç§é€‰æ‹©å±•ç°ç»™æˆ‘ä»¬ã€‚æ‰€ä»¥è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆç”¨åˆ°N-Gramçš„åŸå› ï¼Œè¿™é‡Œå…¶å®å°±æ˜¯ä¸€ä¸ªå¥å­åˆ†å‰²çš„è¿‡ç¨‹ã€‚ é‚£ä¹ˆè¿™é‡Œå°±å¼•å‡ºäº†ä¸‹ä¸€ä¸ªé—®é¢˜ï¼šæ˜¯è¯¥åŸºäºä¸€å¥è¯æœ€åä¸€ä¸ªè¯æ¥é¢„æµ‹åé¢çš„æ¨èï¼Œè¿˜æ˜¯æ ¹æ®æ›´å¤šçš„è¯ç”šè‡³ä¸€æ•´å¥æ¥é¢„æµ‹ä¸‹é¢çš„å‡ºç°å‘¢ï¼Ÿ è¿˜ç»§ç»­ä»¥ä¸Šé¢çš„ä¾‹å­è¯´å¥½äº†ã€‚å‡è®¾æˆ‘å·²ç»è¾“å…¥äº†implement search autocomplete inï¼Œå¦‚æœæ˜¯æŒ‰ç…§æœ€åä¸€ä¸ªå‡ºç°çš„è¯æ¥è¿›è¡Œè”æƒ³ï¼Œé‚£ä¹ˆinåé¢å…¶å®å¯ä»¥è·Ÿå¾ˆå¤šå¾ˆå¤šå†…å®¹ï¼Œéƒ½ä¸ä¼šè¿å’Œï¼Œå¯¹å§ï¼Ÿæ¯”å¦‚in boxï¼Œin airï¼Œin heartç­‰ç­‰ï¼Œä½†å¦‚æœæŠŠè¿™äº›è”æƒ³æ”¾åˆ°ä¸€æ•´å¥ä¸­ï¼Œæ˜¾ç„¶æ˜¯ä¸å¤ªåˆç†çš„ã€‚å› æ­¤ï¼Œæˆ‘ä»¬åœ¨å®ç°autocompleteçš„æ—¶å€™ï¼Œå…¶å®æ˜¯åŸºäºN-Gramé¢„æµ‹N-Gramã€‚ é‚£åˆ°è¿™é‡Œï¼Œå…¶å®autocompleteçš„å®ç°çš„å¤§è‡´æ€è·¯å°±åº”è¯¥æœ‰äº†ã€‚æˆ‘ä»¬éœ€è¦å°†å¤§æ‰¹é‡çš„æ–‡æ¡£ç”¨N-Gramçš„å¤„ç†æ–¹å¼è¿›è¡Œåˆ‡å‰²ï¼Œç»Ÿè®¡ç›¸åŒçŸ­è¯­å‡ºç°çš„é¢‘æ¬¡ï¼Œæ„å»ºN-Gramçš„æ¨¡å‹ï¼Œç„¶åæ‰¾å‡ºæ¯ä¸ªçŸ­è¯­ä¹‹åå‡ºç°é¢‘æ¬¡æœ€é«˜çš„å‡ ä¸ªè¯æ±‡ä½œä¸ºé¢„æµ‹ä¿å­˜ä¸‹æ¥ã€‚æœ€ç»ˆå°†ç»“æœå­˜å…¥æ•°æ®åº“ï¼Œä»¥æ–¹ä¾¿ä¹‹åè°ƒç”¨ã€‚ä¸‹é¢æˆ‘ä»¬å°±æ¥çœ‹çœ‹å¦‚ä½•ä¸€æ­¥æ­¥å…·ä½“å®ç°ã€‚ MapReduceå®ç°N-Gramæ¨¡å‹æ„å»ºåœ¨è¿™æ¬¡çš„ä»£ç å®ç°ä¸­ï¼Œæˆ‘ä»¬éœ€è¦ç”¨åˆ°ä¸¤ä¸ªmapperå’Œreducerã€‚é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦ä¸€å¯¹mapperå’Œreducerå°†è¾“å…¥çš„æ–‡æ¡£è¿›è¡Œåˆ‡å‰²ã€‚ n_gram_mapper.py 12345678910111213141516171819202122232425262728import sysimport stringimport re def main(N_Gram): for line in sys.stdin: # å»é™¤æ‰€æœ‰çš„æ ‡ç‚¹ç¬¦å· translator = str.maketrans(string.punctuation, \" \" * len(string.punctuation)) line = line.translate(translator).strip().lower() # å»é™¤æ‰€æœ‰çš„æ•°å­— line = re.sub(\"\\d\", \" \", line) # æŒ‰ç…§ç©ºæ ¼æˆ–è€…\\tæ¥åˆ‡å‰² words = re.split(\"\\\\s+\", line) if len(words) &lt; 2: continue for i, word in enumerate(words): result = word for j, next_word in enumerate(words[i+1:], 1): if j &lt; N_Gram: result += \" \" result += next_word print(\"&#123;&#125;\\t&#123;&#125;\".format(result, 1)) if __name__ == '__main__': main(5) å¦‚æœä½ æƒ³æ„å»ºä¸€ä¸ªN=5çš„N-Gramæ¨¡å‹ï¼Œé‚£ä¹ˆåœ¨mapperé‡Œï¼Œå°±éœ€è¦å°†2åˆ°5çš„åˆ†å‰²æ–¹å¼éƒ½è¾“å‡ºã€‚è¿˜è®°å¾—ä¸Šé¢æˆ‘æœ‰ç•™ä¸€ä¸ªæ‚¬å¿µï¼Œä¸ºä»€ä¹ˆä¸è€ƒè™‘1-Gramä¹ˆï¼Ÿå› ä¸ºæ˜¾ç„¶1-Gramæ˜¯æ²¡æœ‰ç”¨çš„ï¼Œå®ƒå¹¶ä¸èƒ½å‘Šè¯‰æˆ‘ä¸€ä¸ªçŸ­è¯­åé¢å¯èƒ½å‡ºç°çš„è¯æœ‰ä»€ä¹ˆã€‚ n_gram_reducer.py 1234567891011121314151617181920import sysfrom itertools import groupbyfrom operator import itemgetter def parse_output(std_input): # åˆ©ç”¨generatorèŠ‚çœMapReduceå†…å­˜ä½¿ç”¨ç©ºé—´ for line in std_input: yield line.strip().split(\"\\t\") def main(): data = parse_output(sys.stdin) for word, group in groupby(data, itemgetter(0)): try: total_count = sum(int(count) for word, count in group) print(\"&#123;&#125;\\t&#123;&#125;\".format(word, total_count)) except ValueError: continue if __name__ == '__main__': main() è¿™å›çš„reduceræˆ‘ç”¨åˆ°äº†generatoræ¥è°ƒç”¨æ•°æ®ï¼Œè¿™æ ·åšå¯ä»¥æœ‰æ•ˆèŠ‚çœå†…å­˜å ç”¨ç©ºé—´ã€‚å› ä¸ºéšç€è¾“å…¥æ•°æ®é‡çš„è¶Šæ¥è¶Šå¤§ï¼Œå³ä¾¿æ˜¯5-Gramï¼Œä¾ç„¶ä¹Ÿæ˜¯ä¸ªå¾ˆåºå¤§çš„è®°å½•æ•°é‡ã€‚ä¸‹é¢çš„ä¸»å‡½æ•°éƒ¨åˆ†ï¼Œæˆ‘ä¹Ÿæ”¾å¼ƒäº†ä¹‹å‰çš„ç®€å•ç”¨æ³•ï¼Œç”¨groupbyå¯ä»¥æ˜æ˜¾æå‡ä»£ç çš„é˜…è¯»é€»è¾‘ï¼Œå¯¹itertools.groupbyä¸å¤ªç†Ÿæ‚‰çš„æœ‹å‹å¯ä»¥çœ‹è¿™ä»½å®˜æ–¹æ–‡æ¡£ã€‚ N-Gramæµ‹è¯•ç»“æœåšä¸‹ä¸€æ­¥ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆæ¥æœ¬åœ°æµ‹è¯•ä¸€ä¸‹è¿™ä¸€å¯¹mapperå’Œreduceræ˜¯å¦å¥½ç”¨ã€‚ æµ‹è¯•æ–‡æ¡£ï¼šæˆ‘ç›´æ¥æŠŠMapReduceçš„Wikié‡Œå¤´ä¸€æ®µå…³äºå®ƒçš„è¯´æ˜è§£é‡Šï¼Œç²˜è´´ä¸‹æ¥ä½œä¸ºæµ‹è¯•æ–‡æ¡£ç”¨ã€‚ 1234567891011121314151617181920212223root@hadoop:~/src/p2py# cat input/file2.txt | ./n_gram_mapper.py | sort | ./n_gram_reducer.pya cluster 1a good 1a good mapreduce 1a good mapreduce algorithm 1a map 1a map procedure 1a map procedure method 1a map procedure method that 1a mapreduce 1a mapreduce program 1a mapreduce program is 1a mapreduce program is composed 1...and reduce 3and reduce capabilities 1and reduce functions 2...map and 3map and reduce 3map and reduce capabilities 1map and reduce functions 2... æˆ‘è¿™é‡Œå°±æˆªå–ä¸€éƒ¨åˆ†ç»“æœï¼Œå®åœ¨å¤ªé•¿äº†â€¦â€¦ æ„å»ºé¢„æµ‹æ¦‚ç‡çš„æ¨¡å‹æˆ‘ä»¬ç°åœ¨å·²ç»æœ‰äº†N-Gramåˆ‡å‰²åçš„ç»“æœäº†ï¼Œä¸‹ä¸€æ­¥å°±æ˜¯è¦åœ¨æ­¤åŸºç¡€ä¸Šåˆ†ææ¯ä¸€ä¸ªè¯æ±‡æˆ–è€…çŸ­è¯­åé¢å¯èƒ½å‡ºç°çš„å†…å®¹ï¼Œè¿™é‡Œå…¶å®å¯ä»¥ç†è§£æˆæ„å»ºä¸€ä¸ªæ¦‚ç‡æ¨¡å‹ï¼Œå¾ˆç®€å•ä¸€ä¸ªæ¦‚ç‡æ¨¡å‹ã€‚ ä¸¾ä¾‹è¯´æ˜ï¼Œæˆ‘ä»¬å…ˆæ¥çœ‹åˆšæ‰çš„ç»“æœç”Ÿæˆçš„ä¸€éƒ¨åˆ† 123456789and data 1and development 1and fault 3and generating 1and less 1and providing 1and reduce 3and scatter 1and sorting 1 å…ˆä»…ä»…åˆ†æandä¹‹åå¯èƒ½å‡ºç°çš„è¯æ±‡ï¼Œæ‰€æœ‰çš„æƒ…å†µéƒ½åœ¨è¿™é‡Œæ‘†ç€äº†ã€‚é‚£è¿™æ—¶å€™autocompleteä¼šå¦‚ä½•ç»™å‡ºæ¨èå‘¢ï¼Ÿå¾ˆæ˜¾ç„¶çš„ï¼Œfaultå’Œreduceä¼šæ”¾åˆ°å¤´ä¸¤ä¸ªæ¨èå¯¹å§ï¼Œä¸ºä»€ä¹ˆï¼Ÿè¿™å…¶å®å°±æ˜¯ä¸ªæ¦‚ç‡çš„é—®é¢˜ï¼šandåæ¥ä¸€ä¸ªè¯åœ¨æ–‡ä¸­å‡ºç°äº†1+1+3+1+1+1+3+1+1=13æ¬¡ï¼Œé‚£faultå’Œreduceæ¨èçš„æ¦‚ç‡å°±æ˜¯3/13ï¼Œå‰©ä¸‹çš„æ‰€æœ‰éƒ½æ˜¯1/13çš„æ¦‚ç‡ã€‚å¯¹äºautocompleteç³»ç»Ÿæ¥è¯´ï¼Œè¿™æ„å‘³ç€å½“ç”¨æˆ·è¾“å…¥äº†andä¹‹åï¼Œå®ƒè®¤ä¸ºç”¨æˆ·æ›´æœ‰å¯èƒ½ç»§ç»­è¾“å…¥çš„æ˜¯faultå’Œreduceï¼Œå› ä¸ºä»å®ƒä»¥å¾€ç»éªŒï¼ˆç³»ç»Ÿæ‰€å¾—åˆ°çš„è¾“å…¥ï¼‰æ¥çœ‹ï¼Œfaultå’Œreduceå‡ºç°çš„é¢‘æ¬¡æ›´å¤šä¸€äº›ï¼Œç›¸æ¯”è¾ƒäºå…¶ä»–çš„ç»“æœã€‚å› æ­¤ï¼Œä¸‹ä¸€æ­¥å·¥ä½œï¼Œæˆ‘ä»¬éœ€è¦å¾—åˆ°ä¸€ä¸ªç±»ä¼¼äºand&lt;\\t&gt;data=1è¿™æ ·çš„æ•°æ®è®°å½•æ ·å¼ï¼Œæ¥ç»Ÿè®¡æ‰€æœ‰çš„çŸ­è¯­ä¹‹åè·Ÿéšçš„è¯æ±‡ä»¥åŠå®ƒå‡ºç°çš„é¢‘æ¬¡ã€‚è¿™é‡Œæˆ‘ä»¬ä¹‹æ‰€ä»¥ä¸ç”¨æ¦‚ç‡æ¥è¿›è¡Œè®°å½•ï¼Œæ˜¯å› ä¸ºä»åˆšæ‰çš„è®¡ç®—è¿‡ç¨‹æ¥çœ‹ï¼Œè¯é¢‘å’Œæ¦‚ç‡æ˜¯æ­£ç›¸å…³çš„ï¼Œé‚£ä¹ˆå°±æ²¡å¿…è¦å¤šç®—ä¸€æ­¥è®°å½•æ¦‚ç‡äº†ã€‚ prob_mapper.py 1234567891011121314151617import sysimport string def main(threshold): for line in sys.stdin: words_phrase, count = line.strip().split(\"\\t\") if int(count) &lt; threshold: continue words = words_phrase.strip().split(\" \") if len(words) &lt; 2: continue print(\"&#123;&#125;\\t&#123;&#125;\".format(' '.join(words[:-1]), words[-1] + \"=\" + count)) if __name__ == '__main__': main(2) mapperçš„å·¥ä½œå…¶å®å¾ˆç®€å•ï¼ŒåŸºæœ¬æ²¡æœ‰ä»€ä¹ˆéœ€è¦è¯´æ˜çš„ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™é‡Œæˆ‘åŠ å…¥äº†ä¸€ä¸ªthresholdå‚æ•°ï¼Œæ„ä¹‰æ˜¯ä¸ºäº†ç­›é€‰æ‰ä¸€éƒ¨åˆ†å‡ºç°é¢‘æ¬¡å¤ªä½çš„ç»“æœã€‚åˆšæ‰ä¸¾çš„ä¾‹å­é‡Œï¼Œæ¯ä¸ªç»“æœå‡ºç°çš„é¢‘æ¬¡å…¶å®éƒ½ä¸é«˜ï¼Œè¿™æ ·thresholdè‚¯å®šæ˜¯æ²¡ç”¨çš„ï¼Œä½†å®é™…ç”Ÿäº§ä¸­ï¼Œæ¯”å¦‚åƒGoogleå’Œç™¾åº¦è¿™æ ·çš„è¶…å¤§è§„æ¨¡çš„æœç´¢å¼•æ“ï¼Œæ¯å¤©å¯èƒ½æŠ“å–çš„æ•°æ®é‡ååˆ†åºå¤§ã€‚äº‹å®ä¸Šï¼Œæˆ‘ä»¬æ¯æ¬¡åœ¨æœç´¢æ¡†ä¸­è¾“å…¥å†…å®¹ï¼Œå¾—åˆ°çš„è”æƒ³å…¶å®éƒ½åœ¨äºŒåæ¡ä»¥å†…ï¼Œä¸€èˆ¬æ¥è¯´ä¸ä¼šç»™å¤ªå¤šçš„ï¼Œå¤ªå¤šçš„è¯ï¼Œç”¨æˆ·ç­›é€‰èµ·æ¥ä¹Ÿæ˜¯ä¸ªéº»çƒ¦ã€‚é‚£å¯¹äºé‚£äº›åŸºæœ¬å¾ˆå°‘å‡ºç°çš„è¯ç»„ç»„åˆï¼Œä¹Ÿå°±æ²¡å¿…è¦å­˜å‚¨ä¸‹æ¥ï¼Œè¢«æœç´¢åˆ°çš„æ¦‚ç‡å¤ªä½ï¼Œå¦‚æœå…¨éƒ¨éƒ½è®°å½•ä¸‹æ¥ï¼Œå¯¹æ•°æ®åº“çš„å­˜å‚¨å®¹é‡æ˜¯ä¸ªå¾ˆå¤§çš„è´Ÿæ‹…ã€‚ prob_reducer.py 12345678910111213141516171819202122232425262728import sysfrom itertools import groupbyfrom operator import itemgetter def parse_output(std_input): for line in std_input: yield line.strip().split(\"\\t\") def main(n_gram): data = parse_output(sys.stdin) for starting_phrase, group in groupby(data, itemgetter(0)): result = &#123;&#125; for _, word_count in group: word, count = word_count.split(\"=\") count = int(count) if count not in result: result[count] = [] result[count].append(word) i = 0 for key, value in result.items(): if i &lt; n_gram: for word in value: print(\"&#123;&#125;,&#123;&#125;,&#123;&#125;\".format(starting_phrase, word, key)) i += 1 if __name__ == '__main__': main(4) starting_phraseä»£è¡¨çš„æ˜¯ç”¨æˆ·è¾“å…¥çš„éƒ¨åˆ†ï¼Œfollowing_wordä»£è¡¨çš„æ˜¯åé¢å¯èƒ½å‡ºç°çš„è¯æ±‡ï¼Œcounté¡¾åæ€ä¹‰å°±æ˜¯æŒ‡è¯é¢‘äº†ã€‚åœ¨reducerä¸­ï¼Œæˆ‘ä»¬å…ˆæŒ‰ç…§è¯é¢‘çš„ä¸åŒå°†å¯èƒ½å‡ºç°çš„è¯æ±‡åˆ†ç»„æ”¾ç½®ï¼Œç„¶åå†æ ¹æ®æˆ‘ä»¬éœ€è¦çš„N-Gramå¤§å°æ¥ä¾æ¬¡è¾“å‡ºã€‚è¿™é‡Œçš„å‚æ•°n_gramå’Œä¹‹å‰n_gram_mapperé‡Œçš„n_gramæ„æ€ä¸€æ ·ï¼Œä½†å–å€¼å¯ä»¥ä¸åŒã€‚ é¢„æµ‹æ¦‚ç‡çš„æµ‹è¯•ç»“æœä¸‹é¢æˆ‘ä»¬æ¥çœ‹çœ‹æœ¬åœ°æµ‹è¯•ç»“æœå§ï¼Œå°±ç”¨ä¸Šä¸€æ­¥n_gram_reducerå¾—å‡ºçš„ç»“æœç»§ç»­æ“ä½œã€‚ 12345678910111213141516171819202122232425262728root@hadoop:~/src/p2py# cat result.txt | ./prob_mapper.py | ./prob_reducer.py and,fault,3and fault,tolerance,3and,reduce,3and reduce,functions,2big,data,2communication,cost,2fault,tolerance,3is,a,2map,and,3map and,reduce,3map and reduce,functions,2mapreduce,framework,3method,that,2method that,performs,2model,and,2model,is,2not,the,2of,the,4of the,mapreduce,2of the mapreduce,framework,2optimizing,the,2reduce,functions,2such,as,2that,performs,2the,mapreduce,4the mapreduce,framework,3the,various,2 å› ä¸ºä¹‹å‰åœ¨mapperé‡Œæˆ‘ä»¬å°†thresholdè®¾ç½®ä¸º2ï¼Œè¿™é‡Œæˆ‘ä»¬å°±å¯ä»¥çœ‹åˆ°ç»“æœä¸­åªæœ‰è¯é¢‘ä¸å°äº2æ¬¡çš„ã€‚ è¿è¡Œåœ¨Hadoopä¸Šåˆšæ‰åœ¨æœ¬åœ°è·‘è¿‡äº†ä¹‹åï¼Œä¸‹é¢æ¥è¿›è¡ŒHadoopä¸Šçš„æµ‹è¯•ã€‚ä¸ºäº†æ–¹ä¾¿å¿«æ·ï¼Œæˆ‘ç¼–å†™äº†ä¸€ä¸ªscriptæ¥è¿è¡Œä¸¤å¯¹mapperå’Œreducerï¼Œæœ€åæŠŠå¾—åˆ°çš„æ•°æ®ä»HDFSé‡Œå¯¼å‡ºåˆ°æœ¬åœ°ã€‚ 123456789101112131415161718192021222324252627root@hadoop:~/src/p2py# ./run_script.sh Cleaning old results in /output...17/10/10 01:30:20 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.Deleted /output Running python in Hadoop by hadoop streaming... packageJobJar: [/tmp/hadoop-unjar5398292596529368576/] [] /tmp/streamjob5913697815224381390.jar tmpDir=null17/10/10 01:30:22 INFO client.RMProxy: Connecting to ResourceManager at hadoop-master/172.18.0.2:803217/10/10 01:30:22 INFO client.RMProxy: Connecting to ResourceManager at hadoop-master/172.18.0.2:803217/10/10 01:30:23 INFO mapred.FileInputFormat: Total input paths to process : 1...17/10/10 01:30:49 INFO streaming.StreamJob: Output directory: /output/first Running 2nd mapper and reducer... packageJobJar: [/tmp/hadoop-unjar6814698868258273333/] [] /tmp/streamjob6470458846508985375.jar tmpDir=null17/10/10 01:30:51 INFO client.RMProxy: Connecting to ResourceManager at hadoop-master/172.18.0.2:803217/10/10 01:30:51 INFO client.RMProxy: Connecting to ResourceManager at hadoop-master/172.18.0.2:803217/10/10 01:30:52 INFO mapred.FileInputFormat: Total input paths to process : 1...17/10/10 01:31:13 INFO streaming.StreamJob: Output directory: /output/second Moving outputs from HDFS to local... Got the output! ä¸€åˆ‡é¡ºåˆ©è¿è¡Œï¼æœ€ç»ˆç»“æœä¹Ÿè¢«æˆåŠŸå¯¼å‡ºåˆ°æœ¬åœ°ã€‚ å¯¼å…¥æ•°æ®åº“å…¶å®åˆ°ä¸Šä¸€å°èŠ‚ï¼ŒMapReduceçš„å·¥ä½œå°±éƒ½åšå®Œäº†ï¼Œä½†ä¸ºäº†è®©autocompleteå¯ä»¥å±•ç°å‡ºåº”æœ‰çš„æ•ˆæœï¼Œè¿™é‡Œè¿˜éœ€è¦å°†åˆšæ‰ç”Ÿæˆçš„æ•°æ®å¯¼å‡ºåˆ°æ•°æ®åº“ä¸­ï¼Œä»¥ä¾¿ä¹‹åå’ŒWebç»“åˆæ¥ä½“ç°åŠŸèƒ½ã€‚ æ•°æ®åº“æˆ‘ç”¨çš„æ˜¯MySQLï¼Œå¤§å®¶å¯ä»¥ä»»æ„é€‰æ‹©ã€‚ä¸‹é¢æ˜¯æˆ‘çš„æ•°æ®åº“æ“ä½œä»£ç ï¼š 1234567891011121314151617181920import sysimport MySQLdb as mdb def read_data(file): for line in file.readlines(): yield line.strip().split(\",\") def main(input_data): with mdb.connect('localhost', 'username', 'password', 'dbname') as cur: cur.execute(\"DROP TABLE IF EXISTS output\") cur.execute( \"CREATE TABLE output(starting_phrase VARCHAR(250), following_word VARCHAR(250), count INT)\") with open(input_data, 'r') as file: for starting_phrase, following_word, count in read_data(file): cur.execute( \"INSERT INTO output(starting_phrase, following_word, count) \\ VALUES('&#123;&#125;', '&#123;&#125;', &#123;&#125;)\".format(starting_phrase, following_word, count)) if __name__ == '__main__': main(\"output\") æ•°æ®åº“ä¸­æ˜¾ç¤ºçš„ç»“æœï¼š å±•ç¤ºç»“æœæˆ‘ç®€å•åšäº†ä¸€ä¸ªWebå±•ç¤ºçš„é¡µé¢ï¼ŒåŸºäºAjaxå’ŒPHPï¼Œè¿æ¥æ•°æ®åº“åï¼Œæµ‹è¯•ç»“æœå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š æ€»ç»“æœ¬æ–‡ä»é›¶å¼€å§‹ï¼Œä¸å¤ªè¯¦ç»†çš„ä»‹ç»äº†autocompleteçš„å·¥ä½œåŸç†ï¼Œä»¥åŠå¦‚ä½•åˆ©ç”¨Pythonå’ŒMapReduceæ¥å¤„ç†æ•°æ®ã€‚ç›¸æ¯”è¾ƒJavaå®ç°è¿™äº›å†…å®¹è€Œè¨€ï¼ŒPythonç¡®å®éœ€è¦æ³¨æ„æ›´å¤šçš„ç»†èŠ‚ï¼Œæ¯•ç«ŸJavaæ˜¯HadoopåŸç”Ÿç¯å¢ƒï¼Œconfigurationçš„é…ç½®çœŸçš„æ˜¯æ–¹ä¾¿ã€‚ä¹‹å‰åšwordcountæ—¶æ²¡æœ‰è§‰å¾—Python+Hadoop Streamingçš„æ–¹å¼æœ‰ä»€ä¹ˆé—®é¢˜ï¼Œå› ä¸ºPythonå¤©ç”Ÿçš„ç®€æ´ç‰¹è´¨ï¼Œæ„Ÿè§‰æ¯”Javaå•°é‡Œå•°å—¦çš„èˆ’æœå¤šäº†ã€‚ä½†è¿™æ¬¡çš„ä»£ç å®ç°ä¸Šå°±çœ‹å‡ºç«¯å€ªäº†ï¼ŒPythonä¸‹æ›´å¤šçš„ç»†èŠ‚éƒ¨åˆ†éœ€è¦å¼€å‘è€…è‡ªå·±å†™ä»£ç å»ç»´æŠ¤ï¼Œå°±åƒä¸åŒçš„mapperï¼Œreducerä¹‹é—´çš„æ•°æ®ä¼ è¾“ï¼Œè¿˜æœ‰è¾“å‡ºåˆ°æ•°æ®åº“ä¿å­˜ã€‚ ä¸€è·¯ä»å¤´çœ‹åˆ°è¿™é‡Œçš„æœ‹å‹ï¼Œæ„Ÿè°¢ä½ çš„é˜…è¯»ï¼Œå¦‚æœæœ‰ç–‘æƒ‘ï¼Œæ¬¢è¿ğŸ‘‡ä¸‹é¢ç•™è¨€ï¼Œå¦‚æœæ–‡ç« ä¸­æœ‰ä»€ä¹ˆä¸å¯¹çš„åœ°æ–¹ï¼Œä¹Ÿæ¬¢è¿æ‰¹è¯„å’ŒæŒ‡æ­£ã€‚ Related Links N-gramçš„åŸç†ã€ç”¨é€”å’Œç ”ç©¶"},{"title":"Data analysis in Python by Pandas","permalink":"http://yuannow.com/2017/10/02/Data-analysis-in-Python-by-Pandas/","text":"Pythonåœ¨æ•°æ®ç§‘å­¦é¢†åŸŸçš„åº”ç”¨çœŸçš„æ˜¯è¶Šæ¥è¶Šæ™®åŠï¼Œå¾—ç›ŠäºPythonç›¸å¯¹æ¥è®²é€šä¿—æ˜“æ‡‚çš„è¯­è¨€é£æ ¼ï¼Œè¯­æ³•ç®€å•ä¸”å®¹æ˜“å…¥é—¨çš„ç‰¹æ€§ï¼Œç»™å¾ˆå¤šæ•°æ®ç§‘å­¦é¢†åŸŸçš„æœ‹å‹ï¼Œå‡è½»äº†ä¸€éƒ¨åˆ†å­¦ä¹ ç¼–ç¨‹è¯­è¨€çš„ç¹é‡ã€‚Pandas + NumPy + Matplotlibï¼Œè¿™ä¸‰è€…çš„ç»“åˆåŸºæœ¬å¯ä»¥èƒœä»»ä»»æ„ç®€å•çš„æ•°æ®åˆ†æå’Œå¯è§†åŒ–çš„ä»»åŠ¡ã€‚å¤æ‚ä¸€ç‚¹çš„å¯èƒ½è¿˜ä¼šéœ€è¦SciPyçš„å¸®åŠ©ã€‚ æœ¬æ–‡ç›®çš„è¿™æ¬¡ï¼Œæˆ‘æ‰“ç®—ç”¨ä¸€ç¯‡é•¿æ–‡æ¥è®°å½•ä¸€ä¸‹è‡ªå·±æ˜¯å¦‚ä½•åˆ©ç”¨Pandasè¿›è¡Œæ•°æ®åˆ†æçš„ã€‚ç½‘ä¸Šæœ‰å¾ˆå¤šçš„Pandaså…¥é—¨æ•™ç¨‹ï¼Œå› æ­¤æˆ‘è¿™é‡Œå¹¶ä¸æ‰“ç®—é’ˆå¯¹æ‰€æœ‰Pandasçš„åŸºç¡€æ“ä½œæè¿°çš„é‚£ä¹ˆæ¸…æ¥šï¼Œè¿˜æ˜¯å¸Œæœ›æ›´å¤šçš„è¡¨è¾¾ä¸€äº›å¯¹äºæ•°æ®åˆ†æçš„æƒ³æ³•å’Œå®ç°ã€‚ å¹¿ä¹‰ä¸Šï¼Œæ•°æ®åˆ†æå…¶å®åŒ…å«äº†ä»å¯¼å…¥æ•°æ®-&gt;æ¸…æ´—æ•°æ®-&gt;åˆ†ææ•°æ®-&gt;å±•ç¤ºæ•°æ®ï¼Œè¿™ä¸€ä»å¤´åˆ°å°¾çš„æµç¨‹ã€‚ç‹­ä¹‰ä¸Šï¼Œæ•°æ®åˆ†ææŒ‡çš„å°±æ˜¯ä¸­é—´åˆ†ææ•°æ®è¿™ä¸€å—å†…å®¹ã€‚æœ¬æ–‡æŒ‰ç…§å¹¿ä¹‰ä¸Šçš„æ•°æ®åˆ†æçš„è¿‡ç¨‹æ¥ä¸€æ­¥æ­¥æ¢è®¨ã€‚ æ¥ä¸‹æ¥æˆ‘ä»¬å°±æ­£å¼å¼€å§‹æœ¬æ¬¡æ•°æ®åˆ†æä¹‹æ—…ã€‚ æ­£æ–‡ä¸‹é¢çš„è¿™ä¸€æ®µä»£ç ä¸»è¦æ˜¯åŒ…çš„è°ƒç”¨å’Œä¸€äº›ç¯å¢ƒé…ç½®ï¼ŒSeabornæ˜¯ä¹Ÿæ˜¯ä¸€ä¸ªplotåŒ…ï¼Œå¯ç”¨æ¥ç”»å‡ºæ¯”Matplotlibæ›´æ¼‚äº®çš„å›¾ï¼Œå®ƒæœ¬èº«æ˜¯åŸºäºMatplotlibè®¾è®¡çš„ï¼Œå¯¹NumPyå’ŒPandaséƒ½æœ‰å¾ˆå¥½çš„æ”¯æŒã€‚è¿™é‡Œæˆ‘å°±ä¸åšè¿‡å¤šè§£é‡Šäº†ï¼Œå¯¹Seabornæœ‰å…´è¶£çš„æœ‹å‹å¯ä»¥ç•™è¨€å’¨è¯¢æˆ–è€…è‡ªè¡Œæ¢ç´¢ã€‚ 12345678910import pandas as pdfrom matplotlib import pyplot as pltimport seaborn as sns %matplotlib inline sns.set(rc=&#123;\"figure.figsize\": (10, 6.25)&#125;)sns.set_style(\"darkgrid\")colors = [\"windows blue\", \"amber\", \"faded green\", \"greyish\", \"dusty purple\", \"red violet\", \"marine\", \"jungle green\", \"chocolate brown\", \"dull pink\", \"reddish orange\"]sns.set_palette(sns.xkcd_palette(colors)) å¯¼å…¥æ•°æ®æˆ‘è¿™æ¬¡ç”¨çš„æ•°æ®æ˜¯IGNä¸Šè¿‘20å¹´æ¥çš„å„ç§å¹³å°çš„æ¸¸æˆï¼Œæ¥æºäºè¿™é‡Œã€‚ 1reviews = pd.read_csv(\"ign.csv\") æ•°æ®è¯»å…¥ä¹‹åï¼Œæˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹è¿™é‡Œéƒ½æœ‰äº›ä»€ä¹ˆå†…å®¹ã€‚ 1reviews.head() Unnamed: 0 score_phrase title url platform score genre editors_choice release_year release_month release_day 0 0 Amazing LittleBigPlanet PS Vita /games/littlebigplanet-vita/vita-98907 PlayStation Vita 9.0 Platformer Y 2012 9 12 1 1 Amazing LittleBigPlanet PS Vita â€“ Marvel Super Hero Eâ€¦ /games/littlebigplanet-ps-vita-marvel-super-heâ€¦ PlayStation Vita 9.0 Platformer Y 2012 9 12 2 2 Great Splice: Tree of Life /games/splice/ipad-141070 iPad 8.5 Puzzle N 2012 9 12 3 3 Great NHL 13 /games/nhl-13/xbox-360-128182 Xbox 360 8.5 Sports N 2012 9 11 4 4 Great NHL 13 /games/nhl-13/ps3-128181 PlayStation 3 8.5 Sports N 2012 9 11 è¿™é‡Œå…ˆç®€å•ä»‹ç»ä¸€ä¸‹æ¯ä¸€åˆ—éƒ½ä»£è¡¨ä»€ä¹ˆå§ï¼š score_phrase â€“ IGNç”¨ä¸€ä¸ªè¯æ¥è¯„ä»·å½“å‰æ¸¸æˆï¼Œä¸å¾—åˆ†ç›´æ¥ç›¸å…³ï¼› title â€“ æ¸¸æˆåç§°ï¼› url â€“ å®Œæ•´è¯„è®ºçš„åœ°å€ï¼› platform â€“ æ¸¸æˆå¹³å°ï¼ˆPS4, PC, Xbox, etc.ï¼‰ï¼› score â€“ æ¸¸æˆçš„å…·ä½“è¯„åˆ†ï¼Œä»1.0åˆ°10.0ï¼› genre â€“ æ¸¸æˆåˆ†ç±»ï¼› editors_choice â€“ æ˜¯å¦ä¸ºIGNç¼–è¾‘æ¨èçš„æ¸¸æˆï¼Œä¸è¯„åˆ†æœ‰å…³ç³»ã€‚ release_year â€“ æ¸¸æˆå‘å¸ƒå¹´ä»½ï¼› release_month â€“ å‘å¸ƒæœˆä»½ï¼› release_day â€“ å‘å¸ƒæ—¥æœŸã€‚ æˆ‘ä»¬æ¥çœ‹ä¸‹æ€»å…±å¤šå°‘ä¸ªæ•°æ®ã€‚ 1reviews.shape (18625, 11) çœ‹æ¥æˆ‘ä»¬è¿™æ¬¡çš„æ•°æ®é‡Œä¸€å…±18625æ¡æ•°æ®ï¼Œä¸€å…±11åˆ—å±æ€§ã€‚ æ¸…æ´—æ•°æ®æºæ•°æ®å¯¼å…¥åä¸€èˆ¬æ¥è¯´æ˜¯ä¸èƒ½ç›´æ¥ä½¿ç”¨çš„ï¼Œéœ€è¦è¿›è¡Œä¸€å®šèŒƒå›´çš„æ•°æ®æ¸…æ´—ï¼Œä¸è¿‡æœ¬æ¬¡çš„æ•°æ®åŸºæœ¬ä¸éœ€è¦æ¸…æ´—ï¼Œæ”¶é›†è¿™ä¸ªæ•°æ®çš„Eric Grinsteinå·²ç»å¯¹æ•°æ®è¿›è¡Œäº†æ¸…æ´—å·¥ä½œã€‚ä¸è¿‡è¿™é‡Œæˆ‘ä»¬ä»éœ€è¦åšä¸€ç‚¹ç®€å•çš„æ¸…æ´—å·¥ä½œï¼Œå»é™¤ä¸€äº›æˆ‘ä»¬ä¸éœ€è¦çš„å†…å®¹ã€‚ 12reviews = reviews.iloc[:, 1:]reviews.head() .dataframe { display: block; overflow-x: auto; white-space: nowrap; } .dataframe thead tr:only-child th { text-align: center; } .dataframe thead th { text-align: left; } .dataframe tbody tr th { vertical-align: top; } score_phrase title url platform score genre editors_choice release_year release_month release_day 0 Amazing LittleBigPlanet PS Vita /games/littlebigplanet-vita/vita-98907 PlayStation Vita 9.0 Platformer Y 2012 9 12 1 Amazing LittleBigPlanet PS Vita â€“ Marvel Super Hero Eâ€¦ /games/littlebigplanet-ps-vita-marvel-super-heâ€¦ PlayStation Vita 9.0 Platformer Y 2012 9 12 2 Great Splice: Tree of Life /games/splice/ipad-141070 iPad 8.5 Puzzle N 2012 9 12 3 Great NHL 13 /games/nhl-13/xbox-360-128182 Xbox 360 8.5 Sports N 2012 9 11 4 Great NHL 13 /games/nhl-13/ps3-128181 PlayStation 3 8.5 Sports N 2012 9 11 åˆ†ææ•°æ®æ•°æ®æ¸…æ´—ä¹‹åï¼Œå…¶å®å°±æ˜¯åˆ†æè¿‡ç¨‹çš„æ­£å¼å¼€å§‹ã€‚åœ¨å¼€å§‹åˆ†æè¿‡ç¨‹ä¹‹å‰ï¼Œå…ˆè¯´ç‚¹é¢˜å¤–è¯ã€‚æˆ‘æœ¬èº«å¯¹äºæ¸¸æˆæ˜¯å¾ˆçƒ­çˆ±çš„ï¼Œä»å°åˆ°å¤§ï¼Œæ¸¸æˆæœºï¼ŒæŒæœºï¼ŒPCï¼Œä¹Ÿæ‹¥æœ‰è¿‡ä¸å°‘çš„æ¸¸æˆå¹³å°ã€‚ä»å’Œçˆ¶æ¯æ–—æ™ºæ–—å‹‡ä¸­å„ç§äº‰å–æ—¶é—´ç©çš„çº¢ç™½æœºï¼Œå°éœ¸ç‹å­¦ä¹ æœºï¼Œåˆ°åæ¥å¯ä»¥èº²åœ¨è¢«å­é‡Œç©çš„GameBoyï¼Œä½†å¶å°”è¿˜å¾—æ¢å‡ºå¤´æ‹…å¿ƒçˆ¶æ¯è¿›å±‹é‡Œå‘ç°è‡ªå·±çš„å°ç§˜å¯†ï¼›å†å¾€åçš„ä¸–å˜‰ï¼Œæ‰€ä»¥åˆä¸å¾—ä¸å’Œçˆ¶æ¯è½¯ç£¨ç¡¬æ³¡æ³æ±‚æ¸¸æˆæ—¶é—´ã€‚ç›´è‡³å®¶é‡Œç¬¬ä¸€å°PCçš„å‡ºç°ï¼ŒåŸºæœ¬å…¶ä»–çš„æ¸¸æˆå¹³å°å°±å¾ˆå°‘ç¢°äº†ï¼Œé™¤äº†åæ¥çš„PSPï¼Œé‚£æ˜¯æˆ‘ä»GameBoyä¹‹åæ—¶éš”å¾ˆå¤šå¹´å†æ¬¡æ‹¿èµ·æŒæœºç©æ¸¸æˆã€‚è¦è¯´èµ·æ¸¸æˆï¼Œæ¸¸æˆå¹³å°ï¼Œæ¸¸æˆçš„å†å²ï¼ŒçœŸçš„è¯´ä¸Šä¸‰å¤©ä¸‰å¤œä¹Ÿè¯´ä¸å®Œï¼Œå…¶å®è¿™ä¹Ÿæ˜¯æˆ‘ä¸ºä»€ä¹ˆé€‰æ‹©è¿™ä¹ˆIGNçš„è¿™ä¸ªæ•°æ®ä½œä¸ºæ•°æ®åˆ†æçš„æ•°æ®æ¥æºã€‚æˆ‘ä¹Ÿå¾ˆæƒ³çœ‹çœ‹è¿™20å¹´æ¥ç”µå­æ¸¸æˆäº§ä¸šçš„å‘å±•å’Œè¶‹åŠ¿ã€‚ å¥½äº†ï¼Œå’±ä»¬è¨€å½’æ­£ä¼ ï¼Œå°±æˆ‘ä¸ªäººè€Œè¨€ï¼Œæ‹¿åˆ°è¿™ä¹ˆå¤šçš„æ•°æ®ä¹‹åï¼Œç¬¬ä¸€ååº”æ˜¯ï¼šè¿™ä¹ˆå¤šçš„æ¸¸æˆï¼Œç©¶ç«Ÿæ˜¯åˆ†å¸ƒåœ¨äº†å¤šå°‘å¹³å°ä¸Šå‘¢ï¼Ÿæˆ‘äº²èº«ä½“éªŒè¿‡çš„å¹³å°å…¶å®å¹¶ä¸å¤šï¼Œå¤§æ¦‚10ä¸ªå·¦å³å§ã€‚é‚£ä¹ˆè¿™ä¸ªæ•°æ®é›†é‡Œç©¶ç«ŸåŒ…å«äº†å¤šå°‘å¹³å°å‘¢ï¼Ÿ 12all_platforms = reviews[\"platform\"].unique()all_platforms array([&apos;PlayStation Vita&apos;, &apos;iPad&apos;, &apos;Xbox 360&apos;, &apos;PlayStation 3&apos;, &apos;Macintosh&apos;, &apos;PC&apos;, &apos;iPhone&apos;, &apos;Nintendo DS&apos;, &apos;Nintendo 3DS&apos;, &apos;Android&apos;, &apos;Wii&apos;, &apos;PlayStation 4&apos;, &apos;Wii U&apos;, &apos;Linux&apos;, &apos;PlayStation Portable&apos;, &apos;PlayStation&apos;, &apos;Nintendo 64&apos;, &apos;Saturn&apos;, &apos;Lynx&apos;, &apos;Game Boy&apos;, &apos;Game Boy Color&apos;, &apos;NeoGeo Pocket Color&apos;, &apos;Game.Com&apos;, &apos;Dreamcast&apos;, &apos;Dreamcast VMU&apos;, &apos;WonderSwan&apos;, &apos;Arcade&apos;, &apos;Nintendo 64DD&apos;, &apos;PlayStation 2&apos;, &apos;WonderSwan Color&apos;, &apos;Game Boy Advance&apos;, &apos;Xbox&apos;, &apos;GameCube&apos;, &apos;DVD / HD Video Game&apos;, &apos;Wireless&apos;, &apos;Pocket PC&apos;, &apos;N-Gage&apos;, &apos;NES&apos;, &apos;iPod&apos;, &apos;Genesis&apos;, &apos;TurboGrafx-16&apos;, &apos;Super NES&apos;, &apos;NeoGeo&apos;, &apos;Master System&apos;, &apos;Atari 5200&apos;, &apos;TurboGrafx-CD&apos;, &apos;Atari 2600&apos;, &apos;Sega 32X&apos;, &apos;Vectrex&apos;, &apos;Commodore 64/128&apos;, &apos;Sega CD&apos;, &apos;Nintendo DSi&apos;, &apos;Windows Phone&apos;, &apos;Web Games&apos;, &apos;Xbox One&apos;, &apos;Windows Surface&apos;, &apos;Ouya&apos;, &apos;New Nintendo 3DS&apos;, &apos;SteamOS&apos;], dtype=object) è¿™ä¹ˆå¤šçš„å¹³å°â€¦â€¦è¯´å®è¯ï¼Œè¿™é‡Œæœ‰å¾ˆå¤šæˆ‘å¬éƒ½æ²¡å¬è¿‡ï¼ŒåƒDreamcastï¼ŒAtari 2600ï¼ŒVectrexç­‰ç­‰ï¼Œçœ‹æ¥è¿™20å¹´ï¼Œæ¸¸æˆäº§ä¸šçš„å‘å±•è¿˜æ˜¯å¾ˆå¤šå…ƒåŒ–çš„ï¼Œè‡³å°‘ä»æ¸¸æˆå¹³å°ä¸Šå°±å¯ä»¥çœ‹å‡ºç«¯å€ªã€‚ æœ‰äº†æ¸¸æˆå¹³å°çš„ä¿¡æ¯ï¼Œè‡ªç„¶è€Œç„¶åœ°å°±ä¼šé—®ï¼Œæ¯ä¸ªå¹³å°å¤§æ¦‚éƒ½å‡ºè¿‡å¤šå°‘æ¸¸æˆå‘¢ï¼Ÿ 1reviews[\"platform\"].value_counts(dropna=False) PC 3370 PlayStation 2 1686 Xbox 360 1631 Wii 1366 PlayStation 3 1356 Nintendo DS 1045 PlayStation 952 Wireless 910 iPhone 842 Xbox 821 PlayStation Portable 633 Game Boy Advance 623 GameCube 509 Game Boy Color 356 Nintendo 64 302 Dreamcast 286 PlayStation 4 277 Nintendo DSi 254 Nintendo 3DS 225 Xbox One 208 PlayStation Vita 155 Wii U 114 iPad 99 Lynx 82 Macintosh 81 Genesis 58 NES 49 TurboGrafx-16 40 Android 39 Super NES 33 NeoGeo Pocket Color 31 N-Gage 30 Game Boy 22 iPod 17 Sega 32X 16 Windows Phone 14 Master System 13 Arcade 11 Linux 10 NeoGeo 10 Nintendo 64DD 7 Commodore 64/128 6 Saturn 6 Atari 2600 5 WonderSwan 4 TurboGrafx-CD 3 Game.Com 3 Atari 5200 2 New Nintendo 3DS 2 Vectrex 2 Pocket PC 1 WonderSwan Color 1 Ouya 1 Web Games 1 SteamOS 1 Dreamcast VMU 1 Windows Surface 1 DVD / HD Video Game 1 Sega CD 1 Name: platform, dtype: int64 ä»ä¸Šé¢çš„ç»Ÿè®¡æ¥çœ‹ï¼ŒPCç«¯æ— ç–‘æ˜¯æœ€å¤§çš„è´¡çŒ®è€…ï¼Œè¿™ä¹Ÿå¯ä»¥ç†è§£ï¼Œæ¯•ç«Ÿä¸ªäººç”µè„‘ä»ä¸Šä¸ªä¸–çºªæœ«å¼€å§‹å‡ºç°äº•å–·ï¼Œåˆ°åæ¥è™½ç„¶å‡ºè´§é‡å¼€å§‹ä¸‹é™ï¼Œä½†ä¸€ç›´éƒ½æ˜¯äººä»¬å­¦ä¹ ç”Ÿæ´»å¨±ä¹ä¸­ä¸å¯æˆ–ç¼ºçš„ä¸€éƒ¨åˆ†ï¼Œå¹¶ä¸”æ—©æœŸçš„ä¸ªäººç”µè„‘ç»å¤§éƒ¨åˆ†éƒ½æ˜¯ä»¥Windowsä¸ºæ“ä½œç³»ç»Ÿã€‚ä¸è¿‡è®©æˆ‘æ²¡æƒ³åˆ°çš„æ˜¯Dreamcastç«Ÿç„¶è¿˜æœ‰286æ¬¾æ¸¸æˆï¼Œçœ‹æ¥æ˜¯æˆ‘å­¤é™‹å¯¡é—»äº†â€¦â€¦ ä¸‹é¢æ¥çœ‹çœ‹æ’åå‰åçš„å¹³å°éƒ½æœ‰å“ªäº›ã€‚ 12platforms = reviews[\"platform\"].value_counts()[:10].index.tolist()platforms [&apos;PC&apos;, &apos;PlayStation 2&apos;, &apos;Xbox 360&apos;, &apos;Wii&apos;, &apos;PlayStation 3&apos;, &apos;Nintendo DS&apos;, &apos;PlayStation&apos;, &apos;Wireless&apos;, &apos;iPhone&apos;, &apos;Xbox&apos;] æ—¢ç„¶å‰åçš„å¹³å°æˆ‘å·²ç»çŸ¥é“äº†ï¼Œé‚£ä¹ˆä¸‹é¢æ¥çœ‹çœ‹æ¯ä¸ªå¹³å°çš„æ¸¸æˆè´¨é‡å¦‚ä½•ï¼Œè™½ç„¶PCç«¯çš„æ¸¸æˆæœ€å¤šï¼Œä½†ä¸ä¸€å®šå¥½æ¸¸æˆå æ¯”å°±æ˜¯æœ€å¤šçš„ï¼Œå¯¹å§ï¼Ÿ æƒ³çŸ¥é“æ¯ä¸ªå¹³å°çš„æ¸¸æˆè´¨é‡å¦‚ä½•ï¼Œæˆ‘å¾—å…ˆä»æ‰€æœ‰çš„æ•°æ®ä¸­å°†åªå±äºå‰åçš„å¹³å°çš„æ¸¸æˆæå–å‡ºæ¥ã€‚è¿™é‡Œæˆ‘åˆ›å»ºä¸€ä¸ªfilterï¼Œç”¨æ¥ç­›é€‰æ¸¸æˆå¹³å°ã€‚ 12fil = reviews[\"platform\"] == platforms[0] # create a filterfil 0 False 1 False 2 False 3 False 4 False 5 False 6 False 7 True 8 False 9 True ... 18615 False 18616 True 18617 False 18618 True 18619 True 18620 False 18621 False 18622 False 18623 False 18624 True Name: platform, Length: 18625, dtype: bool 1234for platform in platforms[1:]: fil |= reviews[\"platform\"] == platform filtered_reviews = reviews[fil] ä¸‹é¢æ˜¯æå–å‡ºæ¥çš„æ‰€æœ‰æ•°æ®ï¼š 1filtered_reviews score_phrase title url platform score genre editors_choice release_year release_month release_day 3 Great NHL 13 /games/nhl-13/xbox-360-128182 Xbox 360 8.5 Sports N 2012 9 11 4 Great NHL 13 /games/nhl-13/ps3-128181 PlayStation 3 8.5 Sports N 2012 9 11 6 Awful Double Dragon: Neon /games/double-dragon-neon/xbox-360-131320 Xbox 360 3.0 Fighting N 2012 9 11 7 Amazing Guild Wars 2 /games/guild-wars-2/pc-896298 PC 9.0 RPG Y 2012 9 11 8 Awful Double Dragon: Neon /games/double-dragon-neon/ps3-131321 PlayStation 3 3.0 Fighting N 2012 9 11 9 Good Total War Battles: Shogun /games/total-war-battles-shogun/pc-142564 PC 7.0 Strategy N 2012 9 11 10 Good Tekken Tag Tournament 2 /games/tekken-tag-tournament-2/ps3-124584 PlayStation 3 7.5 Fighting N 2012 9 11 11 Good Tekken Tag Tournament 2 /games/tekken-tag-tournament-2/xbox-360-124581 Xbox 360 7.5 Fighting N 2012 9 11 12 Good Wild Blood /games/wild-blood/iphone-139363 iPhone 7.0 NaN N 2012 9 10 13 Amazing Mark of the Ninja /games/mark-of-the-ninja-135615/xbox-360-129276 Xbox 360 9.0 Action, Adventure Y 2012 9 7 14 Amazing Mark of the Ninja /games/mark-of-the-ninja-135615/pc-143761 PC 9.0 Action, Adventure Y 2012 9 7 16 Okay Home: A Unique Horror Adventure /games/home-a-unique-horror-adventure/pc-137135 PC 6.5 Adventure N 2012 9 6 17 Great Avengers Initiative /games/avengers-initiative/iphone-141579 iPhone 8.0 Action N 2012 9 5 18 Mediocre Way of the Samurai 4 /games/way-of-the-samurai-4/ps3-23516 PlayStation 3 5.5 Action, Adventure N 2012 9 3 19 Good JoJoâ€™s Bizarre Adventure HD /games/jojos-bizarre-adventure/xbox-360-137717 Xbox 360 7.0 Fighting N 2012 9 3 20 Good JoJoâ€™s Bizarre Adventure HD /games/jojos-bizarre-adventure/ps3-137896 PlayStation 3 7.0 Fighting N 2012 9 3 21 Good Mass Effect 3: Leviathan /games/mass-effect-3-leviathan/xbox-360-138918 Xbox 360 7.5 RPG N 2012 8 31 22 Good Mass Effect 3: Leviathan /games/mass-effect-3-leviathan/ps3-138915 PlayStation 3 7.5 RPG N 2012 8 31 23 Good Mass Effect 3: Leviathan /games/mass-effect-3-leviathan/pc-138919 PC 7.5 RPG N 2012 8 31 24 Amazing Dark Souls (Prepare to Die Edition) /games/dark-souls-prepare-to-die-edition/pc-13â€¦ PC 9.0 Action, RPG Y 2012 8 31 25 Good Symphony /games/symphony/pc-136470 PC 7.0 Shooter N 2012 8 30 27 Good Tom Clancyâ€™s Ghost Recon Phantoms /games/tom-clancys-ghost-recon-online/pc-109114 PC 7.5 Shooter N 2012 8 29 28 Great Thirty Flights of Loving /games/thirty-flights-of-loving/pc-138374 PC 8.0 Adventure N 2012 8 29 29 Okay Legasista /games/legasista/ps3-127147 PlayStation 3 6.5 Action, RPG N 2012 8 28 31 Great World of Warcraft: Mists of Pandaria /games/world-of-warcraft-mists-of-pandaria/pc-â€¦ PC 8.7 RPG Y 2012 10 4 32 Bad Hell Yeah! Wrath of the Dead Rabbit /games/hell-yeah-wrath-of-the-dead-rabbit/ps3-â€¦ PlayStation 3 4.9 Platformer N 2012 10 4 33 Amazing Pokemon White Version 2 /games/pokemon-white-version-2/nds-129228 Nintendo DS 9.6 RPG Y 2012 10 3 34 Good War of the Roses /games/war-of-the-roses-140577/pc-115849 PC 7.3 Action N 2012 10 3 35 Amazing Pokemon Black Version 2 /games/pokemon-black-version-2/nds-129224 Nintendo DS 9.6 RPG Y 2012 10 3 36 Okay Drakerider /games/drakerider/iphone-135745 iPhone 6.5 RPG N 2012 10 3 â€¦ â€¦ â€¦ â€¦ â€¦ â€¦ â€¦ â€¦ â€¦ â€¦ â€¦ 18546 Great Devil Daggers /games/devil-daggers/pc-20049771 PC 8.5 Shooter N 2016 2 27 18547 Good Superhot /games/superhot/pc-20018899 PC 7.5 Action N 2016 2 25 18549 Good Battleborn /games/battleborn/pc-20021225 PC 7.1 Shooter N 2016 5 6 18554 Good The Park /games/the-park/pc-20042102 PC 7.0 Adventure N 2016 5 4 18555 Great Hitman: Episode 2 /games/hitman-episode-2/pc-20051629 PC 8.5 Shooter N 2016 4 29 18557 Amazing Hearts of Iron IV /games/hearts-of-iron-iv/pc-20012080 PC 9.0 Strategy Y 2016 6 6 18559 Okay Dangerous Golf /games/dangerous-golf/pc-20048436 PC 6.0 Sports, Action N 2016 6 3 18567 Great Offworld Trading Company /games/offworld-trading-company/pc-20018639 PC 8.0 Strategy N 2016 4 28 18568 Okay The Walking Dead: Michonne â€“ Episode 3: What â€¦ /games/the-walking-dead-michonne-episode-3/pc-â€¦ PC 6.3 Adventure N 2016 4 27 18570 Good Battlefleet Gothic: Armada /games/battlefleet-gothic-armada/pc-20030300 PC 7.1 Strategy N 2016 4 22 18572 Amazing Overwatch /games/overwatch/pc-20027413 PC 9.4 Shooter Y 2016 5 28 18575 Good Fallout 4: Nuka World /games/fallout-4-nuka-world/pc-20054761 PC 7.9 RPG N 2016 8 30 18578 Good Master of Orion /games/master-of-orion-wargaming/pc-20038452 PC 7.1 Strategy N 2016 8 26 18580 Great Quadrilateral Cowboy /games/quadrilateral-cowboy/pc-159788 PC 8.5 Puzzle N 2016 7 28 18581 Great Fallout 4: Vault-Tec Workshop /games/fallout-4-vault-tec-workshop/pc-20054769 PC 8.2 RPG N 2016 7 27 18583 Great Kentucky Route Zero: Act 4 /games/kentucky-route-zero-act-4/pc-20046280 PC 8.5 Adventure N 2016 7 22 18586 Great F1 2016 /games/f1-2016/pc-20054151 PC 8.8 Racing N 2016 8 24 18589 Amazing Deus Ex: Mankind Divided /games/deus-ex-mankind-divided/pc-20013794 PC 9.2 Action, RPG Y 2016 8 19 18595 Bad Ghostbusters /games/ghostbusters-the-movie/pc-20052317 PC 4.4 Action N 2016 7 16 18596 Okay Necropolis /games/necropolis/pc-20030346 PC 6.5 Action, Adventure N 2016 7 14 18598 Okay Furi /games/furi/pc-20044439 PC 6.8 Action N 2016 7 13 18600 Good Hitman: Episode 4 /games/hitman-episode-4/pc-20051637 PC 7.4 Shooter N 2016 8 19 18603 Good Grow Up /games/grow-up/pc-20054824 PC 7.8 Platformer N 2016 8 18 18606 Okay Starcraft II: Nova Covert Ops â€“ Mission Pack 2 /games/starcraft-ii-nova-covert-ops-mission-paâ€¦ PC 6.4 Strategy N 2016 8 4 18607 Good Pokemon Go /games/pokemon-go/iphone-20042699 iPhone 7.0 Battle N 2016 7 13 18613 Great XCOM 2: Shenâ€™s Last Gift /games/xcom-2-shens-last-gift/pc-20055520 PC 8.0 Strategy N 2016 7 1 18616 Good Batman: The Telltale Series â€“ Episode 1: Realâ€¦ /games/batman-the-telltale-series-episode-1-reâ€¦ PC 7.5 Adventure N 2016 8 2 18618 Amazing Starbound /games/starbound-2016/pc-128879 PC 9.1 Action Y 2016 7 28 18619 Good Human Fall Flat /games/human-fall-flat/pc-20051928 PC 7.9 Puzzle, Action N 2016 7 28 18624 Masterpiece Inside /games/inside-playdead/pc-20055740 PC 10.0 Adventure Y 2016 6 28 13979 rows Ã— 10 columns å±•ç¤ºæ•°æ®ç°åœ¨å·²ç»æœ‰äº†å‰åå¹³å°çš„æ•°æ®ï¼Œéœ€è¦æ€è€ƒçš„å°±æ˜¯å¦‚ä½•æ¥å‘ˆç°æ¯ä¸ªå¹³å°çš„æ¸¸æˆè´¨é‡å‘¢ï¼Ÿå½“ç„¶å¯ä»¥ç”¨æ¯ä¸ªå¹³å°çš„scoreçš„å¹³å‡å€¼æ¥å¯¹æ¯”ï¼Œä½†æœªå…æœ‰ç‚¹å•è–„äº†ã€‚æ•°æ®å±æ€§ä¸­æœ‰ä¸€åˆ—æ˜¯score_phraseï¼Œç”¨ä¸€ä¸ªå•è¯æ¥å½¢å®¹å½“å‰æ¸¸æˆçš„å¥½åï¼Œä¸scoreç›´æ¥æŒ‚é’©ï¼Œç”¨è¿™ä¸ªæ¥å±•ç¤ºåº”è¯¥ä¼šæ›´å®¹æ˜“ç†è§£å’Œåˆ†æã€‚ è¿™é‡Œå¯ä»¥ç”¨Matplotlib.pyplotçš„baræ¥ç”»ï¼Œä¹Ÿå¯ä»¥ç”¨Seabornä¸­çš„countplotï¼Œåè€…ä½¿ç”¨èµ·æ¥æ›´å®¹æ˜“æ–¹ä¾¿ã€‚ 1sns.countplot(x=\"platform\", hue=\"score_phrase\", data=filtered_reviews, palette=sns.xkcd_palette(colors)); å±•ç¤ºçš„ç»“æœå¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°PCå¹³å°ä¸‹ï¼ŒGreatå’ŒGoodè¿™ä¸¤æ ä¸‹çš„æ¸¸æˆæ•°é‡åŸºæœ¬å°±å äº†å¤§åŠï¼Œä½†æˆ‘å¹¶ä¸èƒ½è¯´PCç«¯çš„æ¸¸æˆè´¨é‡å°±æ¯”å…¶ä»–å¹³å°é«˜å‡ºä¸€ç­¹ï¼Œå› ä¸ºæˆ‘ä»¬ä¾ç„¶æ— æ³•åˆ¤æ–­æ¯ä¸ªå¹³å°ä¸‹ä¼˜ç§€çš„ä½œå“å æ¯”å¦‚ä½•ã€‚è¿™å¹…å›¾åªèƒ½ç›´è§‚åœ°å‘Šè¯‰æˆ‘ä»¬æ¯ä¸ªå¹³å°ä¸‹ï¼Œæ‰€æœ‰åˆ†æ•°çš„ä¸€ä¸ªåˆ†å¸ƒçŠ¶å†µã€‚ æ‰€ä»¥ï¼Œä¸‹é¢çš„å·¥ä½œï¼Œæˆ‘è¦ç»§ç»­ç»†åŒ–ä¸€ä¸‹æ•°æ®åˆ†æå’Œå±•ç¤ºçš„éƒ¨åˆ†ã€‚ è¿›ä¸€æ­¥åˆ†æä¸å±•ç¤ºæ•°æ®å› ä¸ºåŸå…ˆåˆ’åˆ†çš„score_phraseå¤ªå¤šäº†ï¼Œæˆ‘å†³å®šå°†å®ƒä»¬é‡æ–°åˆ’ä¸ºä¸‰ä¸ªéƒ¨åˆ†ï¼šå¥½äºGoodçš„ï¼Œå·®äºOkayçš„ï¼Œå‰©ä¸‹çš„å°±æ˜¯ä¸­é—´éƒ¨åˆ†ã€‚æˆ‘çš„è¿™ä¸ªæ ‡å‡†å¯èƒ½æ¯”è¾ƒä¸¥æ ¼ï¼Œåœ¨æˆ‘çœ‹æ¥ï¼Œè¯„åˆ†8.0ä»¥ä¸Šçš„æ‰ç®—çš„ä¸Šæ˜¯ä¼˜ç§€çš„ä½œå“ï¼Œä¹Ÿå°±æ˜¯é«˜äºGoodçš„ï¼›è‡³äºé‚£äº›è¯„åˆ†ä½äº6.0çš„ï¼Œä¹Ÿå°±æ˜¯è¿˜ä¸åˆ°Okayçš„ï¼Œç®—ä½œå·®åŠ²ä¹Ÿä¸ç®—å¤±ç¤¼å§ã€‚ 12345678910111213141516all_score_phrases = set(reviews[\"score_phrase\"].unique())bt_good = set(['Great', 'Amazing', 'Masterpiece'])average = set(['Good', 'Okay'])wt_okay = all_score_phrases - bt_good - average def category_score_phrase(value): if value in bt_good: return \"Better than Good\" elif value in wt_okay: return \"Worse than Okay\" else: return \"Average\" sizes = filtered_reviews[\"score_phrase\"].apply(category_score_phrase).value_counts()explode = (0, 0.1, 0)plt.pie(sizes, labels=sizes.index, explode=explode, autopct='%1.2f%%', shadow=True, startangle=90); è¿™é‡Œæˆ‘å…ˆç”¨é¥¼å›¾æ¥å±•ç¤ºä¸€ä¸‹å‰åçš„å¹³å°ï¼Œæ•´ä½“çš„æ¸¸æˆè´¨é‡åˆ†å¸ƒæƒ…å†µã€‚ è¿™é‡Œï¼Œæˆ‘åˆ›å»ºäº†ä¸€ä¸ªæ–°åˆ—ï¼Œå«score_phrase_newï¼Œä¸ºäº†åŒºåˆ«åŸæœ‰çš„score_phraseã€‚ 12filtered_reviews[\"score_phrase_new\"] = filtered_reviews[\"score_phrase\"].apply(category_score_phrase)filtered_reviews.head() score_phrase title url platform score genre editors_choice release_year release_month release_day score_phrase_new 3 Great NHL 13 /games/nhl-13/xbox-360-128182 Xbox 360 8.5 Sports N 2012 9 11 Better than Good 4 Great NHL 13 /games/nhl-13/ps3-128181 PlayStation 3 8.5 Sports N 2012 9 11 Better than Good 6 Awful Double Dragon: Neon /games/double-dragon-neon/xbox-360-131320 Xbox 360 3.0 Fighting N 2012 9 11 Worse than Okay 7 Amazing Guild Wars 2 /games/guild-wars-2/pc-896298 PC 9.0 RPG Y 2012 9 11 Better than Good 8 Awful Double Dragon: Neon /games/double-dragon-neon/ps3-131321 PlayStation 3 3.0 Fighting N 2012 9 11 Worse than Okay å…ˆæ¥ç”¨æ•°å­—ç›´è§‚åœ°çœ‹ä¸€ä¸‹æ¯ä¸ªå¹³å°ä¸‹ï¼Œæ¯ä¸ªè¯„åˆ†é˜¶æ®µçš„æ•°é‡ã€‚ 1filtered_reviews.groupby([\"platform\", \"score_phrase_new\"]).count() score_phrase title url score genre editors_choice release_year release_month release_day platform score_phrase_new Nintendo DS Average 462 462 462 462 462 462 462 462 462 Better than Good 207 207 207 207 207 207 207 207 207 Worse than Okay 376 376 376 376 375 376 376 376 376 PC Average 1394 1394 1394 1394 1393 1394 1394 1394 1394 Better than Good 1323 1323 1323 1323 1322 1323 1323 1323 1323 Worse than Okay 653 653 653 653 652 653 653 653 653 PlayStation Average 362 362 362 362 362 362 362 362 362 Better than Good 313 313 313 313 313 313 313 313 313 Worse than Okay 277 277 277 277 277 277 277 277 277 PlayStation 2 Average 716 716 716 716 716 716 716 716 716 Better than Good 542 542 542 542 542 542 542 542 542 Worse than Okay 428 428 428 428 426 428 428 428 428 PlayStation 3 Average 516 516 516 516 515 516 516 516 516 Better than Good 569 569 569 569 569 569 569 569 569 Worse than Okay 271 271 271 271 271 271 271 271 271 Wii Average 551 551 551 551 547 551 551 551 551 Better than Good 321 321 321 321 321 321 321 321 321 Worse than Okay 494 494 494 494 494 494 494 494 494 Wireless Average 473 473 473 473 471 473 473 473 473 Better than Good 308 308 308 308 306 308 308 308 308 Worse than Okay 129 129 129 129 129 129 129 129 129 Xbox Average 307 307 307 307 307 307 307 307 307 Better than Good 354 354 354 354 354 354 354 354 354 Worse than Okay 160 160 160 160 160 160 160 160 160 Xbox 360 Average 631 631 631 631 631 631 631 631 631 Better than Good 646 646 646 646 646 646 646 646 646 Worse than Okay 354 354 354 354 354 354 354 354 354 iPhone Average 412 412 412 412 405 412 412 412 412 Better than Good 321 321 321 321 315 321 321 321 321 Worse than Okay 109 109 109 109 108 109 109 109 109 äº‹å®ä¸Šï¼Œä¸Šé¢çš„è¡¨æ ¼å¤§éƒ¨åˆ†å†…å®¹ä¹Ÿç”¨ä¸ä¸Šï¼Œæˆ‘ä»¬éœ€è¦çš„å…¶å®å°±ä¸‰åˆ—ï¼šæ¸¸æˆå¹³å°ï¼Œè¯„åˆ†é˜¶æ®µå’Œæ•°é‡ã€‚å› æ­¤æˆ‘å°±å‹ç¼©ä¸€ä¸‹åŸè¡¨æ ¼ï¼Œè®©å®ƒå˜æˆä¸‹é¢çš„æ ·å­ã€‚ 123count_df = filtered_reviews.groupby([\"platform\", \"score_phrase_new\"]).count().reset_index().iloc[:, :3]count_df.rename(columns=&#123;\"score_phrase\": \"count\"&#125;, inplace=True)count_df platform score_phrase_new count 0 Nintendo DS Average 462 1 Nintendo DS Better than Good 207 2 Nintendo DS Worse than Okay 376 3 PC Average 1394 4 PC Better than Good 1323 5 PC Worse than Okay 653 6 PlayStation Average 362 7 PlayStation Better than Good 313 8 PlayStation Worse than Okay 277 9 PlayStation 2 Average 716 10 PlayStation 2 Better than Good 542 11 PlayStation 2 Worse than Okay 428 12 PlayStation 3 Average 516 13 PlayStation 3 Better than Good 569 14 PlayStation 3 Worse than Okay 271 15 Wii Average 551 16 Wii Better than Good 321 17 Wii Worse than Okay 494 18 Wireless Average 473 19 Wireless Better than Good 308 20 Wireless Worse than Okay 129 21 Xbox Average 307 22 Xbox Better than Good 354 23 Xbox Worse than Okay 160 24 Xbox 360 Average 631 25 Xbox 360 Better than Good 646 26 Xbox 360 Worse than Okay 354 27 iPhone Average 412 28 iPhone Better than Good 321 29 iPhone Worse than Okay 109 æ•°æ®æ‹¿åˆ°æ‰‹äº†ï¼Œä¸‹é¢åˆè¯¥æ˜¯ç”¨å›¾å½¢å±•ç¤ºæ•°æ®çš„æ—¶å€™ã€‚è¿™æ¬¡æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹æ¯ä¸€ä¸ªè¯„åˆ†é˜¶æ®µå¯¹äºå„è‡ªæ¸¸æˆå¹³å°å æ¯”ç©¶ç«Ÿæ˜¯å¤šå°‘ã€‚ 1234567bar_width = 1bar_left = [i for i in range(len(count_df) // 3)]tick_pos = [i + (bar_width / 2) for i in bar_left]totals = [i + j + k for i, j, k in zip(count_df[\"count\"][::3], count_df[\"count\"][1::3], count_df[\"count\"][2::3])]ave_perc = [i / j * 100 for i, j in zip(count_df[\"count\"][::3], totals)]bt_good_perc = [i / j * 100 for i, j in zip(count_df[\"count\"][1::3], totals)]wt_okay_perc = [i / j * 100 for i, j in zip(count_df[\"count\"][2::3], totals)] 12345678910111213141516171819202122232425262728293031f, ax = plt.subplots(1) ax.bar(bar_left, wt_okay_perc, label=\"Worst than Okay\", alpha=0.9, width=bar_width, edgecolor=\"white\") ax.bar(bar_left, ave_perc, bottom=wt_okay_perc, label=\"Average\", alpha=0.9, width=bar_width, edgecolor=\"white\") ax.bar(bar_left, bt_good_perc, bottom=[i+j for i, j in zip(wt_okay_perc, ave_perc)], label=\"Better than Good\", alpha=0.9, width=bar_width, edgecolor=\"white\") plt.xticks(tick_pos, set(count_df[\"platform\"]))ax.set_ylabel(\"Percentage\")ax.set_xlabel(\"\")plt.legend(bbox_to_anchor=(1., 1.))plt.setp(plt.gca().get_xticklabels(), rotation=45, horizontalalignment=\"right\")plt.show() æˆ‘å¹¶æ²¡æœ‰ç›´æ¥æŠŠå…·ä½“ç™¾åˆ†æ¯”çš„æ•°å€¼æ ‡è®°åœ¨ä¸Šé¢ï¼Œä¸è¿‡é€šè¿‡ç›´è§‚çš„å›¾å½¢ä¾ç„¶å¯ä»¥çœ‹åˆ°ä¸€äº›ä¿¡æ¯ã€‚ä»å›¾ä¸­å¯ä»¥çœ‹å‡ºæ¥ï¼Œç›¸å¯¹æ¥è¯´ï¼ŒPlayStationï¼ŒPlayStation2ï¼ŒWiiï¼ŒPCå’ŒNintendo DSçš„æ¸¸æˆè´¨é‡éƒ½æ˜¯å¾ˆä¸é”™çš„ï¼Œé«˜è´¨é‡æ¸¸æˆå æ¯”é«˜ï¼Œä¸”ä½è´¨é‡æ¸¸æˆå æ¯”ä½ã€‚PlayStation3è™½ç„¶ä½è´¨é‡æ¸¸æˆå æ¯”å¾ˆå°ï¼Œä½†æ˜¯é«˜å“è´¨æ¸¸æˆä¹Ÿä¸ç®—å¾ˆå¤šã€‚iPhoneå’ŒXboxçš„è¡¨ç°ç®—æ˜¯æœ€å·®çš„äº†ï¼Œä½è´¨é‡æ¸¸æˆå æ¯”åˆ†å±æœ€é«˜çš„ä¸€äºŒï¼Œé«˜å“è´¨æ¸¸æˆä¹Ÿæ˜¯æœ€ä½çš„ä¸¤ä¸ªå¹³å°ã€‚å…¶å®iPhoneæ˜¯è¿™æ ·çš„å€’æ˜¯ä¸æ„å¤–äº†ï¼Œå› ä¸ºæ¯•ç«ŸiPhoneå¹³å°çš„èµ·ç‚¹ç›¸å¯¹äºå…¶ä»–çš„å¹³å°è¦ä½å¾ˆå¤šï¼ŒåŸºæœ¬ä¸Šä¸‰äº”ä¸ªäººï¼Œç”šè‡³ä¸€ä¸ªäººåšå‡ºçš„æ¸¸æˆéƒ½æœ‰ï¼Œè¿™æ ·å¾ˆéš¾ä¿è¯æ¸¸æˆå…¼é¡¾è¶£å‘³æ€§å’Œå‰§æƒ…æˆ–è€…å…¶ä»–æ–¹é¢ã€‚åœ¨åæœŸç»´æŠ¤ä¸Šé¢è‚¯å®šä¹Ÿè¦æ¯”å¤§å…¬å¸å¼€å‘çš„æ¸¸æˆå·®äº†å¾ˆå¤šã€‚é—æ†¾çš„æ˜¯Xboxç«Ÿç„¶ä¹Ÿæœ‰å¦‚æ­¤å·®åŠ²çš„è¡¨ç°ï¼Œç€å®ä»¤æˆ‘éš¾ä»¥ç†è§£ã€‚ æ€»ç»“è‡³æ­¤ï¼Œæˆ‘æ‰“ç®—åˆ†æçš„å†…å®¹å°±å‘ˆç°å®Œäº†ï¼Œè¿™å°±æ˜¯æˆ‘ä¸ªäººæ‹¿åˆ°æ•°æ®ä¹‹åä¸€ä¸ªç®€å•çš„æƒ³æ³•ï¼Œç„¶åè¯•ç€å»å°†è¿™ä¸ªæƒ³æ³•ç”¨æ•°æ®åˆ†æçš„æ–¹æ³•å±•ç°å‡ºæ¥ï¼Œä¾›è‡ªå·±å»ç†è§£ã€‚åé¢æˆ‘è¿˜ä¼šå¯¹è¿™ä¸ªæ•°æ®é›†è¿›ä¸€æ­¥çš„åˆ†æï¼Œæ¯”å¦‚å»æ¢è®¨ä¸€ä¸‹å¹´ä»½å’Œåˆ†æ•°çš„å…³ç³»ï¼Œæ¸¸æˆç±»åˆ«å’Œåˆ†æ•°çš„å…³ç³»ã€‚å¸Œæœ›è¿™ç¯‡æ–‡ç« å¯ä»¥èµ·åˆ°æŠ›ç –å¼•ç‰çš„ä½œç”¨ï¼Œèƒ½è®©å„ä½çœ‹å®Œä¹‹åå¯¹äºå¦‚ä½•å¼€å§‹åˆ†æä¸€ä»½æ•°æ®æœ‰è‡ªå·±çš„æƒ³æ³•ã€‚ å„ä½çœ‹å®˜å¯¹äºæœ¬æ–‡æœ‰ä»»ä½•ä¸æ˜ç™½çš„åœ°æ–¹ï¼Œæ¬¢è¿æé—®ï¼Œä¹Ÿæ¬¢è¿æŒ‡æ­£å’Œå»ºè®®ã€‚ Related Links Pandas Tutorial: Data analysis with Python: Part 1 Pandas Tutorial: Data analysis with Python: Part 2 Stacked Percentage Bar Plot In MatPlotLib"},{"title":"ç”¨Pythonåœ¨Hadoopä¸Šè·‘MapReduce","permalink":"http://yuannow.com/2017/09/29/Map-reduce-works-perfectly-with-Python/","text":"æœ¬æ–‡ç›®çš„è¿™ç¯‡æ–‡ç« ä¸»è¦ä¼šç»™å¤§å®¶ä»‹ç»ä¸€ä¸‹å¦‚ä½•å°†Pythonå’ŒHadoopç»“åˆèµ·æ¥å·¥ä½œã€‚æœ‰æ¥è§¦è¿‡MapReduceçš„æœ‹å‹éƒ½çŸ¥é“ï¼ŒHadoopçš„è¿è¡Œç¯å¢ƒä¸»è¦æ˜¯Javaï¼Œä¸€èˆ¬ä»‹ç»Hadoopå’ŒMapReduceçš„æ•™ç¨‹å’Œä¹¦ç±ä¹Ÿéƒ½æ˜¯åŸºäºJavaçš„ã€‚å› ä¸ºæˆ‘ä¸ªäººå¯¹Javaå¹¶ä¸å¤ªæ„Ÿå†’ï¼Œä¸€ç›´ä»¥æ¥é’Ÿæƒ…äºPythonçš„ç®€æ´å®ç”¨ç†å¿µï¼ŒåŒæ—¶åˆå¯¹MapReduceæœ‰å…´è¶£ï¼Œå› æ­¤èŒç”Ÿäº†Pythonçš„MapReduceç»“åˆçš„æƒ³æ³•ã€‚æœ¬æ–‡ä¹Ÿæ˜¯æˆ‘ç»è¿‡Googleå­¦ä¹ ä»–äººæ•™ç¨‹ï¼Œä»¥åŠè‡ªå·±å®é™…ç»ƒä¹ å¾—å‡ºæ¥çš„ä¸€äº›å¿ƒå¾—ï¼Œåœ¨æ­¤åˆ†äº«ç»™å„ä½ã€‚ ç¯å¢ƒæ­å»ºé¦–å…ˆï¼Œä½ éœ€è¦æœ‰ä¸ªHadoopçš„è¿è¡Œç¯å¢ƒï¼Œè¿˜æœ‰Pythonè¿è¡Œç¯å¢ƒã€‚æœ¬æ–‡ä¸»è¦ç›®çš„ä¸åœ¨åˆ†äº«å®‰è£…ç¯å¢ƒï¼Œå› æ­¤æœ‰ä»é›¶å¼€å§‹çš„æœ‹å‹ï¼Œå¯ä»¥å…ˆå»ç™¾åº¦æˆ–è€…Googleä¸Šæœä¸€ä¸‹ç›¸å…³æ•™ç¨‹ã€‚ä¸‹é¢åˆ†äº«å‡ ä¸ªç›¸å…³çš„æ•™ç¨‹ï¼š Hadoop: Setting up a Single Node Cluster Hadoopå®‰è£…æ•™ç¨‹_å•æœº/ä¼ªåˆ†å¸ƒå¼é…ç½®_Hadoop2.6.0/Ubuntu14.04 ä½¿ç”¨Dockeråœ¨æœ¬åœ°æ­å»ºHadoopåˆ†å¸ƒå¼é›†ç¾¤ MapReduce in Pythonä¸‹é¢æˆ‘å°±æ¥çœ‹Pythoné‡Œå¦‚ä½•å®ç°mapperå’Œreducerã€‚ mapper.pymapperè¦åšçš„å·¥ä½œå°±æ˜¯ä»stdiné‡Œè¯»å–æ•°æ®ï¼Œç„¶ååˆ†å‰²æˆ&lt;key, value&gt;çš„pairã€‚è¿™é‡Œä»¥æœ€åŸºç¡€çš„word countä¸ºä¾‹ï¼Œkeyå°±æ˜¯æŒ‡æ–‡ç« ä¸­æ‹†å‡ºæ¥çš„è¯ï¼Œvalueå°±æ˜¯æŒ‡æ¯ä¸ªè¯çš„ä¸ªæ•°ã€‚mapperæ˜¯ä¸ä¼šå°†ç›¸åŒçš„è¯çš„ä¸ªæ•°è¿›è¡Œç»Ÿè®¡åŠ å’Œçš„ï¼Œé‚£æ˜¯reducerçš„å·¥ä½œï¼Œå› æ­¤mapperçš„è¾“å‡ºå°±æ˜¯ç”±å¾ˆå¤šè¡Œ&lt;key&gt; 1ç»„æˆï¼Œä¸‹é¢ä¼šçœ‹åˆ°ç¨‹åºè¿è¡Œå®é™…çš„ç»“æœã€‚ mapper.py 1234567891011#!/usr/bin/env python3 import sys # ä»stdinä¸­è·å–è¾“å‡ºä¿¡æ¯for line in sys.stdin: words = line.strip().split(\" \") for word in words: # output format: word'\\t'1 print(\"&#123;0&#125;\\t&#123;1&#125;\".format(word, 1)) reducer.pyä¸Šé¢æåˆ°äº†ï¼Œmapperåªè¿›è¡Œè¯æ±‡åˆ†å‰²ï¼Œè®¡æ•°ä¸º1çš„å·¥ä½œï¼Œé‚£ä¹ˆreducerå°±æ˜¯ç”¨æ¥å°†ç›¸åŒè¯æ±‡çš„å‡ºç°æ¬¡æ•°è¿›è¡Œç»Ÿè®¡åŠ å’Œçš„å·¥ä½œã€‚åŒmapperä¸€æ ·ï¼Œreducerä¹Ÿæ˜¯ä»stdinä¸­è·å–è¾“å…¥ï¼Œç„¶åå°†ç»“æœè¾“å‡ºåˆ°stdoutã€‚ reducer.py 12345678910111213141516171819202122#!/usr/bin/env python3 import sys last_word = Nonetotal_count = 0 for line in sys.stdin: word, count = line.strip().split(\"\\t\") count = int(count) # å¦‚æœå½“å‰çš„wordä¸ç­‰äºä¸Šä¸€ä¸ªï¼Œè¯´æ˜å¼€å§‹æ–°çš„äº† if last_word and last_word != word: # è¿™é‡Œè¾“å‡ºç»“æœï¼Œç›¸å½“äºæŠŠç»“æœå†™è¿›stdout print(\"&#123;0&#125;\\t&#123;1&#125;\".format(last_word, total_count)) total_count = 0 last_word = word total_count += count # ä¸è¦å¿˜è®°æœ€åä¸€ä¸ªwordçš„è¾“å‡ºif last_word: print(\"&#123;0&#125;\\t&#123;1&#125;\".format(last_word, total_count)) æœ¬åœ°æµ‹è¯•æˆ‘ä»¬å…ˆæ¥æœ¬åœ°æµ‹è¯•ä¸€ä¸‹æ­£ç¡®æ€§ã€‚ 12345678YuanMBP:src Vergil$ echo \"ä¸œ å— è¥¿ åŒ— ä¸­ å‘ ç™½\" | demo/mapper.py ä¸œ 1å— 1è¥¿ 1åŒ— 1ä¸­ 1å‘ 1ç™½ 1 å†æ¥çœ‹ä¸€ä¸‹reducerï¼š 12345678YuanMBP:src Vergil$ echo \"ä¸œ å— è¥¿ åŒ— ä¸œ ä¸­ ä¸œ å‘ ä¸œ ç™½\" | demo/mapper.py | sort | demo/reducer.py ä¸œ 4ä¸­ 1åŒ— 1å— 1å‘ 1ç™½ 1è¥¿ 1 è¯·æ³¨æ„ï¼Œè¿™é‡Œæˆ‘åœ¨è¿è¡Œmapperå’Œreducerä¹‹é—´åŠ å…¥äº†ä¸€ä¸ªsortï¼Œè¿™æ˜¯å¿…é¡»çš„ï¼Œäº†è§£map-reduceå·¥ä½œåŸç†çš„æœ‹å‹åº”è¯¥éƒ½æ˜ç™½è¿™é‡Œä¸ºä»€ä¹ˆæœ‰ä¸€ä¸ªsortï¼Œå¦‚æœä¸åŠ çš„è¯ï¼Œæˆ‘ä»¬çš„ä¸œé£æ å°±è¯†åˆ«ä¸äº†å•¦ã€‚æˆ‘ä»¬åœ¨å†™mapperå’Œreducerçš„æ—¶å€™æ˜¯ä¸éœ€è¦å…³æ³¨å®ƒæ’åºçš„é—®é¢˜ï¼Œå› ä¸ºHadoopä¸­çš„map-reduceä¼šè‡ªåŠ¨è¿›è¡Œæ’åºã€‚ 1234567891011YuanMBP:src Vergil$ echo \"ä¸œ å— è¥¿ åŒ— ä¸œ ä¸­ ä¸œ å‘ ä¸œ ç™½\" | demo/mapper.py | demo/reducer.py ä¸œ 1å— 1è¥¿ 1åŒ— 1ä¸œ 1ä¸­ 1ä¸œ 1å‘ 1ä¸œ 1ç™½ 1 åœ¨Hadoopä¸Šè·‘ç¨‹åºå‡†å¤‡æµ‹è¯•æ•°æ®æˆ‘çš„è¿è¡Œç¯å¢ƒæ˜¯åœ¨Dockerä¸Šæ­å»ºçš„ï¼Œé¦–å…ˆæˆ‘ä»¬éœ€è¦å…ˆæŠŠç”¨æ¥æµ‹è¯•çš„æ–‡ç« æ”¾åˆ°HDFSé‡Œ 12345root@hadoop-master:~/src/demo# hdfs dfs -put words1.txt /inputroot@hadoop-master:~/src/demo# hdfs dfs -ls /inputFound 1 item-rw-r--r-- 2 root supergroup 127 2017-09-30 03:57 /input/words1.txtroot@hadoop-master:~/src/demo# words1.txt 1234Let me write down something trivialsomething that is not importantsomething that looks like bullshityes that is what I want æˆ‘å°±éšä¾¿å†™äº†å‡ å¥æ”¾åœ¨words1.txté‡Œï¼Œçœ‹çœ‹è¿è¡Œç»“æœæ˜¯å¦æ­£ç¡®ã€‚ è¿è¡ŒMapReduceç”¨è¿‡Javaç‰ˆHadoopçš„æœ‹å‹ï¼Œåº”è¯¥è¿˜æœ‰å°è±¡å¦‚ä½•ç¼–è¯‘è¿è¡Œå§ï¼Œå…¶å®å°±å’Œè¿è¡ŒJavaç¨‹åºçš„è¿‡ç¨‹å¾ˆåƒã€‚ä½†è¿™é‡Œç”¨Pythonæ¥æ‰§è¡Œï¼Œå°±ç¨å¾®æœ‰äº›ä¸å¤ªä¸€æ ·äº†ã€‚é¦–å…ˆæˆ‘ä»¬éœ€è¦ç”¨åˆ°ä¸€ä¸ªhadoop-streaming-2.x.x.jarè¿™æ ·çš„ä¸€ä¸ªå·¥å…·ï¼Œè¿™é‡Œxxä»£è¡¨ç‰ˆæœ¬å·ã€‚å®ƒçš„å…·ä½“è§£é‡Šå¯ä»¥å‚è€ƒHadoopå®˜æ–¹ç»™çš„Documentï¼Œæˆ‘è¿™é‡Œå°±åšä¸ªç®€å•çš„ä»‹ç»ã€‚Hadoop Streamingæ˜¯Hadoopæä¾›çš„ä¸€ä¸ªå·¥å…·ï¼Œå¯ä»¥è®©ä½ ä»¥ä»»æ„çš„å¯æ‰§è¡Œç¨‹åºæˆ–è„šæœ¬ï¼Œæ¥åˆ›å»ºå’Œè¿è¡ŒMapReduceï¼Œè¿™é‡Œå®˜ç½‘ç»™äº†ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼š 12345$HADOOP_HOME/bin/hadoop jar $HADOOP_HOME/hadoop-streaming.jar \\ -input myInputDirs \\ -output myOutputDir \\ -mapper /bin/cat \\ -reducer /bin/wc ç°åœ¨ï¼Œæˆ‘ä»¬æ¥ç”¨Hadoop Streamingæ¥è¿è¡Œè‡ªå·±çš„ç¨‹åºã€‚ 1234567root@hadoop-master:~/src/demo# hadoop jar ../hadoop-streaming-2.7.2.jar \\&gt; -input /input \\&gt; -output /output \\&gt; -mapper mapper.py \\&gt; -reducer reducer.py \\&gt; -file mapper.py \\&gt; -file reducer.py è¿™é‡Œæœ‰ä¸¤ç‚¹éœ€è¦æ³¨æ„ï¼š åé¢çš„ä¸¤ä¸ª-fileæ˜¯å¿…é¡»è¦åŠ çš„ï¼Œå¦åˆ™ç¨‹åºæ— æ³•é¡ºåˆ©è¿è¡Œï¼› mapper.pyå’Œreducer.pyè¦æå‰è®°å¾—èµ‹äºˆå®ƒä»¬å¯æ‰§è¡Œçš„å±æ€§ã€‚ æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬æ¥éªŒæ”¶ä¸€ä¸‹ç¨‹åºçš„ç»“æœï¼š 1234567891011121314151617181920212223root@hadoop-master:~/src/demo# hdfs dfs -ls /outputFound 2 items-rw-r--r-- 2 root supergroup 0 2017-09-30 04:31 /output/_SUCCESS-rw-r--r-- 2 root supergroup 128 2017-09-30 04:31 /output/part-00000root@hadoop-master:~/src/demo# hdfs dfs -cat /output/part*I 1Let 1bullshit 1down 1important 1is 2like 1looks 1me 1not 1something 3that 3trivial 1want 1what 1write 1yes 1root@hadoop-master:~/src/demo# è¯•ä¸€ä¸‹å¤šæ–‡ä»¶çœ‹çœ‹æœ‰æ²¡æœ‰é—®é¢˜ï¼Œæˆ‘å°†words1.txtå¤åˆ¶å‡ºä¸€æ¨¡ä¸€æ ·çš„ä¸¤ä»½ï¼Œä¹Ÿå°±æ˜¯ç°åœ¨æœ‰ä¸‰ä»½ç›¸åŒçš„è¾“å…¥æ–‡ä»¶ï¼Œå†æ¥è·‘ä¸€éè¯•è¯•ï¼š 123456root@hadoop-master:~/src/demo# hdfs dfs -rm -r /output17/09/30 04:48:37 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.Deleted /outputroot@hadoop-master:~/src/demo# ./run_script.sh /input /output mapper.py reducer.py Running python in Hadoop by hadoop streaming... è¿™é‡Œæˆ‘è‡ªå·±åšäº†run_script.shè¿™æ ·å­ä¸€ä¸ªshell scriptï¼Œç”¨æ¥ç¼©çŸ­æ‰§è¡Œå‘½ä»¤çš„é•¿åº¦ï¼Œä¸ç„¶æ¯æ¬¡éƒ½è¦è¾“å…¥é‚£ä¹ˆé•¿çœŸçš„å¥½éº»çƒ¦â€¦â€¦ 123456789101112131415161718root@hadoop-master:~/src/demo# hdfs dfs -cat /output/part*I 3Let 3bullshit 3down 3important 3is 6like 3looks 3me 3not 3something 9that 9trivial 3want 3what 3write 3yes 3 çœ‹ä¸Šå»æ²¡æœ‰ä»»ä½•é—®é¢˜ã€‚ åè®°æ›´å¤šçš„å…³äºHadoop Streamingçš„å†…å®¹ï¼Œè¿˜å¸Œæœ›å¤§å®¶å»å®˜ç½‘æ–‡æ¡£ä¸­æŸ¥é˜…ã€‚ä¾‹å¦‚åƒåˆ†é…mapå’Œreduceçš„æ•°é‡ï¼Œè®¾ç½®partitionerï¼Œè¿™æ ·çš„å‚æ•°éƒ½å¯ä»¥é€šè¿‡Hadoop Streamingæ¥è°ƒæ•´ï¼Œè¿˜æ˜¯å¾ˆæœ‰æ„æ€çš„ã€‚ åœ¨ä¸‹ä¸€ç¯‡å…³äºMapReduceçš„æ–‡ç« ä¸­æˆ‘ä¼šä»‹ç»ä¸€ä¸ªç›¸æ¯”è¾ƒäºword countå¤æ‚ä¸€ç‚¹çš„ä¾‹å­ï¼Œä¾ç„¶æ˜¯ç”¨Pythonå’ŒHadoopçš„ç»“åˆã€‚ Related Links Writing an hadoop mapreduce program in python Hadoop Streaming Documentation"},{"title":"Migrated from Heroku to Netlify","permalink":"http://yuannow.com/2017/09/28/Netlify/","text":"ä¹‹å‰å­¦ä¹ ruby on railsçš„æ—¶å€™ï¼Œå¼€å§‹æ¥è§¦çš„Herokuã€‚è¿™æ¬¡éƒ¨ç½²ä¸ªäººåšå®¢ï¼Œæƒ³ç€Herokuåº”è¯¥æ˜¯ä¸ªä¸é”™çš„é€‰æ‹©å§ï¼Œä½†è¯•ç”¨äº†å‡ å¤©çš„Herokuä¹‹åï¼Œæˆ‘å†³å®šè¿˜æ˜¯è½¬åˆ°å…¶ä»–åœ°æ–¹éƒ¨ç½²æˆ‘çš„blogï¼Œä¸ºä»€ä¹ˆå‘¢ï¼ŸåŸå› æœ‰äºŒï¼š å…è´¹çš„Heroku Appï¼Œå¦‚æœæç½®æ—¶é—´é•¿äº†ä¸€ç›´æ— äººè®¿é—®çš„è¯ï¼Œå†æ¬¡è®¿é—®æ˜¯éœ€è¦ä¸€å®šæ—¶é—´ç­‰å¾…æ¿€æ´»çš„ï¼Œå°±åƒæ˜¯ç”µè„‘ç¡çœ äº†ç­‰ç€å«é†’ä¸€æ ·ã€‚ä»˜è´¹çš„è¯å¤ªè´µï¼Œå¯¹äºåªæ˜¯æ­è½½ä¸ªäººåšå®¢è€Œè¨€ä¸å¤ªåˆ’ç®—ï¼› HerokuæœåŠ¡å™¨æ˜¯åœ¨ç¾å›½å’Œæ¬§æ´²ï¼Œè€Œä¸”ä¸€ä¸ªAppåªèƒ½å­˜åœ¨åœ¨æŸä¸€ä¸ªåŒºåŸŸï¼Œä¸å¯å˜ã€‚æ‰€ä»¥å¯¹äºå›½å†…çš„æœ‹å‹ï¼Œç™»å½•æˆ‘çš„åšå®¢æœ‰æ—¶ä¼šæœ‰ä¸å°çš„å»¶è¿Ÿï¼Œè™½ç„¶å¯¹äºä¸€ä¸ªé™æ€ç½‘ç«™ï¼Œæœ¬æ¥ä¹Ÿæ— éœ€å¾ˆå¿«çš„å“åº”é€Ÿåº¦ï¼Œä½†é…åˆç¬¬ä¸€æ¡ï¼Œè¿™ä¸ªæ—¶é—´æœ‰æ—¶çœŸçš„è®©äººæ— è¯­â€¦â€¦ é‚£ä¹‹æ‰€ä»¥é€‰æ‹©Netlifyä¹Ÿæ˜¯æœ‰ä¸¤ä¸ªåŸå› ï¼š ä¸å­˜åœ¨Herokuçš„ç¬¬ä¸€ä¸ªé—®é¢˜ï¼› é™æ€å†…å®¹éƒ¨ç½²é‡‡ç”¨çš„æ˜¯global CDNæ–¹å¼ï¼Œè¿™æ ·ç”¨æˆ·ç™»å½•åšå®¢çš„æ—¶å€™ä¼šæ ¹æ®ç”¨æˆ·æ‰€åœ¨åœ°é€‰å–æœ€è¿‘çš„èŠ‚ç‚¹è·å–ä¿¡æ¯ã€‚ é™¤äº†è¿™ä¸¤ç‚¹ä»¥å¤–ï¼ŒNetlifyçš„è®¾ç½®ç•Œé¢ä¹Ÿåšå¾—ååˆ†ç®€æ´æ˜“ç”¨ï¼Œç›¸æ¯”Herokuè€Œè¨€ï¼Œç”šè‡³è¿éƒ¨ç½²éƒ½æ›´åŠ ç®€å•ï¼Œé™¤äº†åˆ©ç”¨gitéƒ¨ç½²ï¼Œè¿˜å¯ä»¥ç›´æ¥æŠŠç”Ÿæˆå¥½çš„é™æ€ç½‘é¡µæ–‡ä»¶å¤¹æ‹–åŠ¨åˆ°ä¸€ä¸ªéƒ¨ç½²æ¡†å†…"},{"title":"Hello World","permalink":"http://yuannow.com/2017/09/26/hello-world/","text":"å‰è¨€ç»ˆäºå°†ä¸ªäººåšå®¢æ­å»ºèµ·æ¥äº†â€¦â€¦è™½ç„¶å¬è¯´Hexoæ­å»ºåšå®¢ååˆ†å®¹æ˜“ï¼Œä½†å¯¹äºå‰ç«¯å®Œå…¨ä¸äº†è§£çš„æˆ‘ï¼Œé¢‡è´¹äº†ä¸€ç•ªåŠŸå¤«ã€‚ Hexoåˆå§‹åŒ–è¿™ä¸ªåšå®¢ç›®å½•æ—¶ï¼Œè‡ªå¸¦äº†ä¸€ä¸ªä»¥â€œHello Worldâ€ä¸ºæ ‡é¢˜çš„æ–‡ç« ï¼Œè€ƒè™‘åˆ°â€œHello Worldâ€æ˜¯ä½œä¸ºå­¦ä¹ ç¼–ç¨‹ä»£ç ç¬¬ä¸€è¯¾ï¼Œä½œä¸ºä¸€ä¸ªæ ‡å‡†ç å†œçš„æˆ‘å°±å†³å®šæ²¿è¢­è¿™ä¸ªä¼ ç»Ÿï¼Œ ä»æ­¤å¼€å§‹è‡ªå·±çš„åšå®¢ä¹‹æ—…ã€‚ Hello Hexo Hello World"}]}