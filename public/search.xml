<?xml version="1.0" encoding="utf-8"?>
<search> 
  
    
    <entry>
      <title><![CDATA[ç”¨Pythonåœ¨Hadoopä¸Šå®ç°æœç´¢è‡ªåŠ¨è¡¥å…¨]]></title>
      <url>/2017/10/09/Implement-Search-Auto-Complete-by-Python-Hadoop/</url>
      <content type="html"><![CDATA[<p><img src="/images/autocomplete/autocomplete.png" alt="search autocomplete">
è®°å¾—å¾ˆæ—©çš„æ—¶å€™ï¼Œåˆšå¼€å§‹æ¥è§¦æœç´¢å¼•æ“ï¼Œé‚£æ—¶å€™Googleè¿˜æ²¡æœ‰è¢«å¢™ï¼Œç™¾åº¦ä¹Ÿæ˜¯åˆšåˆšè¯ç”Ÿæ²¡å¤šä¹…ï¼Œæ— è®ºæˆ‘åœ¨è¾“å…¥æ¡†å†…è¾“å…¥ä»€ä¹ˆï¼Œåªæ˜¯æ˜¾ç¤ºæˆ‘è¾“å…¥çš„å†…å®¹ï¼Œå¹¶æ²¡æœ‰ä»»ä½•è”æƒ³åŠŸèƒ½æç¤ºæˆ‘æ¥ä¸‹æ¥å¯èƒ½åŒ¹é…çš„å†…å®¹ã€‚æœ‰æ—¶å€™æƒ³æ‰¾ä¸ªä¸œè¥¿ï¼Œå¯å°±æ˜¯æ­»æ´»æƒ³ä¸èµ·æ¥å‡†ç¡®çš„åå­—æˆ–è€…æè¿°æ–¹å¼ï¼Œè¿™ä¸ªæ—¶å€™æœç´¢å¼•æ“ä¹Ÿå¸®ä¸äº†ä½ ï¼Œä½ åªèƒ½å˜ç€æ³•çš„å°è¯•å„ç§è¾“å…¥ï¼Œæ¥å¯»æ±‚æœ€ç»ˆä½ æƒ³è¦çš„ç»“æœã€‚åæ¥æœç´¢å¼•æ“åŠ å…¥äº†è”æƒ³åŠŸèƒ½ï¼Œè¿™ç€å®æ˜¯ä¸€å¤§è¿›æ­¥ï¼Œæå¤§åœ°æé«˜äº†æœç´¢æ•ˆç‡ã€‚æœ‰çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯¹äºæƒ³æŸ¥è¯¢çš„æŸä¸€é—®é¢˜çš„æé—®æ–¹å¼æ˜¯å¾ˆæ¨¡ç³Šçš„ï¼Œè¿™ä¸ªæ—¶å€™å½“ä½ è¾“å…¥äº†ä¸€äº›å…³é”®è¯ï¼Œå‘ç°æœç´¢å¼•æ“ä¼šæ ¹æ®ä½ çš„è¾“å…¥ç»™ä½ ä¸€äº›åç»­å†…å®¹çš„å»ºè®®ï¼Œä¼šè®©ä½ æ›´å®¹æ˜“çš„æ‰¾åˆ°è‡ªå·±æƒ³è¦çš„ç­”æ¡ˆã€‚</p>
<h1 id="æœ¬æ–‡ç›®çš„"><a href="#æœ¬æ–‡ç›®çš„" class="headerlink" title="æœ¬æ–‡ç›®çš„"></a>æœ¬æ–‡ç›®çš„</h1><p>ä¸Šä¸€ç¯‡æˆ‘åœ¨ã€Šç”¨Pythonåœ¨Hadoopä¸Šè·‘MapReduceã€‹ä¸­ä»‹ç»äº†ä¸€äº›å…³äºå¦‚ä½•åˆ©ç”¨<code>Hadoop Streaming</code>è¿è¡ŒPythonç‰ˆMapReduceçš„ç®€å•æ“ä½œï¼Œå¦‚ä½•å®ç°è¯é¢‘ç»Ÿè®¡å°±åƒæ˜¯MapReduceä¸­çš„<em>Hello World</em>ï¼Œä¸è¿‡åšå®Œäº†å…¥é—¨æ•™ç¨‹ï¼Œä¸ºäº†æ·±å…¥å­¦ä¹ ï¼Œè¿˜å¾—éœ€è¦æ›´å¤šçš„ç»ƒä¹ ã€‚</p>
<p>åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘å°†ä¼šå¸¦å„ä½å®ç°ä¸€ä¸ªå¾ˆç®€å•çš„æœç´¢è”æƒ³åŠŸèƒ½ï¼Œæ¯”è¾ƒç²—ç³™ï¼Œä½†æ˜¯çœ‹èµ·æ¥ä¹ŸæŒºåƒé‚£ä¹ˆå›äº‹çš„~</p>
<a id="more"></a>
<hr>
<h1 id="æ­£æ–‡"><a href="#æ­£æ–‡" class="headerlink" title="æ­£æ–‡"></a>æ­£æ–‡</h1><p>ä¸ºäº†å®ç°<code>autocomplete</code>ï¼Œé¦–å…ˆéœ€è¦ææ¸…æ¥šå®ƒèƒŒåçš„åŸç†ï¼Œæœç´¢å¼•æ“ç©¶ç«Ÿæ˜¯æ ¹æ®ä»€ä¹ˆæ¥ç»™å‡ºæç¤ºçš„ï¼Ÿæ¯”å¦‚æˆ‘è¾“å…¥ä¸€ä¸ª<code>autocomplete</code>ä¹‹åï¼Œä¸ºä»€ä¹ˆåé¢æ¨èçš„æ˜¯<em>python</em>ï¼Œ<em>algorithm</em>ä¹‹ç±»çš„ï¼Œè€Œä¸æ˜¯<em>Naruto</em>ï¼Œ<em>One Piece</em>è¿™äº›å‘¢ï¼Ÿ</p>
<p>æ— è®ºæ˜¯ç™¾åº¦è¿˜æ˜¯è°·æ­Œï¼Œå…¶å®åœ¨å¤§å®¶ç”¨å®ƒä»¬çš„æœç´¢å¼•æ“æ”¶é›†ä½ éœ€è¦çš„ä¿¡æ¯çš„æ—¶å€™ï¼Œå®ƒä»¬ä¹ŸåŒæ ·åœ¨æ”¶é›†ä¿¡æ¯ã€‚å®ƒä»¬æ”¶é›†äº†å¤§é‡çš„ç”¨æˆ·æœç´¢çš„è¾“å…¥ä¿¡æ¯ï¼ŒåŒæ—¶è¿˜åœ¨æŠ“å–å„ç§ç½‘é¡µå†…å®¹çš„ä¿¡æ¯ï¼Œç®€å•æ¥è¯´ï¼Œæœç´¢å¼•æ“é€šè¿‡æŸç§ç®—æ³•å°†å„ç§æ”¶é›†åˆ°çš„èµ„æ–™ç»¼åˆåˆ°ä¸€èµ·ï¼Œæœ€ç»ˆç»™å‡ºäº†ä¸€ä¸ªè¾“å…¥è”æƒ³çš„åˆ—è¡¨ï¼Œè¿™å°±æ˜¯è‡ªåŠ¨è¡¥å…¨åŠŸèƒ½ã€‚</p>
<p>ç§ä¸‹é‡Œä½œä¸ºå­¦ä¹ MapReduceçš„é¡¹ç›®ï¼Œæˆ‘ä»¬è‚¯å®šä¸å¯èƒ½å»è¯•å›¾å®ç°çœŸæ­£çš„æœç´¢å¼•æ“ã€‚ä¸è¿‡åšä¸€ä¸ªç®€é™‹ç‰ˆçš„ï¼Œå¸®åŠ©è‡ªå·±ç†è§£<code>autocomplete</code>èƒŒåçš„å®ç°åŸç†ï¼Œä»¥åŠå¦‚ä½•åˆ©ç”¨MapReduceæ¥å®ç°ï¼Œä¹Ÿæ˜¯è¶³å¤Ÿçš„ã€‚</p>
<hr>
<h2 id="N-Gram"><a href="#N-Gram" class="headerlink" title="N-Gram"></a>N-Gram</h2><p>å¯¹äºautocompleteèƒŒåå®ç°çš„åŸç†ï¼Œå¾ˆé‡è¦çš„ä¸€ç‚¹å°±æ˜¯N-Gramï¼Œ<a href="http://blog.sciencenet.cn/blog-713101-797384.html" target="_blank" rel="external">è¿™ç¯‡æ–‡ç« </a>æœ‰ç®€æ˜çš„ä»‹ç»ï¼Œä¸¾ä¸ªä¾‹å­å¥½äº†ï¼š<code>implement search autocomplete in python</code></p>
<ul>
<li>è¿™å¥è¯å¦‚æœæŒ‰2-Gramåˆ’åˆ†çš„è¯ï¼Œå°±æ˜¯<code>implement search</code>ï¼Œ<code>search autocomplete</code>ï¼Œ<code>autocomplete in</code>ï¼Œ<code>in python</code>ï¼›</li>
<li>é‚£ä¹ˆæŒ‰ç…§3-Gramåˆ’åˆ†çš„è¯ï¼Œå°±æ˜¯<code>implement search autocomplete</code>ï¼Œ<code>search autocomplete in</code>ï¼Œ<code>autocomplete in python</code>ï¼›</li>
<li>æŒ‰ç…§4-Gramåˆ’åˆ†çš„è¯ï¼Œå°±æ˜¯<code>implement search autocomplete in</code>ï¼Œ<code>search autocomplete in python</code>ï¼›</li>
<li>æŒ‰ç…§5-Gramåˆ’åˆ†çš„è¯ï¼Œå°±æ˜¯ä¸€æ•´å¥è¯ï¼Œä¸ä½œä»»ä½•åˆ‡å‰²ã€‚</li>
</ul>
<p>è¿™é‡Œæˆ‘æ²¡æœ‰ç»™å‡º1-Gramçš„ä¾‹å­ï¼Œå„ä½å¯ä»¥æ€è€ƒä¸€ä¸‹æ˜¯ä¸ºä»€ä¹ˆï¼Œè¿™é‡Œå…ˆå–ä¸ªå…³å­ï¼Œä¸‹é¢ä¼šæåˆ°åŸå› ã€‚è¿™é‡Œæˆ‘ä»¬å…ˆå›å¤´æ€è€ƒä¸€ä¸‹æœç´¢å¼•æ“ç»™å‡ºçš„è”æƒ³è¯æ±‡ï¼Œæ¯”å¦‚æˆ‘è¾“å…¥äº†ä¸€ä¸ª<code>autocomplete</code>ï¼Œé‚£ä¹ˆåé¢ä½ è§‰å¾—æ˜¯ç»™å‡º<code>in python</code>çœ‹ä¸Šå»æ›´è‡ªç„¶è¿˜æ˜¯<code>Transformer</code>æ›´åˆç†ï¼Ÿæ˜¾ç„¶æ˜¯å‰è€…å¯¹ä¹ˆï¼Œå¦‚æœç»™å‡ºäº†åè€…ï¼Œä½ å¯èƒ½ä¼šæƒ³ï¼š<code>autocomplete Transformer</code>æ˜¯ä»€ä¹ˆé¬¼ï¼Ÿï¼éš¾é“æ˜¯æŸç§æ–°å‹å˜å½¢é‡‘åˆšä¹ˆï¼Ÿæ²¡å¬è¿‡å•Šï¼é‚£ä¹‹æ‰€ä»¥ä¼šæœ‰è¿™æ ·çš„æ„Ÿè§‰ï¼Œæ˜¯å› ä¸ºä»æˆ‘ä»¬å¹³æ—¶è·å–çš„ä¿¡æ¯ä¸­ï¼Œæˆ‘ä»¬å¯¹äº<code>autocomplete</code>è¿™ä¸ªè¯åé¢çš„è¡”æ¥è¯æ¥æ”¶åˆ°çš„ä¹Ÿæ˜¯<code>in python</code>è¿œè¿œå¤šäº<code>Transformer</code>ï¼Œå¯¹å§ï¼Ÿæ‰€ä»¥è¯´åˆ°è¿™é‡Œå°±å¤§æ¦‚æœ‰ç‚¹æ˜æ™°äº†ï¼Œæœç´¢å¼•æ“å¯¹äºè”æƒ³è¯æ±‡çš„æ¨èä¹Ÿæœ‰è¿™æ–¹é¢çš„è€ƒè™‘ï¼Œæˆ‘ä»¬ç»™è¾“å…¥ä¸€ä¸ªæˆ–å¤šä¸ªå¼•å¯¼è¯ï¼Œ<code>autocomplete</code>åŠŸèƒ½å°†åé¢æœ€æœ‰å¯èƒ½å‡ºç°çš„å‡ ç§é€‰æ‹©å±•ç°ç»™æˆ‘ä»¬ã€‚æ‰€ä»¥è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆç”¨åˆ°N-Gramçš„åŸå› ï¼Œè¿™é‡Œå…¶å®å°±æ˜¯ä¸€ä¸ªå¥å­åˆ†å‰²çš„è¿‡ç¨‹ã€‚</p>
<p>é‚£ä¹ˆè¿™é‡Œå°±å¼•å‡ºäº†ä¸‹ä¸€ä¸ªé—®é¢˜ï¼šæ˜¯è¯¥åŸºäºä¸€å¥è¯æœ€åä¸€ä¸ªè¯æ¥é¢„æµ‹åé¢çš„æ¨èï¼Œè¿˜æ˜¯æ ¹æ®æ›´å¤šçš„è¯ç”šè‡³ä¸€æ•´å¥æ¥é¢„æµ‹ä¸‹é¢çš„å‡ºç°å‘¢ï¼Ÿ</p>
<p>è¿˜ç»§ç»­ä»¥ä¸Šé¢çš„ä¾‹å­è¯´å¥½äº†ã€‚å‡è®¾æˆ‘å·²ç»è¾“å…¥äº†<code>implement search autocomplete in</code>ï¼Œå¦‚æœæ˜¯æŒ‰ç…§æœ€åä¸€ä¸ªå‡ºç°çš„è¯æ¥è¿›è¡Œè”æƒ³ï¼Œé‚£ä¹ˆ<code>in</code>åé¢å…¶å®å¯ä»¥è·Ÿå¾ˆå¤šå¾ˆå¤šå†…å®¹ï¼Œéƒ½ä¸ä¼šè¿å’Œï¼Œå¯¹å§ï¼Ÿæ¯”å¦‚<code>in box</code>ï¼Œ<code>in air</code>ï¼Œ<code>in heart</code>ç­‰ç­‰ï¼Œä½†å¦‚æœæŠŠè¿™äº›è”æƒ³æ”¾åˆ°ä¸€æ•´å¥ä¸­ï¼Œæ˜¾ç„¶æ˜¯ä¸å¤ªåˆç†çš„ã€‚å› æ­¤ï¼Œæˆ‘ä»¬åœ¨å®ç°<code>autocomplete</code>çš„æ—¶å€™ï¼Œå…¶å®æ˜¯<strong>åŸºäºN-Gramé¢„æµ‹N-Gram</strong>ã€‚</p>
<p>é‚£åˆ°è¿™é‡Œï¼Œå…¶å®<code>autocomplete</code>çš„å®ç°çš„å¤§è‡´æ€è·¯å°±åº”è¯¥æœ‰äº†ã€‚æˆ‘ä»¬éœ€è¦å°†å¤§æ‰¹é‡çš„æ–‡æ¡£ç”¨N-Gramçš„å¤„ç†æ–¹å¼è¿›è¡Œåˆ‡å‰²ï¼Œç»Ÿè®¡ç›¸åŒçŸ­è¯­å‡ºç°çš„é¢‘æ¬¡ï¼Œæ„å»ºN-Gramçš„æ¨¡å‹ï¼Œç„¶åæ‰¾å‡ºæ¯ä¸ªçŸ­è¯­ä¹‹åå‡ºç°é¢‘æ¬¡æœ€é«˜çš„å‡ ä¸ªè¯æ±‡ä½œä¸ºé¢„æµ‹ä¿å­˜ä¸‹æ¥ã€‚æœ€ç»ˆå°†ç»“æœå­˜å…¥æ•°æ®åº“ï¼Œä»¥æ–¹ä¾¿ä¹‹åè°ƒç”¨ã€‚ä¸‹é¢æˆ‘ä»¬å°±æ¥çœ‹çœ‹å¦‚ä½•ä¸€æ­¥æ­¥å…·ä½“å®ç°ã€‚</p>
<hr>
<h2 id="MapReduceå®ç°"><a href="#MapReduceå®ç°" class="headerlink" title="MapReduceå®ç°"></a>MapReduceå®ç°</h2><h3 id="N-Gramæ¨¡å‹æ„å»º"><a href="#N-Gramæ¨¡å‹æ„å»º" class="headerlink" title="N-Gramæ¨¡å‹æ„å»º"></a>N-Gramæ¨¡å‹æ„å»º</h3><p>åœ¨è¿™æ¬¡çš„ä»£ç å®ç°ä¸­ï¼Œæˆ‘ä»¬éœ€è¦ç”¨åˆ°ä¸¤ä¸ªmapperå’Œreducerã€‚é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦ä¸€å¯¹mapperå’Œreducerå°†è¾“å…¥çš„æ–‡æ¡£è¿›è¡Œåˆ‡å‰²ã€‚</p>
<p><code>n_gram_mapper.py</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> sys</div><div class="line"><span class="keyword">import</span> string</div><div class="line"><span class="keyword">import</span> re</div><div class="line">    </div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">(N_Gram)</span>:</span></div><div class="line">    <span class="keyword">for</span> line <span class="keyword">in</span> sys.stdin:</div><div class="line">        <span class="comment"># å»é™¤æ‰€æœ‰çš„æ ‡ç‚¹ç¬¦å·</span></div><div class="line">        translator = str.maketrans(string.punctuation, <span class="string">" "</span> * len(string.punctuation))</div><div class="line">        line = line.translate(translator).strip().lower()</div><div class="line">        </div><div class="line">        <span class="comment"># å»é™¤æ‰€æœ‰çš„æ•°å­—</span></div><div class="line">        line = re.sub(<span class="string">"\d"</span>, <span class="string">" "</span>, line)</div><div class="line">        </div><div class="line">        <span class="comment"># æŒ‰ç…§ç©ºæ ¼æˆ–è€…\tæ¥åˆ‡å‰²</span></div><div class="line">        words = re.split(<span class="string">"\\s+"</span>, line)</div><div class="line">        <span class="keyword">if</span> len(words) &lt; <span class="number">2</span>:</div><div class="line">            <span class="keyword">continue</span></div><div class="line">            </div><div class="line">        <span class="keyword">for</span> i, word <span class="keyword">in</span> enumerate(words):</div><div class="line">            result = word</div><div class="line">            <span class="keyword">for</span> j, next_word <span class="keyword">in</span> enumerate(words[i+<span class="number">1</span>:], <span class="number">1</span>):</div><div class="line">                <span class="keyword">if</span> j &lt; N_Gram:</div><div class="line">                    result += <span class="string">" "</span></div><div class="line">                    result += next_word</div><div class="line">                    print(<span class="string">"&#123;&#125;\t&#123;&#125;"</span>.format(result, <span class="number">1</span>))</div><div class="line">                    </div><div class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</div><div class="line">    main(<span class="number">5</span>)</div></pre></td></tr></table></figure>
<p>å¦‚æœä½ æƒ³æ„å»ºä¸€ä¸ª<strong>N=5</strong>çš„N-Gramæ¨¡å‹ï¼Œé‚£ä¹ˆåœ¨mapperé‡Œï¼Œå°±éœ€è¦å°†2åˆ°5çš„åˆ†å‰²æ–¹å¼éƒ½è¾“å‡ºã€‚è¿˜è®°å¾—ä¸Šé¢æˆ‘æœ‰ç•™ä¸€ä¸ªæ‚¬å¿µï¼Œä¸ºä»€ä¹ˆä¸è€ƒè™‘1-Gramä¹ˆï¼Ÿå› ä¸ºæ˜¾ç„¶1-Gramæ˜¯æ²¡æœ‰ç”¨çš„ï¼Œå®ƒå¹¶ä¸èƒ½å‘Šè¯‰æˆ‘ä¸€ä¸ªçŸ­è¯­åé¢å¯èƒ½å‡ºç°çš„è¯æœ‰ä»€ä¹ˆã€‚</p>
<p><code>n_gram_reducer.py</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> sys</div><div class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> groupby</div><div class="line"><span class="keyword">from</span> operator <span class="keyword">import</span> itemgetter</div><div class="line">    </div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">parse_output</span><span class="params">(std_input)</span>:</span></div><div class="line">    <span class="comment"># åˆ©ç”¨generatorèŠ‚çœMapReduceå†…å­˜ä½¿ç”¨ç©ºé—´</span></div><div class="line">    <span class="keyword">for</span> line <span class="keyword">in</span> std_input:</div><div class="line">        <span class="keyword">yield</span> line.strip().split(<span class="string">"\t"</span>)</div><div class="line">        </div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></div><div class="line">    data = parse_output(sys.stdin)</div><div class="line">    <span class="keyword">for</span> word, group <span class="keyword">in</span> groupby(data, itemgetter(<span class="number">0</span>)):</div><div class="line">        <span class="keyword">try</span>:</div><div class="line">            total_count = sum(int(count) <span class="keyword">for</span> word, count <span class="keyword">in</span> group)</div><div class="line">            print(<span class="string">"&#123;&#125;\t&#123;&#125;"</span>.format(word, total_count))</div><div class="line">        <span class="keyword">except</span> ValueError:</div><div class="line">            <span class="keyword">continue</span></div><div class="line">            </div><div class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</div><div class="line">    main()</div></pre></td></tr></table></figure>
<p>è¿™å›çš„reduceræˆ‘ç”¨åˆ°äº†<code>generator</code>æ¥è°ƒç”¨æ•°æ®ï¼Œè¿™æ ·åšå¯ä»¥æœ‰æ•ˆèŠ‚çœå†…å­˜å ç”¨ç©ºé—´ã€‚å› ä¸ºéšç€è¾“å…¥æ•°æ®é‡çš„è¶Šæ¥è¶Šå¤§ï¼Œå³ä¾¿æ˜¯5-Gramï¼Œä¾ç„¶ä¹Ÿæ˜¯ä¸ªå¾ˆåºå¤§çš„è®°å½•æ•°é‡ã€‚ä¸‹é¢çš„ä¸»å‡½æ•°éƒ¨åˆ†ï¼Œæˆ‘ä¹Ÿæ”¾å¼ƒäº†ä¹‹å‰çš„ç®€å•ç”¨æ³•ï¼Œç”¨groupbyå¯ä»¥æ˜æ˜¾æå‡ä»£ç çš„é˜…è¯»é€»è¾‘ï¼Œå¯¹<code>itertools.groupby</code>ä¸å¤ªç†Ÿæ‚‰çš„æœ‹å‹å¯ä»¥çœ‹<a href="https://docs.python.org/3/library/itertools.html" target="_blank" rel="external">è¿™ä»½å®˜æ–¹æ–‡æ¡£</a>ã€‚</p>
<h3 id="N-Gramæµ‹è¯•ç»“æœ"><a href="#N-Gramæµ‹è¯•ç»“æœ" class="headerlink" title="N-Gramæµ‹è¯•ç»“æœ"></a>N-Gramæµ‹è¯•ç»“æœ</h3><p>åšä¸‹ä¸€æ­¥ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆæ¥æœ¬åœ°æµ‹è¯•ä¸€ä¸‹è¿™ä¸€å¯¹mapperå’Œreduceræ˜¯å¦å¥½ç”¨ã€‚</p>
<p>æµ‹è¯•æ–‡æ¡£ï¼šæˆ‘ç›´æ¥æŠŠ<a href="https://en.wikipedia.org/wiki/MapReduce" target="_blank" rel="external">MapReduce</a>çš„Wikié‡Œå¤´ä¸€æ®µå…³äºå®ƒçš„è¯´æ˜è§£é‡Šï¼Œç²˜è´´ä¸‹æ¥ä½œä¸ºæµ‹è¯•æ–‡æ¡£ç”¨ã€‚
<figure class="highlight console"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line">root@hadoop:~/src/p2py# cat input/file2.txt | ./n_gram_mapper.py | sort | ./n_gram_reducer.py</div><div class="line">a cluster	1</div><div class="line">a good	1</div><div class="line">a good mapreduce	1</div><div class="line">a good mapreduce algorithm	1</div><div class="line">a map	1</div><div class="line">a map procedure	1</div><div class="line">a map procedure method	1</div><div class="line">a map procedure method that	1</div><div class="line">a mapreduce	1</div><div class="line">a mapreduce program	1</div><div class="line">a mapreduce program is	1</div><div class="line">a mapreduce program is composed	1</div><div class="line">...</div><div class="line">and reduce	3</div><div class="line">and reduce capabilities	1</div><div class="line">and reduce functions	2</div><div class="line">...</div><div class="line">map and	3</div><div class="line">map and reduce	3</div><div class="line">map and reduce capabilities	1</div><div class="line">map and reduce functions	2</div><div class="line">...</div></pre></td></tr></table></figure></p>
<p>æˆ‘è¿™é‡Œå°±æˆªå–ä¸€éƒ¨åˆ†ç»“æœï¼Œå®åœ¨å¤ªé•¿äº†â€¦â€¦</p>
<h3 id="æ„å»ºé¢„æµ‹æ¦‚ç‡çš„æ¨¡å‹"><a href="#æ„å»ºé¢„æµ‹æ¦‚ç‡çš„æ¨¡å‹" class="headerlink" title="æ„å»ºé¢„æµ‹æ¦‚ç‡çš„æ¨¡å‹"></a>æ„å»ºé¢„æµ‹æ¦‚ç‡çš„æ¨¡å‹</h3><p>æˆ‘ä»¬ç°åœ¨å·²ç»æœ‰äº†N-Gramåˆ‡å‰²åçš„ç»“æœäº†ï¼Œä¸‹ä¸€æ­¥å°±æ˜¯è¦åœ¨æ­¤åŸºç¡€ä¸Šåˆ†ææ¯ä¸€ä¸ªè¯æ±‡æˆ–è€…çŸ­è¯­åé¢å¯èƒ½å‡ºç°çš„å†…å®¹ï¼Œè¿™é‡Œå…¶å®å¯ä»¥ç†è§£æˆæ„å»ºä¸€ä¸ªæ¦‚ç‡æ¨¡å‹ï¼Œå¾ˆç®€å•ä¸€ä¸ªæ¦‚ç‡æ¨¡å‹ã€‚</p>
<p>ä¸¾ä¾‹è¯´æ˜ï¼Œæˆ‘ä»¬å…ˆæ¥çœ‹åˆšæ‰çš„ç»“æœç”Ÿæˆçš„ä¸€éƒ¨åˆ†
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">and data	1</div><div class="line">and development	1</div><div class="line">and fault	3</div><div class="line">and generating	1</div><div class="line">and less	1</div><div class="line">and providing	1</div><div class="line">and reduce	3</div><div class="line">and scatter	1</div><div class="line">and sorting	1</div></pre></td></tr></table></figure></p>
<p>å…ˆä»…ä»…åˆ†æandä¹‹åå¯èƒ½å‡ºç°çš„è¯æ±‡ï¼Œæ‰€æœ‰çš„æƒ…å†µéƒ½åœ¨è¿™é‡Œæ‘†ç€äº†ã€‚é‚£è¿™æ—¶å€™autocompleteä¼šå¦‚ä½•ç»™å‡ºæ¨èå‘¢ï¼Ÿå¾ˆæ˜¾ç„¶çš„ï¼Œfaultå’Œreduceä¼šæ”¾åˆ°å¤´ä¸¤ä¸ªæ¨èå¯¹å§ï¼Œä¸ºä»€ä¹ˆï¼Ÿè¿™å…¶å®å°±æ˜¯ä¸ªæ¦‚ç‡çš„é—®é¢˜ï¼šandåæ¥ä¸€ä¸ªè¯åœ¨æ–‡ä¸­å‡ºç°äº†<code>1+1+3+1+1+1+3+1+1=13</code>æ¬¡ï¼Œé‚£faultå’Œreduceæ¨èçš„æ¦‚ç‡å°±æ˜¯<code>3/13</code>ï¼Œå‰©ä¸‹çš„æ‰€æœ‰éƒ½æ˜¯<code>1/13</code>çš„æ¦‚ç‡ã€‚å¯¹äº<code>autocomplete</code>ç³»ç»Ÿæ¥è¯´ï¼Œè¿™æ„å‘³ç€å½“ç”¨æˆ·è¾“å…¥äº†andä¹‹åï¼Œå®ƒè®¤ä¸ºç”¨æˆ·æ›´æœ‰å¯èƒ½ç»§ç»­è¾“å…¥çš„æ˜¯faultå’Œreduceï¼Œå› ä¸ºä»å®ƒä»¥å¾€ç»éªŒï¼ˆç³»ç»Ÿæ‰€å¾—åˆ°çš„è¾“å…¥ï¼‰æ¥çœ‹ï¼Œfaultå’Œreduceå‡ºç°çš„é¢‘æ¬¡æ›´å¤šä¸€äº›ï¼Œç›¸æ¯”è¾ƒäºå…¶ä»–çš„ç»“æœã€‚å› æ­¤ï¼Œä¸‹ä¸€æ­¥å·¥ä½œï¼Œæˆ‘ä»¬éœ€è¦å¾—åˆ°ä¸€ä¸ªç±»ä¼¼äº<code>and&lt;\t&gt;data=1</code>è¿™æ ·çš„æ•°æ®è®°å½•æ ·å¼ï¼Œæ¥ç»Ÿè®¡æ‰€æœ‰çš„çŸ­è¯­ä¹‹åè·Ÿéšçš„è¯æ±‡ä»¥åŠå®ƒå‡ºç°çš„é¢‘æ¬¡ã€‚è¿™é‡Œæˆ‘ä»¬ä¹‹æ‰€ä»¥ä¸ç”¨æ¦‚ç‡æ¥è¿›è¡Œè®°å½•ï¼Œæ˜¯å› ä¸ºä»åˆšæ‰çš„è®¡ç®—è¿‡ç¨‹æ¥çœ‹ï¼Œè¯é¢‘å’Œæ¦‚ç‡æ˜¯æ­£ç›¸å…³çš„ï¼Œé‚£ä¹ˆå°±æ²¡å¿…è¦å¤šç®—ä¸€æ­¥è®°å½•æ¦‚ç‡äº†ã€‚</p>
<p><code>prob_mapper.py</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> sys</div><div class="line"><span class="keyword">import</span> string</div><div class="line">    </div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">(threshold)</span>:</span></div><div class="line">    <span class="keyword">for</span> line <span class="keyword">in</span> sys.stdin:</div><div class="line">        words_phrase, count = line.strip().split(<span class="string">"\t"</span>)</div><div class="line">        <span class="keyword">if</span> int(count) &lt; threshold:</div><div class="line">            <span class="keyword">continue</span></div><div class="line">            </div><div class="line">        words = words_phrase.strip().split(<span class="string">" "</span>)</div><div class="line">        <span class="keyword">if</span> len(words) &lt; <span class="number">2</span>:</div><div class="line">            <span class="keyword">continue</span></div><div class="line">            </div><div class="line">        print(<span class="string">"&#123;&#125;\t&#123;&#125;"</span>.format(<span class="string">' '</span>.join(words[:<span class="number">-1</span>]), words[<span class="number">-1</span>] + <span class="string">"="</span> + count))</div><div class="line">        </div><div class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</div><div class="line">    main(<span class="number">2</span>)</div></pre></td></tr></table></figure>
<p>mapperçš„å·¥ä½œå…¶å®å¾ˆç®€å•ï¼ŒåŸºæœ¬æ²¡æœ‰ä»€ä¹ˆéœ€è¦è¯´æ˜çš„ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™é‡Œæˆ‘åŠ å…¥äº†ä¸€ä¸ªthresholdå‚æ•°ï¼Œæ„ä¹‰æ˜¯ä¸ºäº†ç­›é€‰æ‰ä¸€éƒ¨åˆ†å‡ºç°é¢‘æ¬¡å¤ªä½çš„ç»“æœã€‚åˆšæ‰ä¸¾çš„ä¾‹å­é‡Œï¼Œæ¯ä¸ªç»“æœå‡ºç°çš„é¢‘æ¬¡å…¶å®éƒ½ä¸é«˜ï¼Œè¿™æ ·thresholdè‚¯å®šæ˜¯æ²¡ç”¨çš„ï¼Œä½†å®é™…ç”Ÿäº§ä¸­ï¼Œæ¯”å¦‚åƒGoogleå’Œç™¾åº¦è¿™æ ·çš„è¶…å¤§è§„æ¨¡çš„æœç´¢å¼•æ“ï¼Œæ¯å¤©å¯èƒ½æŠ“å–çš„æ•°æ®é‡ååˆ†åºå¤§ã€‚äº‹å®ä¸Šï¼Œæˆ‘ä»¬æ¯æ¬¡åœ¨æœç´¢æ¡†ä¸­è¾“å…¥å†…å®¹ï¼Œå¾—åˆ°çš„è”æƒ³å…¶å®éƒ½åœ¨äºŒåæ¡ä»¥å†…ï¼Œä¸€èˆ¬æ¥è¯´ä¸ä¼šç»™å¤ªå¤šçš„ï¼Œå¤ªå¤šçš„è¯ï¼Œç”¨æˆ·ç­›é€‰èµ·æ¥ä¹Ÿæ˜¯ä¸ªéº»çƒ¦ã€‚é‚£å¯¹äºé‚£äº›åŸºæœ¬å¾ˆå°‘å‡ºç°çš„è¯ç»„ç»„åˆï¼Œä¹Ÿå°±æ²¡å¿…è¦å­˜å‚¨ä¸‹æ¥ï¼Œè¢«æœç´¢åˆ°çš„æ¦‚ç‡å¤ªä½ï¼Œå¦‚æœå…¨éƒ¨éƒ½è®°å½•ä¸‹æ¥ï¼Œå¯¹æ•°æ®åº“çš„å­˜å‚¨å®¹é‡æ˜¯ä¸ªå¾ˆå¤§çš„è´Ÿæ‹…ã€‚</p>
<p><code>prob_reducer.py</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> sys</div><div class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> groupby</div><div class="line"><span class="keyword">from</span> operator <span class="keyword">import</span> itemgetter</div><div class="line">    </div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">parse_output</span><span class="params">(std_input)</span>:</span></div><div class="line">    <span class="keyword">for</span> line <span class="keyword">in</span> std_input:</div><div class="line">        <span class="keyword">yield</span> line.strip().split(<span class="string">"\t"</span>)</div><div class="line">        </div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">(n_gram)</span>:</span></div><div class="line">    data = parse_output(sys.stdin)</div><div class="line">    <span class="keyword">for</span> starting_phrase, group <span class="keyword">in</span> groupby(data, itemgetter(<span class="number">0</span>)):</div><div class="line">        result = &#123;&#125;</div><div class="line">        <span class="keyword">for</span> _, word_count <span class="keyword">in</span> group:</div><div class="line">            word, count = word_count.split(<span class="string">"="</span>)</div><div class="line">            count = int(count)</div><div class="line">            <span class="keyword">if</span> count <span class="keyword">not</span> <span class="keyword">in</span> result:</div><div class="line">                result[count] = []</div><div class="line">            result[count].append(word)</div><div class="line">            </div><div class="line">        i = <span class="number">0</span></div><div class="line">        <span class="keyword">for</span> key, value <span class="keyword">in</span> result.items():</div><div class="line">            <span class="keyword">if</span> i &lt; n_gram:</div><div class="line">                <span class="keyword">for</span> word <span class="keyword">in</span> value:</div><div class="line">                    print(<span class="string">"&#123;&#125;,&#123;&#125;,&#123;&#125;"</span>.format(starting_phrase, word, key))</div><div class="line">                    i += <span class="number">1</span></div><div class="line">                    </div><div class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</div><div class="line">    main(<span class="number">4</span>)</div></pre></td></tr></table></figure>
<p><code>starting_phrase</code>ä»£è¡¨çš„æ˜¯ç”¨æˆ·è¾“å…¥çš„éƒ¨åˆ†ï¼Œ<code>following_word</code>ä»£è¡¨çš„æ˜¯åé¢å¯èƒ½å‡ºç°çš„è¯æ±‡ï¼Œ<code>count</code>é¡¾åæ€ä¹‰å°±æ˜¯æŒ‡è¯é¢‘äº†ã€‚åœ¨reducerä¸­ï¼Œæˆ‘ä»¬å…ˆæŒ‰ç…§è¯é¢‘çš„ä¸åŒå°†å¯èƒ½å‡ºç°çš„è¯æ±‡åˆ†ç»„æ”¾ç½®ï¼Œç„¶åå†æ ¹æ®æˆ‘ä»¬éœ€è¦çš„N-Gramå¤§å°æ¥ä¾æ¬¡è¾“å‡ºã€‚è¿™é‡Œçš„å‚æ•°n_gramå’Œä¹‹å‰n_gram_mapperé‡Œçš„n_gramæ„æ€ä¸€æ ·ï¼Œä½†å–å€¼å¯ä»¥ä¸åŒã€‚</p>
<hr>
<h3 id="é¢„æµ‹æ¦‚ç‡çš„æµ‹è¯•ç»“æœ"><a href="#é¢„æµ‹æ¦‚ç‡çš„æµ‹è¯•ç»“æœ" class="headerlink" title="é¢„æµ‹æ¦‚ç‡çš„æµ‹è¯•ç»“æœ"></a>é¢„æµ‹æ¦‚ç‡çš„æµ‹è¯•ç»“æœ</h3><p>ä¸‹é¢æˆ‘ä»¬æ¥çœ‹çœ‹æœ¬åœ°æµ‹è¯•ç»“æœå§ï¼Œå°±ç”¨ä¸Šä¸€æ­¥n_gram_reducerå¾—å‡ºçš„ç»“æœç»§ç»­æ“ä½œã€‚</p>
<figure class="highlight console"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line">root@hadoop:~/src/p2py# cat result.txt | ./prob_mapper.py | ./prob_reducer.py </div><div class="line">and,fault,3</div><div class="line">and fault,tolerance,3</div><div class="line">and,reduce,3</div><div class="line">and reduce,functions,2</div><div class="line">big,data,2</div><div class="line">communication,cost,2</div><div class="line">fault,tolerance,3</div><div class="line">is,a,2</div><div class="line">map,and,3</div><div class="line">map and,reduce,3</div><div class="line">map and reduce,functions,2</div><div class="line">mapreduce,framework,3</div><div class="line">method,that,2</div><div class="line">method that,performs,2</div><div class="line">model,and,2</div><div class="line">model,is,2</div><div class="line">not,the,2</div><div class="line">of,the,4</div><div class="line">of the,mapreduce,2</div><div class="line">of the mapreduce,framework,2</div><div class="line">optimizing,the,2</div><div class="line">reduce,functions,2</div><div class="line">such,as,2</div><div class="line">that,performs,2</div><div class="line">the,mapreduce,4</div><div class="line">the mapreduce,framework,3</div><div class="line">the,various,2</div></pre></td></tr></table></figure>
<p>å› ä¸ºä¹‹å‰åœ¨mapperé‡Œæˆ‘ä»¬å°†thresholdè®¾ç½®ä¸º2ï¼Œè¿™é‡Œæˆ‘ä»¬å°±å¯ä»¥çœ‹åˆ°ç»“æœä¸­åªæœ‰è¯é¢‘ä¸å°äº2æ¬¡çš„ã€‚</p>
<h3 id="è¿è¡Œåœ¨Hadoopä¸Š"><a href="#è¿è¡Œåœ¨Hadoopä¸Š" class="headerlink" title="è¿è¡Œåœ¨Hadoopä¸Š"></a>è¿è¡Œåœ¨Hadoopä¸Š</h3><p>åˆšæ‰åœ¨æœ¬åœ°è·‘è¿‡äº†ä¹‹åï¼Œä¸‹é¢æ¥è¿›è¡ŒHadoopä¸Šçš„æµ‹è¯•ã€‚ä¸ºäº†æ–¹ä¾¿å¿«æ·ï¼Œæˆ‘ç¼–å†™äº†ä¸€ä¸ªscriptæ¥è¿è¡Œä¸¤å¯¹mapperå’Œreducerï¼Œæœ€åæŠŠå¾—åˆ°çš„æ•°æ®ä»HDFSé‡Œå¯¼å‡ºåˆ°æœ¬åœ°ã€‚
<figure class="highlight console"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line">root@hadoop:~/src/p2py# ./run_script.sh </div><div class="line">    </div><div class="line">Cleaning old results in /output...</div><div class="line">17/10/10 01:30:20 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.</div><div class="line">Deleted /output</div><div class="line">    </div><div class="line">Running python in Hadoop by hadoop streaming...</div><div class="line">    </div><div class="line">packageJobJar: [/tmp/hadoop-unjar5398292596529368576/] [] /tmp/streamjob5913697815224381390.jar tmpDir=null</div><div class="line">17/10/10 01:30:22 INFO client.RMProxy: Connecting to ResourceManager at hadoop-master/172.18.0.2:8032</div><div class="line">17/10/10 01:30:22 INFO client.RMProxy: Connecting to ResourceManager at hadoop-master/172.18.0.2:8032</div><div class="line">17/10/10 01:30:23 INFO mapred.FileInputFormat: Total input paths to process : 1</div><div class="line">...</div><div class="line">17/10/10 01:30:49 INFO streaming.StreamJob: Output directory: /output/first</div><div class="line">    </div><div class="line">Running 2nd mapper and reducer...</div><div class="line">    </div><div class="line">packageJobJar: [/tmp/hadoop-unjar6814698868258273333/] [] /tmp/streamjob6470458846508985375.jar tmpDir=null</div><div class="line">17/10/10 01:30:51 INFO client.RMProxy: Connecting to ResourceManager at hadoop-master/172.18.0.2:8032</div><div class="line">17/10/10 01:30:51 INFO client.RMProxy: Connecting to ResourceManager at hadoop-master/172.18.0.2:8032</div><div class="line">17/10/10 01:30:52 INFO mapred.FileInputFormat: Total input paths to process : 1</div><div class="line">...</div><div class="line">17/10/10 01:31:13 INFO streaming.StreamJob: Output directory: /output/second</div><div class="line">    </div><div class="line">Moving outputs from HDFS to local...</div><div class="line">    </div><div class="line">Got the output!</div></pre></td></tr></table></figure></p>
<p>ä¸€åˆ‡é¡ºåˆ©è¿è¡Œï¼æœ€ç»ˆç»“æœä¹Ÿè¢«æˆåŠŸå¯¼å‡ºåˆ°æœ¬åœ°ã€‚</p>
<hr>
<h2 id="å¯¼å…¥æ•°æ®åº“"><a href="#å¯¼å…¥æ•°æ®åº“" class="headerlink" title="å¯¼å…¥æ•°æ®åº“"></a>å¯¼å…¥æ•°æ®åº“</h2><p>å…¶å®åˆ°ä¸Šä¸€å°èŠ‚ï¼ŒMapReduceçš„å·¥ä½œå°±éƒ½åšå®Œäº†ï¼Œä½†ä¸ºäº†è®©<code>autocomplete</code>å¯ä»¥å±•ç°å‡ºåº”æœ‰çš„æ•ˆæœï¼Œè¿™é‡Œè¿˜éœ€è¦å°†åˆšæ‰ç”Ÿæˆçš„æ•°æ®å¯¼å‡ºåˆ°æ•°æ®åº“ä¸­ï¼Œä»¥ä¾¿ä¹‹åå’ŒWebç»“åˆæ¥ä½“ç°åŠŸèƒ½ã€‚</p>
<p>æ•°æ®åº“æˆ‘ç”¨çš„æ˜¯MySQLï¼Œå¤§å®¶å¯ä»¥ä»»æ„é€‰æ‹©ã€‚ä¸‹é¢æ˜¯æˆ‘çš„æ•°æ®åº“æ“ä½œä»£ç ï¼š
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> sys</div><div class="line"><span class="keyword">import</span> MySQLdb <span class="keyword">as</span> mdb</div><div class="line">    </div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">read_data</span><span class="params">(file)</span>:</span></div><div class="line">    <span class="keyword">for</span> line <span class="keyword">in</span> file.readlines():</div><div class="line">        <span class="keyword">yield</span> line.strip().split(<span class="string">","</span>)</div><div class="line">        </div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">(input_data)</span>:</span></div><div class="line">    <span class="keyword">with</span> mdb.connect(<span class="string">'localhost'</span>, <span class="string">'username'</span>, <span class="string">'password'</span>, <span class="string">'dbname'</span>) <span class="keyword">as</span> cur:</div><div class="line">        cur.execute(<span class="string">"DROP TABLE IF EXISTS output"</span>)</div><div class="line">        cur.execute(</div><div class="line">            <span class="string">"CREATE TABLE output(starting_phrase VARCHAR(250), following_word VARCHAR(250), count INT)"</span>)</div><div class="line">        <span class="keyword">with</span> open(input_data, <span class="string">'r'</span>) <span class="keyword">as</span> file:</div><div class="line">            <span class="keyword">for</span> starting_phrase, following_word, count <span class="keyword">in</span> read_data(file):</div><div class="line">                cur.execute(</div><div class="line">                    <span class="string">"INSERT INTO output(starting_phrase, following_word, count) \</span></div><div class="line"><span class="string">                     VALUES('&#123;&#125;', '&#123;&#125;', &#123;&#125;)"</span>.format(starting_phrase, following_word, count))</div><div class="line">                     </div><div class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</div><div class="line">    main(<span class="string">"output"</span>)</div></pre></td></tr></table></figure></p>
<p>æ•°æ®åº“ä¸­æ˜¾ç¤ºçš„ç»“æœï¼š
<img src="/images/autocomplete/database.png" alt="database"></p>
<hr>
<h2 id="å±•ç¤ºç»“æœ"><a href="#å±•ç¤ºç»“æœ" class="headerlink" title="å±•ç¤ºç»“æœ"></a>å±•ç¤ºç»“æœ</h2><p>æˆ‘ç®€å•åšäº†ä¸€ä¸ªWebå±•ç¤ºçš„é¡µé¢ï¼ŒåŸºäºAjaxå’ŒPHPï¼Œè¿æ¥æ•°æ®åº“åï¼Œæµ‹è¯•ç»“æœå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š
<img src="/images/autocomplete/ggif.gif" alt="test"></p>
<hr>
<h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>æœ¬æ–‡ä»é›¶å¼€å§‹ï¼Œä¸å¤ªè¯¦ç»†çš„ä»‹ç»äº†<code>autocomplete</code>çš„å·¥ä½œåŸç†ï¼Œä»¥åŠå¦‚ä½•åˆ©ç”¨Pythonå’ŒMapReduceæ¥å¤„ç†æ•°æ®ã€‚ç›¸æ¯”è¾ƒJavaå®ç°è¿™äº›å†…å®¹è€Œè¨€ï¼ŒPythonç¡®å®éœ€è¦æ³¨æ„æ›´å¤šçš„ç»†èŠ‚ï¼Œæ¯•ç«ŸJavaæ˜¯HadoopåŸç”Ÿç¯å¢ƒï¼Œconfigurationçš„é…ç½®çœŸçš„æ˜¯æ–¹ä¾¿ã€‚ä¹‹å‰åšwordcountæ—¶æ²¡æœ‰è§‰å¾—Python+Hadoop Streamingçš„æ–¹å¼æœ‰ä»€ä¹ˆé—®é¢˜ï¼Œå› ä¸ºPythonå¤©ç”Ÿçš„ç®€æ´ç‰¹è´¨ï¼Œæ„Ÿè§‰æ¯”Javaå•°é‡Œå•°å—¦çš„èˆ’æœå¤šäº†ã€‚ä½†è¿™æ¬¡çš„ä»£ç å®ç°ä¸Šå°±çœ‹å‡ºç«¯å€ªäº†ï¼ŒPythonä¸‹æ›´å¤šçš„ç»†èŠ‚éƒ¨åˆ†éœ€è¦å¼€å‘è€…è‡ªå·±å†™ä»£ç å»ç»´æŠ¤ï¼Œå°±åƒä¸åŒçš„mapperï¼Œreducerä¹‹é—´çš„æ•°æ®ä¼ è¾“ï¼Œè¿˜æœ‰è¾“å‡ºåˆ°æ•°æ®åº“ä¿å­˜ã€‚</p>
<p>ä¸€è·¯ä»å¤´çœ‹åˆ°è¿™é‡Œçš„æœ‹å‹ï¼Œæ„Ÿè°¢ä½ çš„é˜…è¯»ï¼Œå¦‚æœæœ‰ç–‘æƒ‘ï¼Œæ¬¢è¿ğŸ‘‡ä¸‹é¢ç•™è¨€ï¼Œå¦‚æœæ–‡ç« ä¸­æœ‰ä»€ä¹ˆä¸å¯¹çš„åœ°æ–¹ï¼Œä¹Ÿæ¬¢è¿æ‰¹è¯„å’ŒæŒ‡æ­£ã€‚</p>
<hr>
<h1 id="Related-Links"><a href="#Related-Links" class="headerlink" title="Related Links"></a>Related Links</h1><ol>
<li><a href="http://blog.sciencenet.cn/blog-713101-797384.html" target="_blank" rel="external">N-gramçš„åŸç†ã€ç”¨é€”å’Œç ”ç©¶</a></li>
</ol>
]]></content>
      
        <categories>
            
            <category> Big Data </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Python </tag>
            
            <tag> Hadoop </tag>
            
            <tag> MapReduce </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Data analysis in Python by Pandas]]></title>
      <url>/2017/10/02/Data-analysis-in-Python-by-Pandas/</url>
      <content type="html"><![CDATA[<p>Pythonåœ¨æ•°æ®ç§‘å­¦é¢†åŸŸçš„åº”ç”¨çœŸçš„æ˜¯è¶Šæ¥è¶Šæ™®åŠï¼Œå¾—ç›ŠäºPythonç›¸å¯¹æ¥è®²é€šä¿—æ˜“æ‡‚çš„è¯­è¨€é£æ ¼ï¼Œè¯­æ³•ç®€å•ä¸”å®¹æ˜“å…¥é—¨çš„ç‰¹æ€§ï¼Œç»™å¾ˆå¤šæ•°æ®ç§‘å­¦é¢†åŸŸçš„æœ‹å‹ï¼Œå‡è½»äº†ä¸€éƒ¨åˆ†å­¦ä¹ ç¼–ç¨‹è¯­è¨€çš„ç¹é‡ã€‚<code>Pandas</code> + <code>NumPy</code> + <code>Matplotlib</code>ï¼Œè¿™ä¸‰è€…çš„ç»“åˆåŸºæœ¬å¯ä»¥èƒœä»»ä»»æ„ç®€å•çš„æ•°æ®åˆ†æå’Œå¯è§†åŒ–çš„ä»»åŠ¡ã€‚å¤æ‚ä¸€ç‚¹çš„å¯èƒ½è¿˜ä¼šéœ€è¦<code>SciPy</code>çš„å¸®åŠ©ã€‚</p>
<h1 id="æœ¬æ–‡ç›®çš„"><a href="#æœ¬æ–‡ç›®çš„" class="headerlink" title="æœ¬æ–‡ç›®çš„"></a>æœ¬æ–‡ç›®çš„</h1><p>è¿™æ¬¡ï¼Œæˆ‘æ‰“ç®—ç”¨ä¸€ç¯‡é•¿æ–‡æ¥è®°å½•ä¸€ä¸‹è‡ªå·±æ˜¯å¦‚ä½•åˆ©ç”¨Pandasè¿›è¡Œæ•°æ®åˆ†æçš„ã€‚ç½‘ä¸Šæœ‰å¾ˆå¤šçš„<code>Pandas</code>å…¥é—¨æ•™ç¨‹ï¼Œå› æ­¤æˆ‘è¿™é‡Œå¹¶ä¸æ‰“ç®—é’ˆå¯¹æ‰€æœ‰Pandasçš„åŸºç¡€æ“ä½œæè¿°çš„é‚£ä¹ˆæ¸…æ¥šï¼Œè¿˜æ˜¯å¸Œæœ›æ›´å¤šçš„è¡¨è¾¾ä¸€äº›å¯¹äºæ•°æ®åˆ†æçš„æƒ³æ³•å’Œå®ç°ã€‚</p>
<p>å¹¿ä¹‰ä¸Šï¼Œæ•°æ®åˆ†æå…¶å®åŒ…å«äº†ä»å¯¼å…¥æ•°æ®-&gt;æ¸…æ´—æ•°æ®-&gt;<strong>åˆ†ææ•°æ®</strong>-&gt;å±•ç¤ºæ•°æ®ï¼Œè¿™ä¸€ä»å¤´åˆ°å°¾çš„æµç¨‹ã€‚ç‹­ä¹‰ä¸Šï¼Œæ•°æ®åˆ†ææŒ‡çš„å°±æ˜¯ä¸­é—´åˆ†ææ•°æ®è¿™ä¸€å—å†…å®¹ã€‚æœ¬æ–‡æŒ‰ç…§å¹¿ä¹‰ä¸Šçš„æ•°æ®åˆ†æçš„è¿‡ç¨‹æ¥ä¸€æ­¥æ­¥æ¢è®¨ã€‚</p>
<p>æ¥ä¸‹æ¥æˆ‘ä»¬å°±æ­£å¼å¼€å§‹æœ¬æ¬¡æ•°æ®åˆ†æä¹‹æ—…ã€‚</p>
<a id="more"></a>
<hr>
<h1 id="æ­£æ–‡"><a href="#æ­£æ–‡" class="headerlink" title="æ­£æ–‡"></a>æ­£æ–‡</h1><p>ä¸‹é¢çš„è¿™ä¸€æ®µä»£ç ä¸»è¦æ˜¯åŒ…çš„è°ƒç”¨å’Œä¸€äº›ç¯å¢ƒé…ç½®ï¼Œ<code>Seaborn</code>æ˜¯ä¹Ÿæ˜¯ä¸€ä¸ªplotåŒ…ï¼Œå¯ç”¨æ¥ç”»å‡ºæ¯”<code>Matplotlib</code>æ›´æ¼‚äº®çš„å›¾ï¼Œå®ƒæœ¬èº«æ˜¯åŸºäº<code>Matplotlib</code>è®¾è®¡çš„ï¼Œå¯¹<code>NumPy</code>å’Œ<code>Pandas</code>éƒ½æœ‰å¾ˆå¥½çš„æ”¯æŒã€‚è¿™é‡Œæˆ‘å°±ä¸åšè¿‡å¤šè§£é‡Šäº†ï¼Œå¯¹<code>Seaborn</code>æœ‰å…´è¶£çš„æœ‹å‹å¯ä»¥ç•™è¨€å’¨è¯¢æˆ–è€…è‡ªè¡Œæ¢ç´¢ã€‚
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</div><div class="line"><span class="keyword">from</span> matplotlib <span class="keyword">import</span> pyplot <span class="keyword">as</span> plt</div><div class="line"><span class="keyword">import</span> seaborn <span class="keyword">as</span> sns</div><div class="line">    </div><div class="line">%matplotlib inline</div><div class="line">    </div><div class="line">sns.set(rc=&#123;<span class="string">"figure.figsize"</span>: (<span class="number">10</span>, <span class="number">6.25</span>)&#125;)</div><div class="line">sns.set_style(<span class="string">"darkgrid"</span>)</div><div class="line">colors = [<span class="string">"windows blue"</span>, <span class="string">"amber"</span>, <span class="string">"faded green"</span>, <span class="string">"greyish"</span>, <span class="string">"dusty purple"</span>, <span class="string">"red violet"</span>, <span class="string">"marine"</span>, <span class="string">"jungle green"</span>, <span class="string">"chocolate brown"</span>, <span class="string">"dull pink"</span>, <span class="string">"reddish orange"</span>]</div><div class="line">sns.set_palette(sns.xkcd_palette(colors))</div></pre></td></tr></table></figure></p>
<hr>
<h2 id="å¯¼å…¥æ•°æ®"><a href="#å¯¼å…¥æ•°æ®" class="headerlink" title="å¯¼å…¥æ•°æ®"></a>å¯¼å…¥æ•°æ®</h2><p>æˆ‘è¿™æ¬¡ç”¨çš„æ•°æ®æ˜¯IGNä¸Šè¿‘20å¹´æ¥çš„å„ç§å¹³å°çš„æ¸¸æˆï¼Œæ¥æºäº<a href="https://www.kaggle.com/egrinstein/20-years-of-games" target="_blank" rel="external">è¿™é‡Œ</a>ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">reviews = pd.read_csv(<span class="string">"ign.csv"</span>)</div></pre></td></tr></table></figure>
<p>æ•°æ®è¯»å…¥ä¹‹åï¼Œæˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹è¿™é‡Œéƒ½æœ‰äº›ä»€ä¹ˆå†…å®¹ã€‚
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">reviews.head()</div></pre></td></tr></table></figure></p>
<div>
<table class="blueTable">
  <thead>
    <tr style="text-align: center;">
      <th></th>
      <th>Unnamed: 0</th>
      <th>score_phrase</th>
      <th>title</th>
      <th>url</th>
      <th>platform</th>
      <th>score</th>
      <th>genre</th>
      <th>editors_choice</th>
      <th>release_year</th>
      <th>release_month</th>
      <th>release_day</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>Amazing</td>
      <td>LittleBigPlanet PS Vita</td>
      <td>/games/littlebigplanet-vita/vita-98907</td>
      <td>PlayStation Vita</td>
      <td>9.0</td>
      <td>Platformer</td>
      <td>Y</td>
      <td>2012</td>
      <td>9</td>
      <td>12</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>Amazing</td>
      <td>LittleBigPlanet PS Vita â€“ Marvel Super Hero Eâ€¦</td>
      <td>/games/littlebigplanet-ps-vita-marvel-super-heâ€¦</td>
      <td>PlayStation Vita</td>
      <td>9.0</td>
      <td>Platformer</td>
      <td>Y</td>
      <td>2012</td>
      <td>9</td>
      <td>12</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>Great</td>
      <td>Splice: Tree of Life</td>
      <td>/games/splice/ipad-141070</td>
      <td>iPad</td>
      <td>8.5</td>
      <td>Puzzle</td>
      <td>N</td>
      <td>2012</td>
      <td>9</td>
      <td>12</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>Great</td>
      <td>NHL 13</td>
      <td>/games/nhl-13/xbox-360-128182</td>
      <td>Xbox 360</td>
      <td>8.5</td>
      <td>Sports</td>
      <td>N</td>
      <td>2012</td>
      <td>9</td>
      <td>11</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>Great</td>
      <td>NHL 13</td>
      <td>/games/nhl-13/ps3-128181</td>
      <td>PlayStation 3</td>
      <td>8.5</td>
      <td>Sports</td>
      <td>N</td>
      <td>2012</td>
      <td>9</td>
      <td>11</td>
    </tr>
  </tbody>
</table>
</div>

<p>è¿™é‡Œå…ˆç®€å•ä»‹ç»ä¸€ä¸‹æ¯ä¸€åˆ—éƒ½ä»£è¡¨ä»€ä¹ˆå§ï¼š</p>
<ul>
<li>score_phrase â€“ IGNç”¨ä¸€ä¸ªè¯æ¥è¯„ä»·å½“å‰æ¸¸æˆï¼Œä¸å¾—åˆ†ç›´æ¥ç›¸å…³ï¼›</li>
<li>title â€“ æ¸¸æˆåç§°ï¼›</li>
<li>url â€“ å®Œæ•´è¯„è®ºçš„åœ°å€ï¼›</li>
<li>platform â€“ æ¸¸æˆå¹³å°ï¼ˆPS4, PC, Xbox, etc.ï¼‰ï¼›</li>
<li>score â€“ æ¸¸æˆçš„å…·ä½“è¯„åˆ†ï¼Œä»1.0åˆ°10.0ï¼›</li>
<li>genre â€“ æ¸¸æˆåˆ†ç±»ï¼›</li>
<li>editors_choice â€“ æ˜¯å¦ä¸ºIGNç¼–è¾‘æ¨èçš„æ¸¸æˆï¼Œä¸è¯„åˆ†æœ‰å…³ç³»ã€‚</li>
<li>release_year â€“ æ¸¸æˆå‘å¸ƒå¹´ä»½ï¼›</li>
<li>release_month â€“ å‘å¸ƒæœˆä»½ï¼›</li>
<li>release_day â€“ å‘å¸ƒæ—¥æœŸã€‚</li>
</ul>
<p>æˆ‘ä»¬æ¥çœ‹ä¸‹æ€»å…±å¤šå°‘ä¸ªæ•°æ®ã€‚
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">reviews.shape</div></pre></td></tr></table></figure></p>
<pre><code>(18625, 11)
</code></pre><p>çœ‹æ¥æˆ‘ä»¬è¿™æ¬¡çš„æ•°æ®é‡Œä¸€å…±<code>18625</code>æ¡æ•°æ®ï¼Œä¸€å…±<code>11</code>åˆ—å±æ€§ã€‚</p>
<hr>
<h2 id="æ¸…æ´—æ•°æ®"><a href="#æ¸…æ´—æ•°æ®" class="headerlink" title="æ¸…æ´—æ•°æ®"></a>æ¸…æ´—æ•°æ®</h2><p>æºæ•°æ®å¯¼å…¥åä¸€èˆ¬æ¥è¯´æ˜¯ä¸èƒ½ç›´æ¥ä½¿ç”¨çš„ï¼Œéœ€è¦è¿›è¡Œä¸€å®šèŒƒå›´çš„æ•°æ®æ¸…æ´—ï¼Œä¸è¿‡æœ¬æ¬¡çš„æ•°æ®åŸºæœ¬ä¸éœ€è¦æ¸…æ´—ï¼Œæ”¶é›†è¿™ä¸ªæ•°æ®çš„<em>Eric Grinstein</em>å·²ç»å¯¹æ•°æ®è¿›è¡Œäº†æ¸…æ´—å·¥ä½œã€‚ä¸è¿‡è¿™é‡Œæˆ‘ä»¬ä»éœ€è¦åšä¸€ç‚¹ç®€å•çš„æ¸…æ´—å·¥ä½œï¼Œå»é™¤ä¸€äº›æˆ‘ä»¬ä¸éœ€è¦çš„å†…å®¹ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">reviews = reviews.iloc[:, <span class="number">1</span>:]</div><div class="line">reviews.head()</div></pre></td></tr></table></figure>
<div>
<style>
    .dataframe {
      display: block;
      overflow-x: auto;
      white-space: nowrap;
    }

    .dataframe thead tr:only-child th {
        text-align: center;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table class="blueTable">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>score_phrase</th>
      <th>title</th>
      <th>url</th>
      <th>platform</th>
      <th>score</th>
      <th>genre</th>
      <th>editors_choice</th>
      <th>release_year</th>
      <th>release_month</th>
      <th>release_day</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Amazing</td>
      <td>LittleBigPlanet PS Vita</td>
      <td>/games/littlebigplanet-vita/vita-98907</td>
      <td>PlayStation Vita</td>
      <td>9.0</td>
      <td>Platformer</td>
      <td>Y</td>
      <td>2012</td>
      <td>9</td>
      <td>12</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Amazing</td>
      <td>LittleBigPlanet PS Vita â€“ Marvel Super Hero Eâ€¦</td>
      <td>/games/littlebigplanet-ps-vita-marvel-super-heâ€¦</td>
      <td>PlayStation Vita</td>
      <td>9.0</td>
      <td>Platformer</td>
      <td>Y</td>
      <td>2012</td>
      <td>9</td>
      <td>12</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Great</td>
      <td>Splice: Tree of Life</td>
      <td>/games/splice/ipad-141070</td>
      <td>iPad</td>
      <td>8.5</td>
      <td>Puzzle</td>
      <td>N</td>
      <td>2012</td>
      <td>9</td>
      <td>12</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Great</td>
      <td>NHL 13</td>
      <td>/games/nhl-13/xbox-360-128182</td>
      <td>Xbox 360</td>
      <td>8.5</td>
      <td>Sports</td>
      <td>N</td>
      <td>2012</td>
      <td>9</td>
      <td>11</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Great</td>
      <td>NHL 13</td>
      <td>/games/nhl-13/ps3-128181</td>
      <td>PlayStation 3</td>
      <td>8.5</td>
      <td>Sports</td>
      <td>N</td>
      <td>2012</td>
      <td>9</td>
      <td>11</td>
    </tr>
  </tbody>
</table>
</div>

<hr>
<h2 id="åˆ†ææ•°æ®"><a href="#åˆ†ææ•°æ®" class="headerlink" title="åˆ†ææ•°æ®"></a>åˆ†ææ•°æ®</h2><p>æ•°æ®æ¸…æ´—ä¹‹åï¼Œå…¶å®å°±æ˜¯åˆ†æè¿‡ç¨‹çš„æ­£å¼å¼€å§‹ã€‚åœ¨å¼€å§‹åˆ†æè¿‡ç¨‹ä¹‹å‰ï¼Œå…ˆè¯´ç‚¹é¢˜å¤–è¯ã€‚æˆ‘æœ¬èº«å¯¹äºæ¸¸æˆæ˜¯å¾ˆçƒ­çˆ±çš„ï¼Œä»å°åˆ°å¤§ï¼Œæ¸¸æˆæœºï¼ŒæŒæœºï¼ŒPCï¼Œä¹Ÿæ‹¥æœ‰è¿‡ä¸å°‘çš„æ¸¸æˆå¹³å°ã€‚ä»å’Œçˆ¶æ¯æ–—æ™ºæ–—å‹‡ä¸­å„ç§äº‰å–æ—¶é—´ç©çš„çº¢ç™½æœºï¼Œå°éœ¸ç‹å­¦ä¹ æœºï¼Œåˆ°åæ¥å¯ä»¥èº²åœ¨è¢«å­é‡Œç©çš„GameBoyï¼Œä½†å¶å°”è¿˜å¾—æ¢å‡ºå¤´æ‹…å¿ƒçˆ¶æ¯è¿›å±‹é‡Œå‘ç°è‡ªå·±çš„å°ç§˜å¯†ï¼›å†å¾€åçš„ä¸–å˜‰ï¼Œæ‰€ä»¥åˆä¸å¾—ä¸å’Œçˆ¶æ¯è½¯ç£¨ç¡¬æ³¡æ³æ±‚æ¸¸æˆæ—¶é—´ã€‚ç›´è‡³å®¶é‡Œç¬¬ä¸€å°PCçš„å‡ºç°ï¼ŒåŸºæœ¬å…¶ä»–çš„æ¸¸æˆå¹³å°å°±å¾ˆå°‘ç¢°äº†ï¼Œé™¤äº†åæ¥çš„PSPï¼Œé‚£æ˜¯æˆ‘ä»GameBoyä¹‹åæ—¶éš”å¾ˆå¤šå¹´å†æ¬¡æ‹¿èµ·æŒæœºç©æ¸¸æˆã€‚è¦è¯´èµ·æ¸¸æˆï¼Œæ¸¸æˆå¹³å°ï¼Œæ¸¸æˆçš„å†å²ï¼ŒçœŸçš„è¯´ä¸Šä¸‰å¤©ä¸‰å¤œä¹Ÿè¯´ä¸å®Œï¼Œå…¶å®è¿™ä¹Ÿæ˜¯æˆ‘ä¸ºä»€ä¹ˆé€‰æ‹©è¿™ä¹ˆIGNçš„è¿™ä¸ªæ•°æ®ä½œä¸ºæ•°æ®åˆ†æçš„æ•°æ®æ¥æºã€‚æˆ‘ä¹Ÿå¾ˆæƒ³çœ‹çœ‹è¿™20å¹´æ¥ç”µå­æ¸¸æˆäº§ä¸šçš„å‘å±•å’Œè¶‹åŠ¿ã€‚</p>
<p>å¥½äº†ï¼Œå’±ä»¬è¨€å½’æ­£ä¼ ï¼Œå°±æˆ‘ä¸ªäººè€Œè¨€ï¼Œæ‹¿åˆ°è¿™ä¹ˆå¤šçš„æ•°æ®ä¹‹åï¼Œç¬¬ä¸€ååº”æ˜¯ï¼šè¿™ä¹ˆå¤šçš„æ¸¸æˆï¼Œç©¶ç«Ÿæ˜¯åˆ†å¸ƒåœ¨äº†å¤šå°‘å¹³å°ä¸Šå‘¢ï¼Ÿæˆ‘äº²èº«ä½“éªŒè¿‡çš„å¹³å°å…¶å®å¹¶ä¸å¤šï¼Œå¤§æ¦‚10ä¸ªå·¦å³å§ã€‚é‚£ä¹ˆè¿™ä¸ªæ•°æ®é›†é‡Œç©¶ç«ŸåŒ…å«äº†å¤šå°‘å¹³å°å‘¢ï¼Ÿ</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">all_platforms = reviews[<span class="string">"platform"</span>].unique()</div><div class="line">all_platforms</div></pre></td></tr></table></figure>
<pre><code>array([&apos;PlayStation Vita&apos;, &apos;iPad&apos;, &apos;Xbox 360&apos;, &apos;PlayStation 3&apos;,
       &apos;Macintosh&apos;, &apos;PC&apos;, &apos;iPhone&apos;, &apos;Nintendo DS&apos;, &apos;Nintendo 3DS&apos;,
       &apos;Android&apos;, &apos;Wii&apos;, &apos;PlayStation 4&apos;, &apos;Wii U&apos;, &apos;Linux&apos;,
       &apos;PlayStation Portable&apos;, &apos;PlayStation&apos;, &apos;Nintendo 64&apos;, &apos;Saturn&apos;,
       &apos;Lynx&apos;, &apos;Game Boy&apos;, &apos;Game Boy Color&apos;, &apos;NeoGeo Pocket Color&apos;,
       &apos;Game.Com&apos;, &apos;Dreamcast&apos;, &apos;Dreamcast VMU&apos;, &apos;WonderSwan&apos;, &apos;Arcade&apos;,
       &apos;Nintendo 64DD&apos;, &apos;PlayStation 2&apos;, &apos;WonderSwan Color&apos;,
       &apos;Game Boy Advance&apos;, &apos;Xbox&apos;, &apos;GameCube&apos;, &apos;DVD / HD Video Game&apos;,
       &apos;Wireless&apos;, &apos;Pocket PC&apos;, &apos;N-Gage&apos;, &apos;NES&apos;, &apos;iPod&apos;, &apos;Genesis&apos;,
       &apos;TurboGrafx-16&apos;, &apos;Super NES&apos;, &apos;NeoGeo&apos;, &apos;Master System&apos;,
       &apos;Atari 5200&apos;, &apos;TurboGrafx-CD&apos;, &apos;Atari 2600&apos;, &apos;Sega 32X&apos;, &apos;Vectrex&apos;,
       &apos;Commodore 64/128&apos;, &apos;Sega CD&apos;, &apos;Nintendo DSi&apos;, &apos;Windows Phone&apos;,
       &apos;Web Games&apos;, &apos;Xbox One&apos;, &apos;Windows Surface&apos;, &apos;Ouya&apos;,
       &apos;New Nintendo 3DS&apos;, &apos;SteamOS&apos;], dtype=object)
</code></pre><p>è¿™ä¹ˆå¤šçš„å¹³å°â€¦â€¦è¯´å®è¯ï¼Œè¿™é‡Œæœ‰å¾ˆå¤šæˆ‘å¬éƒ½æ²¡å¬è¿‡ï¼Œåƒ<code>Dreamcast</code>ï¼Œ<code>Atari 2600</code>ï¼Œ<code>Vectrex</code>ç­‰ç­‰ï¼Œçœ‹æ¥è¿™20å¹´ï¼Œæ¸¸æˆäº§ä¸šçš„å‘å±•è¿˜æ˜¯å¾ˆå¤šå…ƒåŒ–çš„ï¼Œè‡³å°‘ä»æ¸¸æˆå¹³å°ä¸Šå°±å¯ä»¥çœ‹å‡ºç«¯å€ªã€‚</p>
<p>æœ‰äº†æ¸¸æˆå¹³å°çš„ä¿¡æ¯ï¼Œè‡ªç„¶è€Œç„¶åœ°å°±ä¼šé—®ï¼Œæ¯ä¸ªå¹³å°å¤§æ¦‚éƒ½å‡ºè¿‡å¤šå°‘æ¸¸æˆå‘¢ï¼Ÿ
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">reviews[<span class="string">"platform"</span>].value_counts(dropna=<span class="keyword">False</span>)</div></pre></td></tr></table></figure></p>
<pre><code>PC                      3370
PlayStation 2           1686
Xbox 360                1631
Wii                     1366
PlayStation 3           1356
Nintendo DS             1045
PlayStation              952
Wireless                 910
iPhone                   842
Xbox                     821
PlayStation Portable     633
Game Boy Advance         623
GameCube                 509
Game Boy Color           356
Nintendo 64              302
Dreamcast                286
PlayStation 4            277
Nintendo DSi             254
Nintendo 3DS             225
Xbox One                 208
PlayStation Vita         155
Wii U                    114
iPad                      99
Lynx                      82
Macintosh                 81
Genesis                   58
NES                       49
TurboGrafx-16             40
Android                   39
Super NES                 33
NeoGeo Pocket Color       31
N-Gage                    30
Game Boy                  22
iPod                      17
Sega 32X                  16
Windows Phone             14
Master System             13
Arcade                    11
Linux                     10
NeoGeo                    10
Nintendo 64DD              7
Commodore 64/128           6
Saturn                     6
Atari 2600                 5
WonderSwan                 4
TurboGrafx-CD              3
Game.Com                   3
Atari 5200                 2
New Nintendo 3DS           2
Vectrex                    2
Pocket PC                  1
WonderSwan Color           1
Ouya                       1
Web Games                  1
SteamOS                    1
Dreamcast VMU              1
Windows Surface            1
DVD / HD Video Game        1
Sega CD                    1
Name: platform, dtype: int64
</code></pre><p>ä»ä¸Šé¢çš„ç»Ÿè®¡æ¥çœ‹ï¼ŒPCç«¯æ— ç–‘æ˜¯æœ€å¤§çš„è´¡çŒ®è€…ï¼Œè¿™ä¹Ÿå¯ä»¥ç†è§£ï¼Œæ¯•ç«Ÿä¸ªäººç”µè„‘ä»ä¸Šä¸ªä¸–çºªæœ«å¼€å§‹å‡ºç°äº•å–·ï¼Œåˆ°åæ¥è™½ç„¶å‡ºè´§é‡å¼€å§‹ä¸‹é™ï¼Œä½†ä¸€ç›´éƒ½æ˜¯äººä»¬å­¦ä¹ ç”Ÿæ´»å¨±ä¹ä¸­ä¸å¯æˆ–ç¼ºçš„ä¸€éƒ¨åˆ†ï¼Œå¹¶ä¸”æ—©æœŸçš„ä¸ªäººç”µè„‘ç»å¤§éƒ¨åˆ†éƒ½æ˜¯ä»¥Windowsä¸ºæ“ä½œç³»ç»Ÿã€‚ä¸è¿‡è®©æˆ‘æ²¡æƒ³åˆ°çš„æ˜¯<code>Dreamcast</code>ç«Ÿç„¶è¿˜æœ‰286æ¬¾æ¸¸æˆï¼Œçœ‹æ¥æ˜¯æˆ‘å­¤é™‹å¯¡é—»äº†â€¦â€¦</p>
<p>ä¸‹é¢æ¥çœ‹çœ‹æ’åå‰åçš„å¹³å°éƒ½æœ‰å“ªäº›ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">platforms = reviews[<span class="string">"platform"</span>].value_counts()[:<span class="number">10</span>].index.tolist()</div><div class="line">platforms</div></pre></td></tr></table></figure>
<pre><code>[&apos;PC&apos;,
&apos;PlayStation 2&apos;,
&apos;Xbox 360&apos;,
&apos;Wii&apos;,
&apos;PlayStation 3&apos;,
&apos;Nintendo DS&apos;,
&apos;PlayStation&apos;,
&apos;Wireless&apos;,
&apos;iPhone&apos;,
&apos;Xbox&apos;]
</code></pre><p>æ—¢ç„¶å‰åçš„å¹³å°æˆ‘å·²ç»çŸ¥é“äº†ï¼Œé‚£ä¹ˆä¸‹é¢æ¥çœ‹çœ‹æ¯ä¸ªå¹³å°çš„æ¸¸æˆè´¨é‡å¦‚ä½•ï¼Œè™½ç„¶PCç«¯çš„æ¸¸æˆæœ€å¤šï¼Œä½†ä¸ä¸€å®šå¥½æ¸¸æˆå æ¯”å°±æ˜¯æœ€å¤šçš„ï¼Œå¯¹å§ï¼Ÿ</p>
<p>æƒ³çŸ¥é“æ¯ä¸ªå¹³å°çš„æ¸¸æˆè´¨é‡å¦‚ä½•ï¼Œæˆ‘å¾—å…ˆä»æ‰€æœ‰çš„æ•°æ®ä¸­å°†åªå±äºå‰åçš„å¹³å°çš„æ¸¸æˆæå–å‡ºæ¥ã€‚è¿™é‡Œæˆ‘åˆ›å»ºä¸€ä¸ªfilterï¼Œç”¨æ¥ç­›é€‰æ¸¸æˆå¹³å°ã€‚
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">fil = reviews[<span class="string">"platform"</span>] == platforms[<span class="number">0</span>]   <span class="comment"># create a filter</span></div><div class="line">fil</div></pre></td></tr></table></figure></p>
<pre><code>0        False
1        False
2        False
3        False
4        False
5        False
6        False
7         True
8        False
9         True
          ...
18615    False
18616     True
18617    False
18618     True
18619     True
18620    False
18621    False
18622    False
18623    False
18624     True
Name: platform, Length: 18625, dtype: bool
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">for</span> platform <span class="keyword">in</span> platforms[<span class="number">1</span>:]:</div><div class="line">    fil |= reviews[<span class="string">"platform"</span>] == platform</div><div class="line">    </div><div class="line">filtered_reviews = reviews[fil]</div></pre></td></tr></table></figure>
<p>ä¸‹é¢æ˜¯æå–å‡ºæ¥çš„æ‰€æœ‰æ•°æ®ï¼š
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">filtered_reviews</div></pre></td></tr></table></figure></p>
<div>
<table class="blueTable">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>score_phrase</th>
      <th>title</th>
      <th>url</th>
      <th>platform</th>
      <th>score</th>
      <th>genre</th>
      <th>editors_choice</th>
      <th>release_year</th>
      <th>release_month</th>
      <th>release_day</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>3</th>
      <td>Great</td>
      <td>NHL 13</td>
      <td>/games/nhl-13/xbox-360-128182</td>
      <td>Xbox 360</td>
      <td>8.5</td>
      <td>Sports</td>
      <td>N</td>
      <td>2012</td>
      <td>9</td>
      <td>11</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Great</td>
      <td>NHL 13</td>
      <td>/games/nhl-13/ps3-128181</td>
      <td>PlayStation 3</td>
      <td>8.5</td>
      <td>Sports</td>
      <td>N</td>
      <td>2012</td>
      <td>9</td>
      <td>11</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Awful</td>
      <td>Double Dragon: Neon</td>
      <td>/games/double-dragon-neon/xbox-360-131320</td>
      <td>Xbox 360</td>
      <td>3.0</td>
      <td>Fighting</td>
      <td>N</td>
      <td>2012</td>
      <td>9</td>
      <td>11</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Amazing</td>
      <td>Guild Wars 2</td>
      <td>/games/guild-wars-2/pc-896298</td>
      <td>PC</td>
      <td>9.0</td>
      <td>RPG</td>
      <td>Y</td>
      <td>2012</td>
      <td>9</td>
      <td>11</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Awful</td>
      <td>Double Dragon: Neon</td>
      <td>/games/double-dragon-neon/ps3-131321</td>
      <td>PlayStation 3</td>
      <td>3.0</td>
      <td>Fighting</td>
      <td>N</td>
      <td>2012</td>
      <td>9</td>
      <td>11</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Good</td>
      <td>Total War Battles: Shogun</td>
      <td>/games/total-war-battles-shogun/pc-142564</td>
      <td>PC</td>
      <td>7.0</td>
      <td>Strategy</td>
      <td>N</td>
      <td>2012</td>
      <td>9</td>
      <td>11</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Good</td>
      <td>Tekken Tag Tournament 2</td>
      <td>/games/tekken-tag-tournament-2/ps3-124584</td>
      <td>PlayStation 3</td>
      <td>7.5</td>
      <td>Fighting</td>
      <td>N</td>
      <td>2012</td>
      <td>9</td>
      <td>11</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Good</td>
      <td>Tekken Tag Tournament 2</td>
      <td>/games/tekken-tag-tournament-2/xbox-360-124581</td>
      <td>Xbox 360</td>
      <td>7.5</td>
      <td>Fighting</td>
      <td>N</td>
      <td>2012</td>
      <td>9</td>
      <td>11</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Good</td>
      <td>Wild Blood</td>
      <td>/games/wild-blood/iphone-139363</td>
      <td>iPhone</td>
      <td>7.0</td>
      <td>NaN</td>
      <td>N</td>
      <td>2012</td>
      <td>9</td>
      <td>10</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Amazing</td>
      <td>Mark of the Ninja</td>
      <td>/games/mark-of-the-ninja-135615/xbox-360-129276</td>
      <td>Xbox 360</td>
      <td>9.0</td>
      <td>Action, Adventure</td>
      <td>Y</td>
      <td>2012</td>
      <td>9</td>
      <td>7</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Amazing</td>
      <td>Mark of the Ninja</td>
      <td>/games/mark-of-the-ninja-135615/pc-143761</td>
      <td>PC</td>
      <td>9.0</td>
      <td>Action, Adventure</td>
      <td>Y</td>
      <td>2012</td>
      <td>9</td>
      <td>7</td>
    </tr>
    <tr>
      <th>16</th>
      <td>Okay</td>
      <td>Home: A Unique Horror Adventure</td>
      <td>/games/home-a-unique-horror-adventure/pc-137135</td>
      <td>PC</td>
      <td>6.5</td>
      <td>Adventure</td>
      <td>N</td>
      <td>2012</td>
      <td>9</td>
      <td>6</td>
    </tr>
    <tr>
      <th>17</th>
      <td>Great</td>
      <td>Avengers Initiative</td>
      <td>/games/avengers-initiative/iphone-141579</td>
      <td>iPhone</td>
      <td>8.0</td>
      <td>Action</td>
      <td>N</td>
      <td>2012</td>
      <td>9</td>
      <td>5</td>
    </tr>
    <tr>
      <th>18</th>
      <td>Mediocre</td>
      <td>Way of the Samurai 4</td>
      <td>/games/way-of-the-samurai-4/ps3-23516</td>
      <td>PlayStation 3</td>
      <td>5.5</td>
      <td>Action, Adventure</td>
      <td>N</td>
      <td>2012</td>
      <td>9</td>
      <td>3</td>
    </tr>
    <tr>
      <th>19</th>
      <td>Good</td>
      <td>JoJoâ€™s Bizarre Adventure HD</td>
      <td>/games/jojos-bizarre-adventure/xbox-360-137717</td>
      <td>Xbox 360</td>
      <td>7.0</td>
      <td>Fighting</td>
      <td>N</td>
      <td>2012</td>
      <td>9</td>
      <td>3</td>
    </tr>
    <tr>
      <th>20</th>
      <td>Good</td>
      <td>JoJoâ€™s Bizarre Adventure HD</td>
      <td>/games/jojos-bizarre-adventure/ps3-137896</td>
      <td>PlayStation 3</td>
      <td>7.0</td>
      <td>Fighting</td>
      <td>N</td>
      <td>2012</td>
      <td>9</td>
      <td>3</td>
    </tr>
    <tr>
      <th>21</th>
      <td>Good</td>
      <td>Mass Effect 3: Leviathan</td>
      <td>/games/mass-effect-3-leviathan/xbox-360-138918</td>
      <td>Xbox 360</td>
      <td>7.5</td>
      <td>RPG</td>
      <td>N</td>
      <td>2012</td>
      <td>8</td>
      <td>31</td>
    </tr>
    <tr>
      <th>22</th>
      <td>Good</td>
      <td>Mass Effect 3: Leviathan</td>
      <td>/games/mass-effect-3-leviathan/ps3-138915</td>
      <td>PlayStation 3</td>
      <td>7.5</td>
      <td>RPG</td>
      <td>N</td>
      <td>2012</td>
      <td>8</td>
      <td>31</td>
    </tr>
    <tr>
      <th>23</th>
      <td>Good</td>
      <td>Mass Effect 3: Leviathan</td>
      <td>/games/mass-effect-3-leviathan/pc-138919</td>
      <td>PC</td>
      <td>7.5</td>
      <td>RPG</td>
      <td>N</td>
      <td>2012</td>
      <td>8</td>
      <td>31</td>
    </tr>
    <tr>
      <th>24</th>
      <td>Amazing</td>
      <td>Dark Souls (Prepare to Die Edition)</td>
      <td>/games/dark-souls-prepare-to-die-edition/pc-13â€¦</td>
      <td>PC</td>
      <td>9.0</td>
      <td>Action, RPG</td>
      <td>Y</td>
      <td>2012</td>
      <td>8</td>
      <td>31</td>
    </tr>
    <tr>
      <th>25</th>
      <td>Good</td>
      <td>Symphony</td>
      <td>/games/symphony/pc-136470</td>
      <td>PC</td>
      <td>7.0</td>
      <td>Shooter</td>
      <td>N</td>
      <td>2012</td>
      <td>8</td>
      <td>30</td>
    </tr>
    <tr>
      <th>27</th>
      <td>Good</td>
      <td>Tom Clancyâ€™s Ghost Recon Phantoms</td>
      <td>/games/tom-clancys-ghost-recon-online/pc-109114</td>
      <td>PC</td>
      <td>7.5</td>
      <td>Shooter</td>
      <td>N</td>
      <td>2012</td>
      <td>8</td>
      <td>29</td>
    </tr>
    <tr>
      <th>28</th>
      <td>Great</td>
      <td>Thirty Flights of Loving</td>
      <td>/games/thirty-flights-of-loving/pc-138374</td>
      <td>PC</td>
      <td>8.0</td>
      <td>Adventure</td>
      <td>N</td>
      <td>2012</td>
      <td>8</td>
      <td>29</td>
    </tr>
    <tr>
      <th>29</th>
      <td>Okay</td>
      <td>Legasista</td>
      <td>/games/legasista/ps3-127147</td>
      <td>PlayStation 3</td>
      <td>6.5</td>
      <td>Action, RPG</td>
      <td>N</td>
      <td>2012</td>
      <td>8</td>
      <td>28</td>
    </tr>
    <tr>
      <th>31</th>
      <td>Great</td>
      <td>World of Warcraft: Mists of Pandaria</td>
      <td>/games/world-of-warcraft-mists-of-pandaria/pc-â€¦</td>
      <td>PC</td>
      <td>8.7</td>
      <td>RPG</td>
      <td>Y</td>
      <td>2012</td>
      <td>10</td>
      <td>4</td>
    </tr>
    <tr>
      <th>32</th>
      <td>Bad</td>
      <td>Hell Yeah! Wrath of the Dead Rabbit</td>
      <td>/games/hell-yeah-wrath-of-the-dead-rabbit/ps3-â€¦</td>
      <td>PlayStation 3</td>
      <td>4.9</td>
      <td>Platformer</td>
      <td>N</td>
      <td>2012</td>
      <td>10</td>
      <td>4</td>
    </tr>
    <tr>
      <th>33</th>
      <td>Amazing</td>
      <td>Pokemon White Version 2</td>
      <td>/games/pokemon-white-version-2/nds-129228</td>
      <td>Nintendo DS</td>
      <td>9.6</td>
      <td>RPG</td>
      <td>Y</td>
      <td>2012</td>
      <td>10</td>
      <td>3</td>
    </tr>
    <tr>
      <th>34</th>
      <td>Good</td>
      <td>War of the Roses</td>
      <td>/games/war-of-the-roses-140577/pc-115849</td>
      <td>PC</td>
      <td>7.3</td>
      <td>Action</td>
      <td>N</td>
      <td>2012</td>
      <td>10</td>
      <td>3</td>
    </tr>
    <tr>
      <th>35</th>
      <td>Amazing</td>
      <td>Pokemon Black Version 2</td>
      <td>/games/pokemon-black-version-2/nds-129224</td>
      <td>Nintendo DS</td>
      <td>9.6</td>
      <td>RPG</td>
      <td>Y</td>
      <td>2012</td>
      <td>10</td>
      <td>3</td>
    </tr>
    <tr>
      <th>36</th>
      <td>Okay</td>
      <td>Drakerider</td>
      <td>/games/drakerider/iphone-135745</td>
      <td>iPhone</td>
      <td>6.5</td>
      <td>RPG</td>
      <td>N</td>
      <td>2012</td>
      <td>10</td>
      <td>3</td>
    </tr>
    <tr>
      <th>â€¦</th>
      <td>â€¦</td>
      <td>â€¦</td>
      <td>â€¦</td>
      <td>â€¦</td>
      <td>â€¦</td>
      <td>â€¦</td>
      <td>â€¦</td>
      <td>â€¦</td>
      <td>â€¦</td>
      <td>â€¦</td>
    </tr>
    <tr>
      <th>18546</th>
      <td>Great</td>
      <td>Devil Daggers</td>
      <td>/games/devil-daggers/pc-20049771</td>
      <td>PC</td>
      <td>8.5</td>
      <td>Shooter</td>
      <td>N</td>
      <td>2016</td>
      <td>2</td>
      <td>27</td>
    </tr>
    <tr>
      <th>18547</th>
      <td>Good</td>
      <td>Superhot</td>
      <td>/games/superhot/pc-20018899</td>
      <td>PC</td>
      <td>7.5</td>
      <td>Action</td>
      <td>N</td>
      <td>2016</td>
      <td>2</td>
      <td>25</td>
    </tr>
    <tr>
      <th>18549</th>
      <td>Good</td>
      <td>Battleborn</td>
      <td>/games/battleborn/pc-20021225</td>
      <td>PC</td>
      <td>7.1</td>
      <td>Shooter</td>
      <td>N</td>
      <td>2016</td>
      <td>5</td>
      <td>6</td>
    </tr>
    <tr>
      <th>18554</th>
      <td>Good</td>
      <td>The Park</td>
      <td>/games/the-park/pc-20042102</td>
      <td>PC</td>
      <td>7.0</td>
      <td>Adventure</td>
      <td>N</td>
      <td>2016</td>
      <td>5</td>
      <td>4</td>
    </tr>
    <tr>
      <th>18555</th>
      <td>Great</td>
      <td>Hitman: Episode 2</td>
      <td>/games/hitman-episode-2/pc-20051629</td>
      <td>PC</td>
      <td>8.5</td>
      <td>Shooter</td>
      <td>N</td>
      <td>2016</td>
      <td>4</td>
      <td>29</td>
    </tr>
    <tr>
      <th>18557</th>
      <td>Amazing</td>
      <td>Hearts of Iron IV</td>
      <td>/games/hearts-of-iron-iv/pc-20012080</td>
      <td>PC</td>
      <td>9.0</td>
      <td>Strategy</td>
      <td>Y</td>
      <td>2016</td>
      <td>6</td>
      <td>6</td>
    </tr>
    <tr>
      <th>18559</th>
      <td>Okay</td>
      <td>Dangerous Golf</td>
      <td>/games/dangerous-golf/pc-20048436</td>
      <td>PC</td>
      <td>6.0</td>
      <td>Sports, Action</td>
      <td>N</td>
      <td>2016</td>
      <td>6</td>
      <td>3</td>
    </tr>
    <tr>
      <th>18567</th>
      <td>Great</td>
      <td>Offworld Trading Company</td>
      <td>/games/offworld-trading-company/pc-20018639</td>
      <td>PC</td>
      <td>8.0</td>
      <td>Strategy</td>
      <td>N</td>
      <td>2016</td>
      <td>4</td>
      <td>28</td>
    </tr>
    <tr>
      <th>18568</th>
      <td>Okay</td>
      <td>The Walking Dead: Michonne â€“ Episode 3: What â€¦</td>
      <td>/games/the-walking-dead-michonne-episode-3/pc-â€¦</td>
      <td>PC</td>
      <td>6.3</td>
      <td>Adventure</td>
      <td>N</td>
      <td>2016</td>
      <td>4</td>
      <td>27</td>
    </tr>
    <tr>
      <th>18570</th>
      <td>Good</td>
      <td>Battlefleet Gothic: Armada</td>
      <td>/games/battlefleet-gothic-armada/pc-20030300</td>
      <td>PC</td>
      <td>7.1</td>
      <td>Strategy</td>
      <td>N</td>
      <td>2016</td>
      <td>4</td>
      <td>22</td>
    </tr>
    <tr>
      <th>18572</th>
      <td>Amazing</td>
      <td>Overwatch</td>
      <td>/games/overwatch/pc-20027413</td>
      <td>PC</td>
      <td>9.4</td>
      <td>Shooter</td>
      <td>Y</td>
      <td>2016</td>
      <td>5</td>
      <td>28</td>
    </tr>
    <tr>
      <th>18575</th>
      <td>Good</td>
      <td>Fallout 4: Nuka World</td>
      <td>/games/fallout-4-nuka-world/pc-20054761</td>
      <td>PC</td>
      <td>7.9</td>
      <td>RPG</td>
      <td>N</td>
      <td>2016</td>
      <td>8</td>
      <td>30</td>
    </tr>
    <tr>
      <th>18578</th>
      <td>Good</td>
      <td>Master of Orion</td>
      <td>/games/master-of-orion-wargaming/pc-20038452</td>
      <td>PC</td>
      <td>7.1</td>
      <td>Strategy</td>
      <td>N</td>
      <td>2016</td>
      <td>8</td>
      <td>26</td>
    </tr>
    <tr>
      <th>18580</th>
      <td>Great</td>
      <td>Quadrilateral Cowboy</td>
      <td>/games/quadrilateral-cowboy/pc-159788</td>
      <td>PC</td>
      <td>8.5</td>
      <td>Puzzle</td>
      <td>N</td>
      <td>2016</td>
      <td>7</td>
      <td>28</td>
    </tr>
    <tr>
      <th>18581</th>
      <td>Great</td>
      <td>Fallout 4: Vault-Tec Workshop</td>
      <td>/games/fallout-4-vault-tec-workshop/pc-20054769</td>
      <td>PC</td>
      <td>8.2</td>
      <td>RPG</td>
      <td>N</td>
      <td>2016</td>
      <td>7</td>
      <td>27</td>
    </tr>
    <tr>
      <th>18583</th>
      <td>Great</td>
      <td>Kentucky Route Zero: Act 4</td>
      <td>/games/kentucky-route-zero-act-4/pc-20046280</td>
      <td>PC</td>
      <td>8.5</td>
      <td>Adventure</td>
      <td>N</td>
      <td>2016</td>
      <td>7</td>
      <td>22</td>
    </tr>
    <tr>
      <th>18586</th>
      <td>Great</td>
      <td>F1 2016</td>
      <td>/games/f1-2016/pc-20054151</td>
      <td>PC</td>
      <td>8.8</td>
      <td>Racing</td>
      <td>N</td>
      <td>2016</td>
      <td>8</td>
      <td>24</td>
    </tr>
    <tr>
      <th>18589</th>
      <td>Amazing</td>
      <td>Deus Ex: Mankind Divided</td>
      <td>/games/deus-ex-mankind-divided/pc-20013794</td>
      <td>PC</td>
      <td>9.2</td>
      <td>Action, RPG</td>
      <td>Y</td>
      <td>2016</td>
      <td>8</td>
      <td>19</td>
    </tr>
    <tr>
      <th>18595</th>
      <td>Bad</td>
      <td>Ghostbusters</td>
      <td>/games/ghostbusters-the-movie/pc-20052317</td>
      <td>PC</td>
      <td>4.4</td>
      <td>Action</td>
      <td>N</td>
      <td>2016</td>
      <td>7</td>
      <td>16</td>
    </tr>
    <tr>
      <th>18596</th>
      <td>Okay</td>
      <td>Necropolis</td>
      <td>/games/necropolis/pc-20030346</td>
      <td>PC</td>
      <td>6.5</td>
      <td>Action, Adventure</td>
      <td>N</td>
      <td>2016</td>
      <td>7</td>
      <td>14</td>
    </tr>
    <tr>
      <th>18598</th>
      <td>Okay</td>
      <td>Furi</td>
      <td>/games/furi/pc-20044439</td>
      <td>PC</td>
      <td>6.8</td>
      <td>Action</td>
      <td>N</td>
      <td>2016</td>
      <td>7</td>
      <td>13</td>
    </tr>
    <tr>
      <th>18600</th>
      <td>Good</td>
      <td>Hitman: Episode 4</td>
      <td>/games/hitman-episode-4/pc-20051637</td>
      <td>PC</td>
      <td>7.4</td>
      <td>Shooter</td>
      <td>N</td>
      <td>2016</td>
      <td>8</td>
      <td>19</td>
    </tr>
    <tr>
      <th>18603</th>
      <td>Good</td>
      <td>Grow Up</td>
      <td>/games/grow-up/pc-20054824</td>
      <td>PC</td>
      <td>7.8</td>
      <td>Platformer</td>
      <td>N</td>
      <td>2016</td>
      <td>8</td>
      <td>18</td>
    </tr>
    <tr>
      <th>18606</th>
      <td>Okay</td>
      <td>Starcraft II: Nova Covert Ops â€“ Mission Pack 2</td>
      <td>/games/starcraft-ii-nova-covert-ops-mission-paâ€¦</td>
      <td>PC</td>
      <td>6.4</td>
      <td>Strategy</td>
      <td>N</td>
      <td>2016</td>
      <td>8</td>
      <td>4</td>
    </tr>
    <tr>
      <th>18607</th>
      <td>Good</td>
      <td>Pokemon Go</td>
      <td>/games/pokemon-go/iphone-20042699</td>
      <td>iPhone</td>
      <td>7.0</td>
      <td>Battle</td>
      <td>N</td>
      <td>2016</td>
      <td>7</td>
      <td>13</td>
    </tr>
    <tr>
      <th>18613</th>
      <td>Great</td>
      <td>XCOM 2: Shenâ€™s Last Gift</td>
      <td>/games/xcom-2-shens-last-gift/pc-20055520</td>
      <td>PC</td>
      <td>8.0</td>
      <td>Strategy</td>
      <td>N</td>
      <td>2016</td>
      <td>7</td>
      <td>1</td>
    </tr>
    <tr>
      <th>18616</th>
      <td>Good</td>
      <td>Batman: The Telltale Series â€“ Episode 1: Realâ€¦</td>
      <td>/games/batman-the-telltale-series-episode-1-reâ€¦</td>
      <td>PC</td>
      <td>7.5</td>
      <td>Adventure</td>
      <td>N</td>
      <td>2016</td>
      <td>8</td>
      <td>2</td>
    </tr>
    <tr>
      <th>18618</th>
      <td>Amazing</td>
      <td>Starbound</td>
      <td>/games/starbound-2016/pc-128879</td>
      <td>PC</td>
      <td>9.1</td>
      <td>Action</td>
      <td>Y</td>
      <td>2016</td>
      <td>7</td>
      <td>28</td>
    </tr>
    <tr>
      <th>18619</th>
      <td>Good</td>
      <td>Human Fall Flat</td>
      <td>/games/human-fall-flat/pc-20051928</td>
      <td>PC</td>
      <td>7.9</td>
      <td>Puzzle, Action</td>
      <td>N</td>
      <td>2016</td>
      <td>7</td>
      <td>28</td>
    </tr>
    <tr>
      <th>18624</th>
      <td>Masterpiece</td>
      <td>Inside</td>
      <td>/games/inside-playdead/pc-20055740</td>
      <td>PC</td>
      <td>10.0</td>
      <td>Adventure</td>
      <td>Y</td>
      <td>2016</td>
      <td>6</td>
      <td>28</td>
    </tr>
  </tbody>
</table>
<p>13979 rows Ã— 10 columns</p>
</div>

<hr>
<h2 id="å±•ç¤ºæ•°æ®"><a href="#å±•ç¤ºæ•°æ®" class="headerlink" title="å±•ç¤ºæ•°æ®"></a>å±•ç¤ºæ•°æ®</h2><p>ç°åœ¨å·²ç»æœ‰äº†å‰åå¹³å°çš„æ•°æ®ï¼Œéœ€è¦æ€è€ƒçš„å°±æ˜¯å¦‚ä½•æ¥å‘ˆç°æ¯ä¸ªå¹³å°çš„æ¸¸æˆè´¨é‡å‘¢ï¼Ÿå½“ç„¶å¯ä»¥ç”¨æ¯ä¸ªå¹³å°çš„<code>score</code>çš„å¹³å‡å€¼æ¥å¯¹æ¯”ï¼Œä½†æœªå…æœ‰ç‚¹å•è–„äº†ã€‚æ•°æ®å±æ€§ä¸­æœ‰ä¸€åˆ—æ˜¯<code>score_phrase</code>ï¼Œç”¨ä¸€ä¸ªå•è¯æ¥å½¢å®¹å½“å‰æ¸¸æˆçš„å¥½åï¼Œä¸<code>score</code>ç›´æ¥æŒ‚é’©ï¼Œç”¨è¿™ä¸ªæ¥å±•ç¤ºåº”è¯¥ä¼šæ›´å®¹æ˜“ç†è§£å’Œåˆ†æã€‚</p>
<p>è¿™é‡Œå¯ä»¥ç”¨<code>Matplotlib.pyplot</code>çš„<code>bar</code>æ¥ç”»ï¼Œä¹Ÿå¯ä»¥ç”¨<code>Seaborn</code>ä¸­çš„<code>countplot</code>ï¼Œåè€…ä½¿ç”¨èµ·æ¥æ›´å®¹æ˜“æ–¹ä¾¿ã€‚
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sns.countplot(x=<span class="string">"platform"</span>, hue=<span class="string">"score_phrase"</span>, data=filtered_reviews, palette=sns.xkcd_palette(colors));</div></pre></td></tr></table></figure></p>
<p><img src="/images/output_13_0.png" alt="png"></p>
<p>å±•ç¤ºçš„ç»“æœå¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°PCå¹³å°ä¸‹ï¼Œ<code>Great</code>å’Œ<code>Good</code>è¿™ä¸¤æ ä¸‹çš„æ¸¸æˆæ•°é‡åŸºæœ¬å°±å äº†å¤§åŠï¼Œä½†æˆ‘å¹¶ä¸èƒ½è¯´PCç«¯çš„æ¸¸æˆè´¨é‡å°±æ¯”å…¶ä»–å¹³å°é«˜å‡ºä¸€ç­¹ï¼Œå› ä¸ºæˆ‘ä»¬ä¾ç„¶æ— æ³•åˆ¤æ–­æ¯ä¸ªå¹³å°ä¸‹ä¼˜ç§€çš„ä½œå“å æ¯”å¦‚ä½•ã€‚è¿™å¹…å›¾åªèƒ½ç›´è§‚åœ°å‘Šè¯‰æˆ‘ä»¬æ¯ä¸ªå¹³å°ä¸‹ï¼Œæ‰€æœ‰åˆ†æ•°çš„ä¸€ä¸ªåˆ†å¸ƒçŠ¶å†µã€‚</p>
<p>æ‰€ä»¥ï¼Œä¸‹é¢çš„å·¥ä½œï¼Œæˆ‘è¦ç»§ç»­ç»†åŒ–ä¸€ä¸‹æ•°æ®åˆ†æå’Œå±•ç¤ºçš„éƒ¨åˆ†ã€‚</p>
<hr>
<h2 id="è¿›ä¸€æ­¥åˆ†æä¸å±•ç¤ºæ•°æ®"><a href="#è¿›ä¸€æ­¥åˆ†æä¸å±•ç¤ºæ•°æ®" class="headerlink" title="è¿›ä¸€æ­¥åˆ†æä¸å±•ç¤ºæ•°æ®"></a>è¿›ä¸€æ­¥åˆ†æä¸å±•ç¤ºæ•°æ®</h2><p>å› ä¸ºåŸå…ˆåˆ’åˆ†çš„<code>score_phrase</code>å¤ªå¤šäº†ï¼Œæˆ‘å†³å®šå°†å®ƒä»¬é‡æ–°åˆ’ä¸ºä¸‰ä¸ªéƒ¨åˆ†ï¼šå¥½äº<code>Good</code>çš„ï¼Œå·®äº<code>Okay</code>çš„ï¼Œå‰©ä¸‹çš„å°±æ˜¯ä¸­é—´éƒ¨åˆ†ã€‚æˆ‘çš„è¿™ä¸ªæ ‡å‡†å¯èƒ½æ¯”è¾ƒä¸¥æ ¼ï¼Œåœ¨æˆ‘çœ‹æ¥ï¼Œè¯„åˆ†<code>8.0</code>ä»¥ä¸Šçš„æ‰ç®—çš„ä¸Šæ˜¯ä¼˜ç§€çš„ä½œå“ï¼Œä¹Ÿå°±æ˜¯é«˜äº<code>Good</code>çš„ï¼›è‡³äºé‚£äº›è¯„åˆ†ä½äº<code>6.0</code>çš„ï¼Œä¹Ÿå°±æ˜¯è¿˜ä¸åˆ°<code>Okay</code>çš„ï¼Œç®—ä½œå·®åŠ²ä¹Ÿä¸ç®—å¤±ç¤¼å§ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">all_score_phrases = set(reviews[<span class="string">"score_phrase"</span>].unique())</div><div class="line">bt_good = set([<span class="string">'Great'</span>, <span class="string">'Amazing'</span>, <span class="string">'Masterpiece'</span>])</div><div class="line">average = set([<span class="string">'Good'</span>, <span class="string">'Okay'</span>])</div><div class="line">wt_okay = all_score_phrases - bt_good - average</div><div class="line">    </div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">category_score_phrase</span><span class="params">(value)</span>:</span></div><div class="line">    <span class="keyword">if</span> value <span class="keyword">in</span> bt_good:</div><div class="line">        <span class="keyword">return</span> <span class="string">"Better than Good"</span></div><div class="line">    <span class="keyword">elif</span> value <span class="keyword">in</span> wt_okay:</div><div class="line">        <span class="keyword">return</span> <span class="string">"Worse than Okay"</span></div><div class="line">    <span class="keyword">else</span>:</div><div class="line">        <span class="keyword">return</span> <span class="string">"Average"</span></div><div class="line">        </div><div class="line">sizes = filtered_reviews[<span class="string">"score_phrase"</span>].apply(category_score_phrase).value_counts()</div><div class="line">explode = (<span class="number">0</span>, <span class="number">0.1</span>, <span class="number">0</span>)</div><div class="line">plt.pie(sizes, labels=sizes.index, explode=explode, autopct=<span class="string">'%1.2f%%'</span>, shadow=<span class="keyword">True</span>, startangle=<span class="number">90</span>);</div></pre></td></tr></table></figure>
<p><img src="/images/output_14_0.png" alt="png"></p>
<p>è¿™é‡Œæˆ‘å…ˆç”¨é¥¼å›¾æ¥å±•ç¤ºä¸€ä¸‹å‰åçš„å¹³å°ï¼Œæ•´ä½“çš„æ¸¸æˆè´¨é‡åˆ†å¸ƒæƒ…å†µã€‚</p>
<p>è¿™é‡Œï¼Œæˆ‘åˆ›å»ºäº†ä¸€ä¸ªæ–°åˆ—ï¼Œå«<code>score_phrase_new</code>ï¼Œä¸ºäº†åŒºåˆ«åŸæœ‰çš„<code>score_phrase</code>ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">filtered_reviews[<span class="string">"score_phrase_new"</span>] = filtered_reviews[<span class="string">"score_phrase"</span>].apply(category_score_phrase)</div><div class="line">filtered_reviews.head()</div></pre></td></tr></table></figure>
<div>
<table class="blueTable">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>score_phrase</th>
      <th>title</th>
      <th>url</th>
      <th>platform</th>
      <th>score</th>
      <th>genre</th>
      <th>editors_choice</th>
      <th>release_year</th>
      <th>release_month</th>
      <th>release_day</th>
      <th>score_phrase_new</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>3</th>
      <td>Great</td>
      <td>NHL 13</td>
      <td>/games/nhl-13/xbox-360-128182</td>
      <td>Xbox 360</td>
      <td>8.5</td>
      <td>Sports</td>
      <td>N</td>
      <td>2012</td>
      <td>9</td>
      <td>11</td>
      <td>Better than Good</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Great</td>
      <td>NHL 13</td>
      <td>/games/nhl-13/ps3-128181</td>
      <td>PlayStation 3</td>
      <td>8.5</td>
      <td>Sports</td>
      <td>N</td>
      <td>2012</td>
      <td>9</td>
      <td>11</td>
      <td>Better than Good</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Awful</td>
      <td>Double Dragon: Neon</td>
      <td>/games/double-dragon-neon/xbox-360-131320</td>
      <td>Xbox 360</td>
      <td>3.0</td>
      <td>Fighting</td>
      <td>N</td>
      <td>2012</td>
      <td>9</td>
      <td>11</td>
      <td>Worse than Okay</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Amazing</td>
      <td>Guild Wars 2</td>
      <td>/games/guild-wars-2/pc-896298</td>
      <td>PC</td>
      <td>9.0</td>
      <td>RPG</td>
      <td>Y</td>
      <td>2012</td>
      <td>9</td>
      <td>11</td>
      <td>Better than Good</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Awful</td>
      <td>Double Dragon: Neon</td>
      <td>/games/double-dragon-neon/ps3-131321</td>
      <td>PlayStation 3</td>
      <td>3.0</td>
      <td>Fighting</td>
      <td>N</td>
      <td>2012</td>
      <td>9</td>
      <td>11</td>
      <td>Worse than Okay</td>
    </tr>
  </tbody>
</table>
</div>

<p>å…ˆæ¥ç”¨æ•°å­—ç›´è§‚åœ°çœ‹ä¸€ä¸‹æ¯ä¸ªå¹³å°ä¸‹ï¼Œæ¯ä¸ªè¯„åˆ†é˜¶æ®µçš„æ•°é‡ã€‚
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">filtered_reviews.groupby([<span class="string">"platform"</span>, <span class="string">"score_phrase_new"</span>]).count()</div></pre></td></tr></table></figure></p>
<div>
<table class="blueTable">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>score_phrase</th>
      <th>title</th>
      <th>url</th>
      <th>score</th>
      <th>genre</th>
      <th>editors_choice</th>
      <th>release_year</th>
      <th>release_month</th>
      <th>release_day</th>
    </tr>
    <tr>
      <th>platform</th>
      <th>score_phrase_new</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="3" valign="top">Nintendo DS</th>
      <th>Average</th>
      <td>462</td>
      <td>462</td>
      <td>462</td>
      <td>462</td>
      <td>462</td>
      <td>462</td>
      <td>462</td>
      <td>462</td>
      <td>462</td>
    </tr>
    <tr>
      <th>Better than Good</th>
      <td>207</td>
      <td>207</td>
      <td>207</td>
      <td>207</td>
      <td>207</td>
      <td>207</td>
      <td>207</td>
      <td>207</td>
      <td>207</td>
    </tr>
    <tr>
      <th>Worse than Okay</th>
      <td>376</td>
      <td>376</td>
      <td>376</td>
      <td>376</td>
      <td>375</td>
      <td>376</td>
      <td>376</td>
      <td>376</td>
      <td>376</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">PC</th>
      <th>Average</th>
      <td>1394</td>
      <td>1394</td>
      <td>1394</td>
      <td>1394</td>
      <td>1393</td>
      <td>1394</td>
      <td>1394</td>
      <td>1394</td>
      <td>1394</td>
    </tr>
    <tr>
      <th>Better than Good</th>
      <td>1323</td>
      <td>1323</td>
      <td>1323</td>
      <td>1323</td>
      <td>1322</td>
      <td>1323</td>
      <td>1323</td>
      <td>1323</td>
      <td>1323</td>
    </tr>
    <tr>
      <th>Worse than Okay</th>
      <td>653</td>
      <td>653</td>
      <td>653</td>
      <td>653</td>
      <td>652</td>
      <td>653</td>
      <td>653</td>
      <td>653</td>
      <td>653</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">PlayStation</th>
      <th>Average</th>
      <td>362</td>
      <td>362</td>
      <td>362</td>
      <td>362</td>
      <td>362</td>
      <td>362</td>
      <td>362</td>
      <td>362</td>
      <td>362</td>
    </tr>
    <tr>
      <th>Better than Good</th>
      <td>313</td>
      <td>313</td>
      <td>313</td>
      <td>313</td>
      <td>313</td>
      <td>313</td>
      <td>313</td>
      <td>313</td>
      <td>313</td>
    </tr>
    <tr>
      <th>Worse than Okay</th>
      <td>277</td>
      <td>277</td>
      <td>277</td>
      <td>277</td>
      <td>277</td>
      <td>277</td>
      <td>277</td>
      <td>277</td>
      <td>277</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">PlayStation 2</th>
      <th>Average</th>
      <td>716</td>
      <td>716</td>
      <td>716</td>
      <td>716</td>
      <td>716</td>
      <td>716</td>
      <td>716</td>
      <td>716</td>
      <td>716</td>
    </tr>
    <tr>
      <th>Better than Good</th>
      <td>542</td>
      <td>542</td>
      <td>542</td>
      <td>542</td>
      <td>542</td>
      <td>542</td>
      <td>542</td>
      <td>542</td>
      <td>542</td>
    </tr>
    <tr>
      <th>Worse than Okay</th>
      <td>428</td>
      <td>428</td>
      <td>428</td>
      <td>428</td>
      <td>426</td>
      <td>428</td>
      <td>428</td>
      <td>428</td>
      <td>428</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">PlayStation 3</th>
      <th>Average</th>
      <td>516</td>
      <td>516</td>
      <td>516</td>
      <td>516</td>
      <td>515</td>
      <td>516</td>
      <td>516</td>
      <td>516</td>
      <td>516</td>
    </tr>
    <tr>
      <th>Better than Good</th>
      <td>569</td>
      <td>569</td>
      <td>569</td>
      <td>569</td>
      <td>569</td>
      <td>569</td>
      <td>569</td>
      <td>569</td>
      <td>569</td>
    </tr>
    <tr>
      <th>Worse than Okay</th>
      <td>271</td>
      <td>271</td>
      <td>271</td>
      <td>271</td>
      <td>271</td>
      <td>271</td>
      <td>271</td>
      <td>271</td>
      <td>271</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">Wii</th>
      <th>Average</th>
      <td>551</td>
      <td>551</td>
      <td>551</td>
      <td>551</td>
      <td>547</td>
      <td>551</td>
      <td>551</td>
      <td>551</td>
      <td>551</td>
    </tr>
    <tr>
      <th>Better than Good</th>
      <td>321</td>
      <td>321</td>
      <td>321</td>
      <td>321</td>
      <td>321</td>
      <td>321</td>
      <td>321</td>
      <td>321</td>
      <td>321</td>
    </tr>
    <tr>
      <th>Worse than Okay</th>
      <td>494</td>
      <td>494</td>
      <td>494</td>
      <td>494</td>
      <td>494</td>
      <td>494</td>
      <td>494</td>
      <td>494</td>
      <td>494</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">Wireless</th>
      <th>Average</th>
      <td>473</td>
      <td>473</td>
      <td>473</td>
      <td>473</td>
      <td>471</td>
      <td>473</td>
      <td>473</td>
      <td>473</td>
      <td>473</td>
    </tr>
    <tr>
      <th>Better than Good</th>
      <td>308</td>
      <td>308</td>
      <td>308</td>
      <td>308</td>
      <td>306</td>
      <td>308</td>
      <td>308</td>
      <td>308</td>
      <td>308</td>
    </tr>
    <tr>
      <th>Worse than Okay</th>
      <td>129</td>
      <td>129</td>
      <td>129</td>
      <td>129</td>
      <td>129</td>
      <td>129</td>
      <td>129</td>
      <td>129</td>
      <td>129</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">Xbox</th>
      <th>Average</th>
      <td>307</td>
      <td>307</td>
      <td>307</td>
      <td>307</td>
      <td>307</td>
      <td>307</td>
      <td>307</td>
      <td>307</td>
      <td>307</td>
    </tr>
    <tr>
      <th>Better than Good</th>
      <td>354</td>
      <td>354</td>
      <td>354</td>
      <td>354</td>
      <td>354</td>
      <td>354</td>
      <td>354</td>
      <td>354</td>
      <td>354</td>
    </tr>
    <tr>
      <th>Worse than Okay</th>
      <td>160</td>
      <td>160</td>
      <td>160</td>
      <td>160</td>
      <td>160</td>
      <td>160</td>
      <td>160</td>
      <td>160</td>
      <td>160</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">Xbox 360</th>
      <th>Average</th>
      <td>631</td>
      <td>631</td>
      <td>631</td>
      <td>631</td>
      <td>631</td>
      <td>631</td>
      <td>631</td>
      <td>631</td>
      <td>631</td>
    </tr>
    <tr>
      <th>Better than Good</th>
      <td>646</td>
      <td>646</td>
      <td>646</td>
      <td>646</td>
      <td>646</td>
      <td>646</td>
      <td>646</td>
      <td>646</td>
      <td>646</td>
    </tr>
    <tr>
      <th>Worse than Okay</th>
      <td>354</td>
      <td>354</td>
      <td>354</td>
      <td>354</td>
      <td>354</td>
      <td>354</td>
      <td>354</td>
      <td>354</td>
      <td>354</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">iPhone</th>
      <th>Average</th>
      <td>412</td>
      <td>412</td>
      <td>412</td>
      <td>412</td>
      <td>405</td>
      <td>412</td>
      <td>412</td>
      <td>412</td>
      <td>412</td>
    </tr>
    <tr>
      <th>Better than Good</th>
      <td>321</td>
      <td>321</td>
      <td>321</td>
      <td>321</td>
      <td>315</td>
      <td>321</td>
      <td>321</td>
      <td>321</td>
      <td>321</td>
    </tr>
    <tr>
      <th>Worse than Okay</th>
      <td>109</td>
      <td>109</td>
      <td>109</td>
      <td>109</td>
      <td>108</td>
      <td>109</td>
      <td>109</td>
      <td>109</td>
      <td>109</td>
    </tr>
  </tbody>
</table>
</div>

<p>äº‹å®ä¸Šï¼Œä¸Šé¢çš„è¡¨æ ¼å¤§éƒ¨åˆ†å†…å®¹ä¹Ÿç”¨ä¸ä¸Šï¼Œæˆ‘ä»¬éœ€è¦çš„å…¶å®å°±ä¸‰åˆ—ï¼š<strong>æ¸¸æˆå¹³å°</strong>ï¼Œ<strong>è¯„åˆ†é˜¶æ®µ</strong>å’Œ<strong>æ•°é‡</strong>ã€‚å› æ­¤æˆ‘å°±å‹ç¼©ä¸€ä¸‹åŸè¡¨æ ¼ï¼Œè®©å®ƒå˜æˆä¸‹é¢çš„æ ·å­ã€‚
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">count_df = filtered_reviews.groupby([<span class="string">"platform"</span>, <span class="string">"score_phrase_new"</span>]).count().reset_index().iloc[:, :<span class="number">3</span>]</div><div class="line">count_df.rename(columns=&#123;<span class="string">"score_phrase"</span>: <span class="string">"count"</span>&#125;, inplace=<span class="keyword">True</span>)</div><div class="line">count_df</div></pre></td></tr></table></figure></p>
<div>
<table class="blueTable">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>platform</th>
      <th>score_phrase_new</th>
      <th>count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Nintendo DS</td>
      <td>Average</td>
      <td>462</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Nintendo DS</td>
      <td>Better than Good</td>
      <td>207</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Nintendo DS</td>
      <td>Worse than Okay</td>
      <td>376</td>
    </tr>
    <tr>
      <th>3</th>
      <td>PC</td>
      <td>Average</td>
      <td>1394</td>
    </tr>
    <tr>
      <th>4</th>
      <td>PC</td>
      <td>Better than Good</td>
      <td>1323</td>
    </tr>
    <tr>
      <th>5</th>
      <td>PC</td>
      <td>Worse than Okay</td>
      <td>653</td>
    </tr>
    <tr>
      <th>6</th>
      <td>PlayStation</td>
      <td>Average</td>
      <td>362</td>
    </tr>
    <tr>
      <th>7</th>
      <td>PlayStation</td>
      <td>Better than Good</td>
      <td>313</td>
    </tr>
    <tr>
      <th>8</th>
      <td>PlayStation</td>
      <td>Worse than Okay</td>
      <td>277</td>
    </tr>
    <tr>
      <th>9</th>
      <td>PlayStation 2</td>
      <td>Average</td>
      <td>716</td>
    </tr>
    <tr>
      <th>10</th>
      <td>PlayStation 2</td>
      <td>Better than Good</td>
      <td>542</td>
    </tr>
    <tr>
      <th>11</th>
      <td>PlayStation 2</td>
      <td>Worse than Okay</td>
      <td>428</td>
    </tr>
    <tr>
      <th>12</th>
      <td>PlayStation 3</td>
      <td>Average</td>
      <td>516</td>
    </tr>
    <tr>
      <th>13</th>
      <td>PlayStation 3</td>
      <td>Better than Good</td>
      <td>569</td>
    </tr>
    <tr>
      <th>14</th>
      <td>PlayStation 3</td>
      <td>Worse than Okay</td>
      <td>271</td>
    </tr>
    <tr>
      <th>15</th>
      <td>Wii</td>
      <td>Average</td>
      <td>551</td>
    </tr>
    <tr>
      <th>16</th>
      <td>Wii</td>
      <td>Better than Good</td>
      <td>321</td>
    </tr>
    <tr>
      <th>17</th>
      <td>Wii</td>
      <td>Worse than Okay</td>
      <td>494</td>
    </tr>
    <tr>
      <th>18</th>
      <td>Wireless</td>
      <td>Average</td>
      <td>473</td>
    </tr>
    <tr>
      <th>19</th>
      <td>Wireless</td>
      <td>Better than Good</td>
      <td>308</td>
    </tr>
    <tr>
      <th>20</th>
      <td>Wireless</td>
      <td>Worse than Okay</td>
      <td>129</td>
    </tr>
    <tr>
      <th>21</th>
      <td>Xbox</td>
      <td>Average</td>
      <td>307</td>
    </tr>
    <tr>
      <th>22</th>
      <td>Xbox</td>
      <td>Better than Good</td>
      <td>354</td>
    </tr>
    <tr>
      <th>23</th>
      <td>Xbox</td>
      <td>Worse than Okay</td>
      <td>160</td>
    </tr>
    <tr>
      <th>24</th>
      <td>Xbox 360</td>
      <td>Average</td>
      <td>631</td>
    </tr>
    <tr>
      <th>25</th>
      <td>Xbox 360</td>
      <td>Better than Good</td>
      <td>646</td>
    </tr>
    <tr>
      <th>26</th>
      <td>Xbox 360</td>
      <td>Worse than Okay</td>
      <td>354</td>
    </tr>
    <tr>
      <th>27</th>
      <td>iPhone</td>
      <td>Average</td>
      <td>412</td>
    </tr>
    <tr>
      <th>28</th>
      <td>iPhone</td>
      <td>Better than Good</td>
      <td>321</td>
    </tr>
    <tr>
      <th>29</th>
      <td>iPhone</td>
      <td>Worse than Okay</td>
      <td>109</td>
    </tr>
  </tbody>
</table>
</div>

<p>æ•°æ®æ‹¿åˆ°æ‰‹äº†ï¼Œä¸‹é¢åˆè¯¥æ˜¯ç”¨å›¾å½¢å±•ç¤ºæ•°æ®çš„æ—¶å€™ã€‚è¿™æ¬¡æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹æ¯ä¸€ä¸ªè¯„åˆ†é˜¶æ®µå¯¹äºå„è‡ªæ¸¸æˆå¹³å°å æ¯”ç©¶ç«Ÿæ˜¯å¤šå°‘ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">bar_width = <span class="number">1</span></div><div class="line">bar_left = [i <span class="keyword">for</span> i <span class="keyword">in</span> range(len(count_df) // <span class="number">3</span>)]</div><div class="line">tick_pos = [i + (bar_width / <span class="number">2</span>) <span class="keyword">for</span> i <span class="keyword">in</span> bar_left]</div><div class="line">totals = [i + j + k <span class="keyword">for</span> i, j, k <span class="keyword">in</span> zip(count_df[<span class="string">"count"</span>][::<span class="number">3</span>], count_df[<span class="string">"count"</span>][<span class="number">1</span>::<span class="number">3</span>], count_df[<span class="string">"count"</span>][<span class="number">2</span>::<span class="number">3</span>])]</div><div class="line">ave_perc = [i / j * <span class="number">100</span> <span class="keyword">for</span> i, j <span class="keyword">in</span> zip(count_df[<span class="string">"count"</span>][::<span class="number">3</span>], totals)]</div><div class="line">bt_good_perc = [i / j * <span class="number">100</span> <span class="keyword">for</span> i, j <span class="keyword">in</span> zip(count_df[<span class="string">"count"</span>][<span class="number">1</span>::<span class="number">3</span>], totals)]</div><div class="line">wt_okay_perc = [i / j * <span class="number">100</span> <span class="keyword">for</span> i, j <span class="keyword">in</span> zip(count_df[<span class="string">"count"</span>][<span class="number">2</span>::<span class="number">3</span>], totals)]</div></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line">f, ax = plt.subplots(<span class="number">1</span>)</div><div class="line">    </div><div class="line">ax.bar(bar_left, </div><div class="line">       wt_okay_perc,</div><div class="line">       label=<span class="string">"Worst than Okay"</span>,</div><div class="line">       alpha=<span class="number">0.9</span>,</div><div class="line">       width=bar_width,</div><div class="line">       edgecolor=<span class="string">"white"</span>)</div><div class="line">       </div><div class="line">ax.bar(bar_left,</div><div class="line">       ave_perc,</div><div class="line">       bottom=wt_okay_perc,</div><div class="line">       label=<span class="string">"Average"</span>,</div><div class="line">       alpha=<span class="number">0.9</span>,</div><div class="line">       width=bar_width,</div><div class="line">       edgecolor=<span class="string">"white"</span>)</div><div class="line">       </div><div class="line">ax.bar(bar_left,</div><div class="line">       bt_good_perc,</div><div class="line">       bottom=[i+j <span class="keyword">for</span> i, j <span class="keyword">in</span> zip(wt_okay_perc, ave_perc)],</div><div class="line">       label=<span class="string">"Better than Good"</span>,</div><div class="line">       alpha=<span class="number">0.9</span>,</div><div class="line">       width=bar_width,</div><div class="line">       edgecolor=<span class="string">"white"</span>)</div><div class="line">       </div><div class="line">plt.xticks(tick_pos, set(count_df[<span class="string">"platform"</span>]))</div><div class="line">ax.set_ylabel(<span class="string">"Percentage"</span>)</div><div class="line">ax.set_xlabel(<span class="string">""</span>)</div><div class="line">plt.legend(bbox_to_anchor=(<span class="number">1.</span>, <span class="number">1.</span>))</div><div class="line">plt.setp(plt.gca().get_xticklabels(), rotation=<span class="number">45</span>, horizontalalignment=<span class="string">"right"</span>)</div><div class="line">plt.show()</div></pre></td></tr></table></figure>
<p><img src="/images/output_19_0.png" alt="png"></p>
<p>æˆ‘å¹¶æ²¡æœ‰ç›´æ¥æŠŠå…·ä½“ç™¾åˆ†æ¯”çš„æ•°å€¼æ ‡è®°åœ¨ä¸Šé¢ï¼Œä¸è¿‡é€šè¿‡ç›´è§‚çš„å›¾å½¢ä¾ç„¶å¯ä»¥çœ‹åˆ°ä¸€äº›ä¿¡æ¯ã€‚ä»å›¾ä¸­å¯ä»¥çœ‹å‡ºæ¥ï¼Œç›¸å¯¹æ¥è¯´ï¼Œ<code>PlayStation</code>ï¼Œ<code>PlayStation2</code>ï¼Œ<code>Wii</code>ï¼Œ<code>PC</code>å’Œ<code>Nintendo DS</code>çš„æ¸¸æˆè´¨é‡éƒ½æ˜¯å¾ˆä¸é”™çš„ï¼Œé«˜è´¨é‡æ¸¸æˆå æ¯”é«˜ï¼Œä¸”ä½è´¨é‡æ¸¸æˆå æ¯”ä½ã€‚<code>PlayStation3</code>è™½ç„¶ä½è´¨é‡æ¸¸æˆå æ¯”å¾ˆå°ï¼Œä½†æ˜¯é«˜å“è´¨æ¸¸æˆä¹Ÿä¸ç®—å¾ˆå¤šã€‚<code>iPhone</code>å’Œ<code>Xbox</code>çš„è¡¨ç°ç®—æ˜¯æœ€å·®çš„äº†ï¼Œä½è´¨é‡æ¸¸æˆå æ¯”åˆ†å±æœ€é«˜çš„ä¸€äºŒï¼Œé«˜å“è´¨æ¸¸æˆä¹Ÿæ˜¯æœ€ä½çš„ä¸¤ä¸ªå¹³å°ã€‚å…¶å®<code>iPhone</code>æ˜¯è¿™æ ·çš„å€’æ˜¯ä¸æ„å¤–äº†ï¼Œå› ä¸ºæ¯•ç«Ÿ<code>iPhone</code>å¹³å°çš„èµ·ç‚¹ç›¸å¯¹äºå…¶ä»–çš„å¹³å°è¦ä½å¾ˆå¤šï¼ŒåŸºæœ¬ä¸Šä¸‰äº”ä¸ªäººï¼Œç”šè‡³ä¸€ä¸ªäººåšå‡ºçš„æ¸¸æˆéƒ½æœ‰ï¼Œè¿™æ ·å¾ˆéš¾ä¿è¯æ¸¸æˆå…¼é¡¾è¶£å‘³æ€§å’Œå‰§æƒ…æˆ–è€…å…¶ä»–æ–¹é¢ã€‚åœ¨åæœŸç»´æŠ¤ä¸Šé¢è‚¯å®šä¹Ÿè¦æ¯”å¤§å…¬å¸å¼€å‘çš„æ¸¸æˆå·®äº†å¾ˆå¤šã€‚é—æ†¾çš„æ˜¯<code>Xbox</code>ç«Ÿç„¶ä¹Ÿæœ‰å¦‚æ­¤å·®åŠ²çš„è¡¨ç°ï¼Œç€å®ä»¤æˆ‘éš¾ä»¥ç†è§£ã€‚</p>
<hr>
<h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>è‡³æ­¤ï¼Œæˆ‘æ‰“ç®—åˆ†æçš„å†…å®¹å°±å‘ˆç°å®Œäº†ï¼Œè¿™å°±æ˜¯æˆ‘ä¸ªäººæ‹¿åˆ°æ•°æ®ä¹‹åä¸€ä¸ªç®€å•çš„æƒ³æ³•ï¼Œç„¶åè¯•ç€å»å°†è¿™ä¸ªæƒ³æ³•ç”¨æ•°æ®åˆ†æçš„æ–¹æ³•å±•ç°å‡ºæ¥ï¼Œä¾›è‡ªå·±å»ç†è§£ã€‚åé¢æˆ‘è¿˜ä¼šå¯¹è¿™ä¸ªæ•°æ®é›†è¿›ä¸€æ­¥çš„åˆ†æï¼Œæ¯”å¦‚å»æ¢è®¨ä¸€ä¸‹å¹´ä»½å’Œåˆ†æ•°çš„å…³ç³»ï¼Œæ¸¸æˆç±»åˆ«å’Œåˆ†æ•°çš„å…³ç³»ã€‚å¸Œæœ›è¿™ç¯‡æ–‡ç« å¯ä»¥èµ·åˆ°æŠ›ç –å¼•ç‰çš„ä½œç”¨ï¼Œèƒ½è®©å„ä½çœ‹å®Œä¹‹åå¯¹äºå¦‚ä½•å¼€å§‹åˆ†æä¸€ä»½æ•°æ®æœ‰è‡ªå·±çš„æƒ³æ³•ã€‚</p>
<p>å„ä½çœ‹å®˜å¯¹äºæœ¬æ–‡æœ‰ä»»ä½•ä¸æ˜ç™½çš„åœ°æ–¹ï¼Œæ¬¢è¿æé—®ï¼Œä¹Ÿæ¬¢è¿æŒ‡æ­£å’Œå»ºè®®ã€‚</p>
<hr>
<h1 id="Related-Links"><a href="#Related-Links" class="headerlink" title="Related Links"></a>Related Links</h1><ol>
<li><a href="https://www.dataquest.io/blog/pandas-python-tutorial/" target="_blank" rel="external">Pandas Tutorial: Data analysis with Python: Part 1</a></li>
<li><a href="https://www.dataquest.io/blog/pandas-tutorial-python-2/" target="_blank" rel="external">Pandas Tutorial: Data analysis with Python: Part 2</a></li>
<li><a href="https://chrisalbon.com/python/matplotlib_percentage_stacked_bar_plot.html" target="_blank" rel="external">Stacked Percentage Bar Plot In MatPlotLib</a></li>
</ol>
]]></content>
      
        <categories>
            
            <category> Data analysis </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Python </tag>
            
            <tag> Pandas </tag>
            
            <tag> Data analysis </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[ç”¨Pythonåœ¨Hadoopä¸Šè·‘MapReduce]]></title>
      <url>/2017/09/29/Map-reduce-works-perfectly-with-Python/</url>
      <content type="html"><![CDATA[<h1 id="æœ¬æ–‡ç›®çš„"><a href="#æœ¬æ–‡ç›®çš„" class="headerlink" title="æœ¬æ–‡ç›®çš„"></a>æœ¬æ–‡ç›®çš„</h1><p>è¿™ç¯‡æ–‡ç« ä¸»è¦ä¼šç»™å¤§å®¶ä»‹ç»ä¸€ä¸‹å¦‚ä½•å°†Pythonå’ŒHadoopç»“åˆèµ·æ¥å·¥ä½œã€‚æœ‰æ¥è§¦è¿‡MapReduceçš„æœ‹å‹éƒ½çŸ¥é“ï¼ŒHadoopçš„è¿è¡Œç¯å¢ƒä¸»è¦æ˜¯Javaï¼Œä¸€èˆ¬ä»‹ç»Hadoopå’ŒMapReduceçš„æ•™ç¨‹å’Œä¹¦ç±ä¹Ÿéƒ½æ˜¯åŸºäºJavaçš„ã€‚å› ä¸ºæˆ‘ä¸ªäººå¯¹Javaå¹¶ä¸å¤ªæ„Ÿå†’ï¼Œä¸€ç›´ä»¥æ¥é’Ÿæƒ…äºPythonçš„ç®€æ´å®ç”¨ç†å¿µï¼ŒåŒæ—¶åˆå¯¹MapReduceæœ‰å…´è¶£ï¼Œå› æ­¤èŒç”Ÿäº†Pythonçš„MapReduceç»“åˆçš„æƒ³æ³•ã€‚æœ¬æ–‡ä¹Ÿæ˜¯æˆ‘ç»è¿‡Googleå­¦ä¹ ä»–äººæ•™ç¨‹ï¼Œä»¥åŠè‡ªå·±å®é™…ç»ƒä¹ å¾—å‡ºæ¥çš„ä¸€äº›å¿ƒå¾—ï¼Œåœ¨æ­¤åˆ†äº«ç»™å„ä½ã€‚</p>
<a id="more"></a>
<hr>
<h1 id="ç¯å¢ƒæ­å»º"><a href="#ç¯å¢ƒæ­å»º" class="headerlink" title="ç¯å¢ƒæ­å»º"></a>ç¯å¢ƒæ­å»º</h1><p>é¦–å…ˆï¼Œä½ éœ€è¦æœ‰ä¸ªHadoopçš„è¿è¡Œç¯å¢ƒï¼Œè¿˜æœ‰Pythonè¿è¡Œç¯å¢ƒã€‚æœ¬æ–‡ä¸»è¦ç›®çš„ä¸åœ¨åˆ†äº«å®‰è£…ç¯å¢ƒï¼Œå› æ­¤æœ‰ä»é›¶å¼€å§‹çš„æœ‹å‹ï¼Œå¯ä»¥å…ˆå»ç™¾åº¦æˆ–è€…Googleä¸Šæœä¸€ä¸‹ç›¸å…³æ•™ç¨‹ã€‚ä¸‹é¢åˆ†äº«å‡ ä¸ªç›¸å…³çš„æ•™ç¨‹ï¼š</p>
<ul>
<li><a href="http://hadoop.apache.org/docs/stable/hadoop-project-dist/hadoop-common/SingleCluster.html" target="_blank" rel="external">Hadoop: Setting up a Single Node Cluster</a></li>
<li><a href="http://www.powerxing.com/install-hadoop/" target="_blank" rel="external">Hadoopå®‰è£…æ•™ç¨‹_å•æœº/ä¼ªåˆ†å¸ƒå¼é…ç½®_Hadoop2.6.0/Ubuntu14.04</a></li>
<li><a href="http://www.tashan10.com/yong-dockerda-jian-hadoopwei-fen-bu-shi-ji-qun/" target="_blank" rel="external">ä½¿ç”¨Dockeråœ¨æœ¬åœ°æ­å»ºHadoopåˆ†å¸ƒå¼é›†ç¾¤</a></li>
</ul>
<hr>
<h1 id="MapReduce-in-Python"><a href="#MapReduce-in-Python" class="headerlink" title="MapReduce in Python"></a>MapReduce in Python</h1><p>ä¸‹é¢æˆ‘å°±æ¥çœ‹Pythoné‡Œå¦‚ä½•å®ç°mapperå’Œreducerã€‚</p>
<h2 id="mapper-py"><a href="#mapper-py" class="headerlink" title="mapper.py"></a>mapper.py</h2><p>mapperè¦åšçš„å·¥ä½œå°±æ˜¯ä»<code>stdin</code>é‡Œè¯»å–æ•°æ®ï¼Œç„¶ååˆ†å‰²æˆ<code>&lt;key, value&gt;</code>çš„pairã€‚è¿™é‡Œä»¥æœ€åŸºç¡€çš„word countä¸ºä¾‹ï¼Œ<code>key</code>å°±æ˜¯æŒ‡æ–‡ç« ä¸­æ‹†å‡ºæ¥çš„è¯ï¼Œ<code>value</code>å°±æ˜¯æŒ‡æ¯ä¸ªè¯çš„ä¸ªæ•°ã€‚mapperæ˜¯ä¸ä¼šå°†ç›¸åŒçš„è¯çš„ä¸ªæ•°è¿›è¡Œç»Ÿè®¡åŠ å’Œçš„ï¼Œé‚£æ˜¯reducerçš„å·¥ä½œï¼Œå› æ­¤mapperçš„è¾“å‡ºå°±æ˜¯ç”±å¾ˆå¤šè¡Œ<code>&lt;key&gt; 1</code>ç»„æˆï¼Œä¸‹é¢ä¼šçœ‹åˆ°ç¨‹åºè¿è¡Œå®é™…çš„ç»“æœã€‚</p>
<p><code>mapper.py</code>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#!/usr/bin/env python3</span></div><div class="line">    </div><div class="line"><span class="keyword">import</span> sys</div><div class="line">    </div><div class="line"><span class="comment"># ä»stdinä¸­è·å–è¾“å‡ºä¿¡æ¯</span></div><div class="line"><span class="keyword">for</span> line <span class="keyword">in</span> sys.stdin:</div><div class="line">    words = line.strip().split(<span class="string">" "</span>)</div><div class="line">    <span class="keyword">for</span> word <span class="keyword">in</span> words:</div><div class="line">    </div><div class="line">        <span class="comment"># output format: word'\t'1</span></div><div class="line">        print(<span class="string">"&#123;0&#125;\t&#123;1&#125;"</span>.format(word, <span class="number">1</span>))</div></pre></td></tr></table></figure></p>
<hr>
<h2 id="reducer-py"><a href="#reducer-py" class="headerlink" title="reducer.py"></a>reducer.py</h2><p>ä¸Šé¢æåˆ°äº†ï¼Œmapperåªè¿›è¡Œè¯æ±‡åˆ†å‰²ï¼Œè®¡æ•°ä¸º1çš„å·¥ä½œï¼Œé‚£ä¹ˆreducerå°±æ˜¯ç”¨æ¥å°†ç›¸åŒè¯æ±‡çš„å‡ºç°æ¬¡æ•°è¿›è¡Œç»Ÿè®¡åŠ å’Œçš„å·¥ä½œã€‚åŒmapperä¸€æ ·ï¼Œreducerä¹Ÿæ˜¯ä»<code>stdin</code>ä¸­è·å–è¾“å…¥ï¼Œç„¶åå°†ç»“æœè¾“å‡ºåˆ°<code>stdout</code>ã€‚</p>
<p><code>reducer.py</code>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#!/usr/bin/env python3</span></div><div class="line">    </div><div class="line"><span class="keyword">import</span> sys</div><div class="line">    </div><div class="line">last_word = <span class="keyword">None</span></div><div class="line">total_count = <span class="number">0</span></div><div class="line">    </div><div class="line"><span class="keyword">for</span> line <span class="keyword">in</span> sys.stdin:</div><div class="line">    word, count = line.strip().split(<span class="string">"\t"</span>)</div><div class="line">    count = int(count)</div><div class="line">    </div><div class="line">    <span class="comment"># å¦‚æœå½“å‰çš„wordä¸ç­‰äºä¸Šä¸€ä¸ªï¼Œè¯´æ˜å¼€å§‹æ–°çš„äº†</span></div><div class="line">    <span class="keyword">if</span> last_word <span class="keyword">and</span> last_word != word:</div><div class="line">        <span class="comment"># è¿™é‡Œè¾“å‡ºç»“æœï¼Œç›¸å½“äºæŠŠç»“æœå†™è¿›stdout</span></div><div class="line">        print(<span class="string">"&#123;0&#125;\t&#123;1&#125;"</span>.format(last_word, total_count))</div><div class="line">        total_count = <span class="number">0</span></div><div class="line">    last_word = word</div><div class="line">    total_count += count</div><div class="line">    </div><div class="line"><span class="comment"># ä¸è¦å¿˜è®°æœ€åä¸€ä¸ªwordçš„è¾“å‡º</span></div><div class="line"><span class="keyword">if</span> last_word:</div><div class="line">    print(<span class="string">"&#123;0&#125;\t&#123;1&#125;"</span>.format(last_word, total_count))</div></pre></td></tr></table></figure></p>
<hr>
<h1 id="æœ¬åœ°æµ‹è¯•"><a href="#æœ¬åœ°æµ‹è¯•" class="headerlink" title="æœ¬åœ°æµ‹è¯•"></a>æœ¬åœ°æµ‹è¯•</h1><p>æˆ‘ä»¬å…ˆæ¥æœ¬åœ°æµ‹è¯•ä¸€ä¸‹æ­£ç¡®æ€§ã€‚
<figure class="highlight console"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">YuanMBP:src Vergil$ echo "ä¸œ å— è¥¿ åŒ— ä¸­ å‘ ç™½" | demo/mapper.py </div><div class="line">ä¸œ   1</div><div class="line">å—   1</div><div class="line">è¥¿   1</div><div class="line">åŒ—   1</div><div class="line">ä¸­   1</div><div class="line">å‘   1</div><div class="line">ç™½   1</div></pre></td></tr></table></figure></p>
<p>å†æ¥çœ‹ä¸€ä¸‹reducerï¼š
<figure class="highlight console"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">YuanMBP:src Vergil$ echo "ä¸œ å— è¥¿ åŒ— ä¸œ ä¸­ ä¸œ å‘ ä¸œ ç™½" | demo/mapper.py | sort | demo/reducer.py </div><div class="line">ä¸œ   4</div><div class="line">ä¸­   1</div><div class="line">åŒ—   1</div><div class="line">å—   1</div><div class="line">å‘   1</div><div class="line">ç™½   1</div><div class="line">è¥¿   1</div></pre></td></tr></table></figure></p>
<p>è¯·æ³¨æ„ï¼Œè¿™é‡Œæˆ‘åœ¨è¿è¡Œmapperå’Œreducerä¹‹é—´åŠ å…¥äº†ä¸€ä¸ªsortï¼Œè¿™æ˜¯å¿…é¡»çš„ï¼Œäº†è§£map-reduceå·¥ä½œåŸç†çš„æœ‹å‹åº”è¯¥éƒ½æ˜ç™½è¿™é‡Œä¸ºä»€ä¹ˆæœ‰ä¸€ä¸ªsortï¼Œå¦‚æœä¸åŠ çš„è¯ï¼Œæˆ‘ä»¬çš„ä¸œé£æ å°±è¯†åˆ«ä¸äº†å•¦ã€‚æˆ‘ä»¬åœ¨å†™mapperå’Œreducerçš„æ—¶å€™æ˜¯ä¸éœ€è¦å…³æ³¨å®ƒæ’åºçš„é—®é¢˜ï¼Œå› ä¸ºHadoopä¸­çš„map-reduceä¼šè‡ªåŠ¨è¿›è¡Œæ’åºã€‚
<figure class="highlight console"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">YuanMBP:src Vergil$ echo "ä¸œ å— è¥¿ åŒ— ä¸œ ä¸­ ä¸œ å‘ ä¸œ ç™½" | demo/mapper.py | demo/reducer.py </div><div class="line">ä¸œ   1</div><div class="line">å—   1</div><div class="line">è¥¿   1</div><div class="line">åŒ—   1</div><div class="line">ä¸œ   1</div><div class="line">ä¸­   1</div><div class="line">ä¸œ   1</div><div class="line">å‘   1</div><div class="line">ä¸œ   1</div><div class="line">ç™½   1</div></pre></td></tr></table></figure></p>
<hr>
<h1 id="åœ¨Hadoopä¸Šè·‘ç¨‹åº"><a href="#åœ¨Hadoopä¸Šè·‘ç¨‹åº" class="headerlink" title="åœ¨Hadoopä¸Šè·‘ç¨‹åº"></a>åœ¨Hadoopä¸Šè·‘ç¨‹åº</h1><h2 id="å‡†å¤‡æµ‹è¯•æ•°æ®"><a href="#å‡†å¤‡æµ‹è¯•æ•°æ®" class="headerlink" title="å‡†å¤‡æµ‹è¯•æ•°æ®"></a>å‡†å¤‡æµ‹è¯•æ•°æ®</h2><p>æˆ‘çš„è¿è¡Œç¯å¢ƒæ˜¯åœ¨Dockerä¸Šæ­å»ºçš„ï¼Œé¦–å…ˆæˆ‘ä»¬éœ€è¦å…ˆæŠŠç”¨æ¥æµ‹è¯•çš„æ–‡ç« æ”¾åˆ°HDFSé‡Œ
<figure class="highlight console"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">root@hadoop-master:~/src/demo# hdfs dfs -put words1.txt /input</div><div class="line">root@hadoop-master:~/src/demo# hdfs dfs -ls /input</div><div class="line">Found 1 item</div><div class="line">-rw-r--r--   2 root supergroup        127 2017-09-30 03:57 /input/words1.txt</div><div class="line">root@hadoop-master:~/src/demo#</div></pre></td></tr></table></figure></p>
<p><code>words1.txt</code>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">Let me write down something trivial</div><div class="line">something that is not important</div><div class="line">something that looks like bullshit</div><div class="line">yes that is what I want</div></pre></td></tr></table></figure></p>
<p>æˆ‘å°±éšä¾¿å†™äº†å‡ å¥æ”¾åœ¨<code>words1.txt</code>é‡Œï¼Œçœ‹çœ‹è¿è¡Œç»“æœæ˜¯å¦æ­£ç¡®ã€‚</p>
<hr>
<h2 id="è¿è¡ŒMapReduce"><a href="#è¿è¡ŒMapReduce" class="headerlink" title="è¿è¡ŒMapReduce"></a>è¿è¡ŒMapReduce</h2><p>ç”¨è¿‡Javaç‰ˆHadoopçš„æœ‹å‹ï¼Œåº”è¯¥è¿˜æœ‰å°è±¡å¦‚ä½•ç¼–è¯‘è¿è¡Œå§ï¼Œå…¶å®å°±å’Œè¿è¡ŒJavaç¨‹åºçš„è¿‡ç¨‹å¾ˆåƒã€‚ä½†è¿™é‡Œç”¨Pythonæ¥æ‰§è¡Œï¼Œå°±ç¨å¾®æœ‰äº›ä¸å¤ªä¸€æ ·äº†ã€‚é¦–å…ˆæˆ‘ä»¬éœ€è¦ç”¨åˆ°ä¸€ä¸ª<code>hadoop-streaming-2.x.x.jar</code>è¿™æ ·çš„ä¸€ä¸ªå·¥å…·ï¼Œè¿™é‡Œxxä»£è¡¨ç‰ˆæœ¬å·ã€‚å®ƒçš„å…·ä½“è§£é‡Šå¯ä»¥å‚è€ƒHadoopå®˜æ–¹ç»™çš„<a href="http://hadoop.apache.org/docs/r1.2.1/streaming.html#Hadoop+Streaming" target="_blank" rel="external">Document</a>ï¼Œæˆ‘è¿™é‡Œå°±åšä¸ªç®€å•çš„ä»‹ç»ã€‚<strong>Hadoop Streaming</strong>æ˜¯Hadoopæä¾›çš„ä¸€ä¸ªå·¥å…·ï¼Œå¯ä»¥è®©ä½ ä»¥ä»»æ„çš„å¯æ‰§è¡Œç¨‹åºæˆ–è„šæœ¬ï¼Œæ¥åˆ›å»ºå’Œè¿è¡ŒMapReduceï¼Œè¿™é‡Œå®˜ç½‘ç»™äº†ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼š
<figure class="highlight console"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="meta">$</span>HADOOP_HOME/bin/hadoop  jar $HADOOP_HOME/hadoop-streaming.jar \</div><div class="line">    -input myInputDirs \</div><div class="line">    -output myOutputDir \</div><div class="line">    -mapper /bin/cat \</div><div class="line">    -reducer /bin/wc</div></pre></td></tr></table></figure></p>
<hr>
<p>ç°åœ¨ï¼Œæˆ‘ä»¬æ¥ç”¨Hadoop Streamingæ¥è¿è¡Œè‡ªå·±çš„ç¨‹åºã€‚
<figure class="highlight console"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">root@hadoop-master:~/src/demo# hadoop jar ../hadoop-streaming-2.7.2.jar \</div><div class="line"><span class="meta">&gt;</span> -input /input \</div><div class="line"><span class="meta">&gt;</span> -output /output \</div><div class="line"><span class="meta">&gt;</span> -mapper mapper.py \</div><div class="line"><span class="meta">&gt;</span> -reducer reducer.py \</div><div class="line"><span class="meta">&gt;</span> -file mapper.py \</div><div class="line"><span class="meta">&gt;</span> -file reducer.py</div></pre></td></tr></table></figure></p>
<hr>
<p>è¿™é‡Œæœ‰ä¸¤ç‚¹éœ€è¦æ³¨æ„ï¼š</p>
<ul>
<li>åé¢çš„ä¸¤ä¸ª<code>-file</code>æ˜¯å¿…é¡»è¦åŠ çš„ï¼Œå¦åˆ™ç¨‹åºæ— æ³•é¡ºåˆ©è¿è¡Œï¼›</li>
<li><code>mapper.py</code>å’Œ<code>reducer.py</code>è¦æå‰è®°å¾—èµ‹äºˆå®ƒä»¬å¯æ‰§è¡Œçš„å±æ€§ã€‚</li>
</ul>
<p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬æ¥éªŒæ”¶ä¸€ä¸‹ç¨‹åºçš„ç»“æœï¼š
<figure class="highlight console"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line">root@hadoop-master:~/src/demo# hdfs dfs -ls /output</div><div class="line">Found 2 items</div><div class="line">-rw-r--r--   2 root supergroup          0 2017-09-30 04:31 /output/_SUCCESS</div><div class="line">-rw-r--r--   2 root supergroup        128 2017-09-30 04:31 /output/part-00000</div><div class="line">root@hadoop-master:~/src/demo# hdfs dfs -cat /output/part*</div><div class="line">I   1</div><div class="line">Let 1</div><div class="line">bullshit    1</div><div class="line">down    1</div><div class="line">important   1</div><div class="line">is  2</div><div class="line">like    1</div><div class="line">looks   1</div><div class="line">me  1</div><div class="line">not 1</div><div class="line">something   3</div><div class="line">that    3</div><div class="line">trivial 1</div><div class="line">want    1</div><div class="line">what    1</div><div class="line">write   1</div><div class="line">yes 1</div><div class="line">root@hadoop-master:~/src/demo#</div></pre></td></tr></table></figure></p>
<hr>
<p>è¯•ä¸€ä¸‹å¤šæ–‡ä»¶çœ‹çœ‹æœ‰æ²¡æœ‰é—®é¢˜ï¼Œæˆ‘å°†words1.txtå¤åˆ¶å‡ºä¸€æ¨¡ä¸€æ ·çš„ä¸¤ä»½ï¼Œä¹Ÿå°±æ˜¯ç°åœ¨æœ‰ä¸‰ä»½ç›¸åŒçš„è¾“å…¥æ–‡ä»¶ï¼Œå†æ¥è·‘ä¸€éè¯•è¯•ï¼š
<figure class="highlight console"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">root@hadoop-master:~/src/demo# hdfs dfs -rm -r /output</div><div class="line">17/09/30 04:48:37 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.</div><div class="line">Deleted /output</div><div class="line">root@hadoop-master:~/src/demo# ./run_script.sh /input /output mapper.py reducer.py</div><div class="line">    </div><div class="line">Running python in Hadoop by hadoop streaming...</div></pre></td></tr></table></figure></p>
<p>è¿™é‡Œæˆ‘è‡ªå·±åšäº†<code>run_script.sh</code>è¿™æ ·å­ä¸€ä¸ªshell scriptï¼Œç”¨æ¥ç¼©çŸ­æ‰§è¡Œå‘½ä»¤çš„é•¿åº¦ï¼Œä¸ç„¶æ¯æ¬¡éƒ½è¦è¾“å…¥é‚£ä¹ˆé•¿çœŸçš„å¥½éº»çƒ¦â€¦â€¦
<figure class="highlight console"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">root@hadoop-master:~/src/demo# hdfs dfs -cat /output/part*</div><div class="line">I   3</div><div class="line">Let 3</div><div class="line">bullshit    3</div><div class="line">down    3</div><div class="line">important   3</div><div class="line">is  6</div><div class="line">like    3</div><div class="line">looks   3</div><div class="line">me  3</div><div class="line">not 3</div><div class="line">something   9</div><div class="line">that    9</div><div class="line">trivial 3</div><div class="line">want    3</div><div class="line">what    3</div><div class="line">write   3</div><div class="line">yes 3</div></pre></td></tr></table></figure></p>
<p>çœ‹ä¸Šå»æ²¡æœ‰ä»»ä½•é—®é¢˜ã€‚</p>
<hr>
<h1 id="åè®°"><a href="#åè®°" class="headerlink" title="åè®°"></a>åè®°</h1><p>æ›´å¤šçš„å…³äºHadoop Streamingçš„å†…å®¹ï¼Œè¿˜å¸Œæœ›å¤§å®¶å»å®˜ç½‘æ–‡æ¡£ä¸­æŸ¥é˜…ã€‚ä¾‹å¦‚åƒåˆ†é…mapå’Œreduceçš„æ•°é‡ï¼Œè®¾ç½®partitionerï¼Œè¿™æ ·çš„å‚æ•°éƒ½å¯ä»¥é€šè¿‡Hadoop Streamingæ¥è°ƒæ•´ï¼Œè¿˜æ˜¯å¾ˆæœ‰æ„æ€çš„ã€‚</p>
<p>åœ¨ä¸‹ä¸€ç¯‡å…³äºMapReduceçš„æ–‡ç« ä¸­æˆ‘ä¼šä»‹ç»ä¸€ä¸ªç›¸æ¯”è¾ƒäºword countå¤æ‚ä¸€ç‚¹çš„ä¾‹å­ï¼Œä¾ç„¶æ˜¯ç”¨Pythonå’ŒHadoopçš„ç»“åˆã€‚</p>
<hr>
<h1 id="Related-Links"><a href="#Related-Links" class="headerlink" title="Related Links"></a>Related Links</h1><ul>
<li><a href="http://www.michael-noll.com/tutorials/writing-an-hadoop-mapreduce-program-in-python/" target="_blank" rel="external">Writing an hadoop mapreduce program in python</a></li>
<li><a href="http://hadoop.apache.org/docs/r1.2.1/streaming.html#Hadoop+Streaming" target="_blank" rel="external">Hadoop Streaming Documentation</a></li>
</ul>
]]></content>
      
        <categories>
            
            <category> Big Data </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Python </tag>
            
            <tag> Hadoop </tag>
            
            <tag> MapReduce </tag>
            
            <tag> Docker </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Migrated from Heroku to Netlify]]></title>
      <url>/2017/09/28/Netlify/</url>
      <content type="html"><![CDATA[<p>ä¹‹å‰å­¦ä¹ ruby on railsçš„æ—¶å€™ï¼Œå¼€å§‹æ¥è§¦çš„Herokuã€‚è¿™æ¬¡éƒ¨ç½²ä¸ªäººåšå®¢ï¼Œæƒ³ç€Herokuåº”è¯¥æ˜¯ä¸ªä¸é”™çš„é€‰æ‹©å§ï¼Œä½†è¯•ç”¨äº†å‡ å¤©çš„Herokuä¹‹åï¼Œæˆ‘å†³å®šè¿˜æ˜¯è½¬åˆ°å…¶ä»–åœ°æ–¹éƒ¨ç½²æˆ‘çš„blogï¼Œä¸ºä»€ä¹ˆå‘¢ï¼ŸåŸå› æœ‰äºŒï¼š</p>
<ol>
<li>å…è´¹çš„Heroku Appï¼Œå¦‚æœæç½®æ—¶é—´é•¿äº†ä¸€ç›´æ— äººè®¿é—®çš„è¯ï¼Œå†æ¬¡è®¿é—®æ˜¯éœ€è¦ä¸€å®šæ—¶é—´ç­‰å¾…æ¿€æ´»çš„ï¼Œå°±åƒæ˜¯ç”µè„‘ç¡çœ äº†ç­‰ç€å«é†’ä¸€æ ·ã€‚ä»˜è´¹çš„è¯å¤ªè´µï¼Œå¯¹äºåªæ˜¯æ­è½½ä¸ªäººåšå®¢è€Œè¨€ä¸å¤ªåˆ’ç®—ï¼›</li>
<li>HerokuæœåŠ¡å™¨æ˜¯åœ¨ç¾å›½å’Œæ¬§æ´²ï¼Œè€Œä¸”ä¸€ä¸ªAppåªèƒ½å­˜åœ¨åœ¨æŸä¸€ä¸ªåŒºåŸŸï¼Œä¸å¯å˜ã€‚æ‰€ä»¥å¯¹äºå›½å†…çš„æœ‹å‹ï¼Œç™»å½•æˆ‘çš„åšå®¢æœ‰æ—¶ä¼šæœ‰ä¸å°çš„å»¶è¿Ÿï¼Œè™½ç„¶å¯¹äºä¸€ä¸ªé™æ€ç½‘ç«™ï¼Œæœ¬æ¥ä¹Ÿæ— éœ€å¾ˆå¿«çš„å“åº”é€Ÿåº¦ï¼Œä½†é…åˆç¬¬ä¸€æ¡ï¼Œè¿™ä¸ªæ—¶é—´æœ‰æ—¶çœŸçš„è®©äººæ— è¯­â€¦â€¦</li>
</ol>
<a id="more"></a>
<p>é‚£ä¹‹æ‰€ä»¥é€‰æ‹©Netlifyä¹Ÿæ˜¯æœ‰ä¸¤ä¸ªåŸå› ï¼š</p>
<ol>
<li>ä¸å­˜åœ¨Herokuçš„ç¬¬ä¸€ä¸ªé—®é¢˜ï¼›</li>
<li>é™æ€å†…å®¹éƒ¨ç½²é‡‡ç”¨çš„æ˜¯global CDNæ–¹å¼ï¼Œè¿™æ ·ç”¨æˆ·ç™»å½•åšå®¢çš„æ—¶å€™ä¼šæ ¹æ®ç”¨æˆ·æ‰€åœ¨åœ°é€‰å–æœ€è¿‘çš„èŠ‚ç‚¹è·å–ä¿¡æ¯ã€‚</li>
</ol>
<p>é™¤äº†è¿™ä¸¤ç‚¹ä»¥å¤–ï¼ŒNetlifyçš„è®¾ç½®ç•Œé¢ä¹Ÿåšå¾—ååˆ†ç®€æ´æ˜“ç”¨ï¼Œç›¸æ¯”Herokuè€Œè¨€ï¼Œç”šè‡³è¿éƒ¨ç½²éƒ½æ›´åŠ ç®€å•ï¼Œé™¤äº†åˆ©ç”¨gitéƒ¨ç½²ï¼Œè¿˜å¯ä»¥ç›´æ¥æŠŠç”Ÿæˆå¥½çš„é™æ€ç½‘é¡µæ–‡ä»¶å¤¹æ‹–åŠ¨åˆ°ä¸€ä¸ªéƒ¨ç½²æ¡†å†…</p>
<p><img src="/images/drag_deploy.png" alt="drag_deploy"></p>
]]></content>
      
        <categories>
            
            <category> general </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Netlify </tag>
            
            <tag> migrate </tag>
            
            <tag> Heroku </tag>
            
            <tag> static site </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Hello World]]></title>
      <url>/2017/09/26/hello-world/</url>
      <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>ç»ˆäºå°†ä¸ªäººåšå®¢æ­å»ºèµ·æ¥äº†â€¦â€¦è™½ç„¶å¬è¯´Hexoæ­å»ºåšå®¢ååˆ†å®¹æ˜“ï¼Œä½†å¯¹äºå‰ç«¯å®Œå…¨ä¸äº†è§£çš„æˆ‘ï¼Œé¢‡è´¹äº†ä¸€ç•ªåŠŸå¤«ã€‚</p>
<p>Hexoåˆå§‹åŒ–è¿™ä¸ªåšå®¢ç›®å½•æ—¶ï¼Œè‡ªå¸¦äº†ä¸€ä¸ªä»¥â€œHello Worldâ€ä¸ºæ ‡é¢˜çš„æ–‡ç« ï¼Œè€ƒè™‘åˆ°â€œHello Worldâ€æ˜¯ä½œä¸ºå­¦ä¹ ç¼–ç¨‹ä»£ç ç¬¬ä¸€è¯¾ï¼Œä½œä¸ºä¸€ä¸ªæ ‡å‡†ç å†œçš„æˆ‘å°±å†³å®šæ²¿è¢­è¿™ä¸ªä¼ ç»Ÿï¼Œ
ä»æ­¤å¼€å§‹è‡ªå·±çš„åšå®¢ä¹‹æ—…ã€‚</p>
<p><strong><em>Hello Hexo</em></strong></p>
<p><strong><em>Hello World</em></strong></p>
]]></content>
      
        <categories>
            
            <category> general </category>
            
        </categories>
        
        
        <tags>
            
            <tag> First </tag>
            
            <tag> Blog </tag>
            
        </tags>
        
    </entry>
    
  
  
</search>
