<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    
    <title>ç”¨Pythonåœ¨Hadoopä¸Šå®ç°æœç´¢è‡ªåŠ¨è¡¥å…¨ | X space</title>
    <meta name="description" content="Information -&gt; Knowledge -&gt; Wisdom" />
    <meta name="keywords" content="" />
    <meta name="HandheldFriendly" content="True" />
    <meta name="apple-mobile-web-app-capable" content="yes">
    <link rel="shortcut icon" href="/images/favicon.png">
    <link rel="alternate" href="/atom.xml" title="X space">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="description" content="è®°å¾—å¾ˆæ—©çš„æ—¶å€™ï¼Œåˆšå¼€å§‹æ¥è§¦æœç´¢å¼•æ“ï¼Œé‚£æ—¶å€™Googleè¿˜æ²¡æœ‰è¢«å¢™ï¼Œç™¾åº¦ä¹Ÿæ˜¯åˆšåˆšè¯ç”Ÿæ²¡å¤šä¹…ï¼Œæ— è®ºæˆ‘åœ¨è¾“å…¥æ¡†å†…è¾“å…¥ä»€ä¹ˆï¼Œåªæ˜¯æ˜¾ç¤ºæˆ‘è¾“å…¥çš„å†…å®¹ï¼Œå¹¶æ²¡æœ‰ä»»ä½•è”æƒ³åŠŸèƒ½æç¤ºæˆ‘æ¥ä¸‹æ¥å¯èƒ½åŒ¹é…çš„å†…å®¹ã€‚æœ‰æ—¶å€™æƒ³æ‰¾ä¸ªä¸œè¥¿ï¼Œå¯å°±æ˜¯æ­»æ´»æƒ³ä¸èµ·æ¥å‡†ç¡®çš„åå­—æˆ–è€…æè¿°æ–¹å¼ï¼Œè¿™ä¸ªæ—¶å€™æœç´¢å¼•æ“ä¹Ÿå¸®ä¸äº†ä½ ï¼Œä½ åªèƒ½å˜ç€æ³•çš„å°è¯•å„ç§è¾“å…¥ï¼Œæ¥å¯»æ±‚æœ€ç»ˆä½ æƒ³è¦çš„ç»“æœã€‚åæ¥æœç´¢å¼•æ“åŠ å…¥äº†è”æƒ³åŠŸèƒ½ï¼Œè¿™ç€å®æ˜¯ä¸€å¤§è¿›æ­¥ï¼Œæå¤§åœ°æé«˜äº†æœç´¢æ•ˆç‡ã€‚æœ‰çš„æ—¶">
<meta name="keywords" content="Python,Hadoop,MapReduce">
<meta property="og:type" content="article">
<meta property="og:title" content="ç”¨Pythonåœ¨Hadoopä¸Šå®ç°æœç´¢è‡ªåŠ¨è¡¥å…¨">
<meta property="og:url" content="http://yuannow.com/2017/10/09/Implement-Search-Auto-Complete-by-Python-Hadoop/index.html">
<meta property="og:site_name" content="X space">
<meta property="og:description" content="è®°å¾—å¾ˆæ—©çš„æ—¶å€™ï¼Œåˆšå¼€å§‹æ¥è§¦æœç´¢å¼•æ“ï¼Œé‚£æ—¶å€™Googleè¿˜æ²¡æœ‰è¢«å¢™ï¼Œç™¾åº¦ä¹Ÿæ˜¯åˆšåˆšè¯ç”Ÿæ²¡å¤šä¹…ï¼Œæ— è®ºæˆ‘åœ¨è¾“å…¥æ¡†å†…è¾“å…¥ä»€ä¹ˆï¼Œåªæ˜¯æ˜¾ç¤ºæˆ‘è¾“å…¥çš„å†…å®¹ï¼Œå¹¶æ²¡æœ‰ä»»ä½•è”æƒ³åŠŸèƒ½æç¤ºæˆ‘æ¥ä¸‹æ¥å¯èƒ½åŒ¹é…çš„å†…å®¹ã€‚æœ‰æ—¶å€™æƒ³æ‰¾ä¸ªä¸œè¥¿ï¼Œå¯å°±æ˜¯æ­»æ´»æƒ³ä¸èµ·æ¥å‡†ç¡®çš„åå­—æˆ–è€…æè¿°æ–¹å¼ï¼Œè¿™ä¸ªæ—¶å€™æœç´¢å¼•æ“ä¹Ÿå¸®ä¸äº†ä½ ï¼Œä½ åªèƒ½å˜ç€æ³•çš„å°è¯•å„ç§è¾“å…¥ï¼Œæ¥å¯»æ±‚æœ€ç»ˆä½ æƒ³è¦çš„ç»“æœã€‚åæ¥æœç´¢å¼•æ“åŠ å…¥äº†è”æƒ³åŠŸèƒ½ï¼Œè¿™ç€å®æ˜¯ä¸€å¤§è¿›æ­¥ï¼Œæå¤§åœ°æé«˜äº†æœç´¢æ•ˆç‡ã€‚æœ‰çš„æ—¶">
<meta property="og:locale" content="zh-CN">
<meta property="og:image" content="http://yuannow.com/images/autocomplete/autocomplete.png">
<meta property="og:image" content="http://yuannow.com/images/autocomplete/database.png">
<meta property="og:image" content="http://yuannow.com/images/autocomplete/ggif.gif">
<meta property="og:updated_time" content="2017-10-10T09:12:39.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="ç”¨Pythonåœ¨Hadoopä¸Šå®ç°æœç´¢è‡ªåŠ¨è¡¥å…¨">
<meta name="twitter:description" content="è®°å¾—å¾ˆæ—©çš„æ—¶å€™ï¼Œåˆšå¼€å§‹æ¥è§¦æœç´¢å¼•æ“ï¼Œé‚£æ—¶å€™Googleè¿˜æ²¡æœ‰è¢«å¢™ï¼Œç™¾åº¦ä¹Ÿæ˜¯åˆšåˆšè¯ç”Ÿæ²¡å¤šä¹…ï¼Œæ— è®ºæˆ‘åœ¨è¾“å…¥æ¡†å†…è¾“å…¥ä»€ä¹ˆï¼Œåªæ˜¯æ˜¾ç¤ºæˆ‘è¾“å…¥çš„å†…å®¹ï¼Œå¹¶æ²¡æœ‰ä»»ä½•è”æƒ³åŠŸèƒ½æç¤ºæˆ‘æ¥ä¸‹æ¥å¯èƒ½åŒ¹é…çš„å†…å®¹ã€‚æœ‰æ—¶å€™æƒ³æ‰¾ä¸ªä¸œè¥¿ï¼Œå¯å°±æ˜¯æ­»æ´»æƒ³ä¸èµ·æ¥å‡†ç¡®çš„åå­—æˆ–è€…æè¿°æ–¹å¼ï¼Œè¿™ä¸ªæ—¶å€™æœç´¢å¼•æ“ä¹Ÿå¸®ä¸äº†ä½ ï¼Œä½ åªèƒ½å˜ç€æ³•çš„å°è¯•å„ç§è¾“å…¥ï¼Œæ¥å¯»æ±‚æœ€ç»ˆä½ æƒ³è¦çš„ç»“æœã€‚åæ¥æœç´¢å¼•æ“åŠ å…¥äº†è”æƒ³åŠŸèƒ½ï¼Œè¿™ç€å®æ˜¯ä¸€å¤§è¿›æ­¥ï¼Œæå¤§åœ°æé«˜äº†æœç´¢æ•ˆç‡ã€‚æœ‰çš„æ—¶">
<meta name="twitter:image" content="http://yuannow.com/images/autocomplete/autocomplete.png">
    
    <link href="https://fonts.googleapis.com/css?family=Inconsolata|Titillium+Web" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Roboto+Mono" rel="stylesheet">
    <link href='//cdn.bootcss.com/node-waves/0.7.5/waves.min.css' rel='stylesheet'>
    <link rel="stylesheet" href="/style.css">
    <script>
      function setLoadingBarProgress(num) {
        document.getElementById('loading-bar').style.width=num+"%";
      }
    </script>
    
      <!-- Global Site Tag (gtag.js) - Google Analytics -->
      <script async src="https://www.googletagmanager.com/gtag/js?id=UA-107727758-1"></script>
      <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'UA-107727758-1');
      </script>
    
  </head>
<body>
  <div id="loading-bar-wrapper">
  <div id="loading-bar"></div>
</div>


  <script>setLoadingBarProgress(20)</script> 
  <header class="l_header">
	<div class='wrapper'>
		<div class="nav-main container container--flex">
			<a class="logo flat-box" href='/' >
				X space
			</a>
			<div class='menu'>
				<ul class='h-list'>
					
						<li>
							<a class='flat-box nav-home' href='/'>
								Home
							</a>
						</li>
					
						<li>
							<a class='flat-box nav-archives' href='/archives'>
								Archives
							</a>
						</li>
					
						<li>
							<a class='flat-box nav-gallery' href='/gallary'>
								Gallery
							</a>
						</li>
					
						<li>
							<a class='flat-box nav-about' href='/about'>
								About
							</a>
						</li>
					
				</ul>
				<div class='underline'></div>
			</div>
			
				<div class="m_search">
					<form name="searchform" class="form u-search-form">
						<input type="text" class="input u-search-input" placeholder="Search" />
						<span class="icon icon-search"></span>
					</form>
				</div>
			
			<ul class='switcher h-list'>
				
					<li class='s-search'><a href='javascript:void(0)'><span class="icon icon-search flat-box"></span></a></li>
				
				<li class='s-menu'><a href='javascript:void(0)'><span class="icon icon-menu flat-box"></span></a></li>
			</ul>
		</div>
		
		<div class='nav-sub container container--flex'>
			<a class="logo" class="flat-box" href='javascript:void(0)'>
				Word of Forks
			</a>

			<ul class='switcher h-list'>
				<li class='s-comment'><a href='javascript:void(0)'><span class="icon icon-chat_bubble_outline flat-box"></span></a></li>
				<li class='s-top'><a href='javascript:void(0)'><span class="icon icon-arrow_upward flat-box"></span></a></li>
				<li class='s-toc'><a href='javascript:void(0)'><span class="icon icon-format_list_numbered flat-box"></span></a></li>
			</ul>
		</div>
	</div>
</header>
<aside class="menu-phone">
	<nav>
		
			<a href="/" class="nav-home nav">
				Home
			</a>
		
			<a href="/archives" class="nav-archives nav">
				Archives
			</a>
		
			<a href="/gallary" class="nav-gallery nav">
				Gallery
			</a>
		
			<a href="/about" class="nav-about nav">
				About
			</a>
		
	</nav>
</aside>

    <script>setLoadingBarProgress(40);</script>
  <div class="l_body">
    <div class='container clearfix'>
      <div class='l_main'>
        <article id="post-Implement-Search-Auto-Complete-by-Python-Hadoop" class="post white-box article-type-post" itemscope itemprop="blogPost">
    <section class='meta'>
        <h2 class="title">
            <a href="/2017/10/09/Implement-Search-Auto-Complete-by-Python-Hadoop/">
                ç”¨Pythonåœ¨Hadoopä¸Šå®ç°æœç´¢è‡ªåŠ¨è¡¥å…¨
            </a>
        </h2>
        <time>
	  10æœˆ 9, 2017
	</time>
        
    
    <div class='cats'>
        <a href="/categories/Big-Data/">Big Data</a>
    </div>

    </section>
    
        <section class="toc-wrapper">
            <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#æœ¬æ–‡ç›®çš„"><span class="toc-number">1.</span> <span class="toc-text">æœ¬æ–‡ç›®çš„</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#æ­£æ–‡"><span class="toc-number">2.</span> <span class="toc-text">æ­£æ–‡</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#N-Gram"><span class="toc-number">2.1.</span> <span class="toc-text">N-Gram</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MapReduceå®ç°"><span class="toc-number">2.2.</span> <span class="toc-text">MapReduceå®ç°</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#N-Gramæ¨¡å‹æ„å»º"><span class="toc-number">2.2.1.</span> <span class="toc-text">N-Gramæ¨¡å‹æ„å»º</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#N-Gramæµ‹è¯•ç»“æœ"><span class="toc-number">2.2.2.</span> <span class="toc-text">N-Gramæµ‹è¯•ç»“æœ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#æ„å»ºé¢„æµ‹æ¦‚ç‡çš„æ¨¡å‹"><span class="toc-number">2.2.3.</span> <span class="toc-text">æ„å»ºé¢„æµ‹æ¦‚ç‡çš„æ¨¡å‹</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#é¢„æµ‹æ¦‚ç‡çš„æµ‹è¯•ç»“æœ"><span class="toc-number">2.2.4.</span> <span class="toc-text">é¢„æµ‹æ¦‚ç‡çš„æµ‹è¯•ç»“æœ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#è¿è¡Œåœ¨Hadoopä¸Š"><span class="toc-number">2.2.5.</span> <span class="toc-text">è¿è¡Œåœ¨Hadoopä¸Š</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#å¯¼å…¥æ•°æ®åº“"><span class="toc-number">2.3.</span> <span class="toc-text">å¯¼å…¥æ•°æ®åº“</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#å±•ç¤ºç»“æœ"><span class="toc-number">2.4.</span> <span class="toc-text">å±•ç¤ºç»“æœ</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#æ€»ç»“"><span class="toc-number">3.</span> <span class="toc-text">æ€»ç»“</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Related-Links"><span class="toc-number">4.</span> <span class="toc-text">Related Links</span></a></li></ol>
        </section>
        
            <section class="article typo">
                <div class="article-entry" itemprop="articleBody">
                    <p><img src="/images/autocomplete/autocomplete.png" alt="search autocomplete">
è®°å¾—å¾ˆæ—©çš„æ—¶å€™ï¼Œåˆšå¼€å§‹æ¥è§¦æœç´¢å¼•æ“ï¼Œé‚£æ—¶å€™Googleè¿˜æ²¡æœ‰è¢«å¢™ï¼Œç™¾åº¦ä¹Ÿæ˜¯åˆšåˆšè¯ç”Ÿæ²¡å¤šä¹…ï¼Œæ— è®ºæˆ‘åœ¨è¾“å…¥æ¡†å†…è¾“å…¥ä»€ä¹ˆï¼Œåªæ˜¯æ˜¾ç¤ºæˆ‘è¾“å…¥çš„å†…å®¹ï¼Œå¹¶æ²¡æœ‰ä»»ä½•è”æƒ³åŠŸèƒ½æç¤ºæˆ‘æ¥ä¸‹æ¥å¯èƒ½åŒ¹é…çš„å†…å®¹ã€‚æœ‰æ—¶å€™æƒ³æ‰¾ä¸ªä¸œè¥¿ï¼Œå¯å°±æ˜¯æ­»æ´»æƒ³ä¸èµ·æ¥å‡†ç¡®çš„åå­—æˆ–è€…æè¿°æ–¹å¼ï¼Œè¿™ä¸ªæ—¶å€™æœç´¢å¼•æ“ä¹Ÿå¸®ä¸äº†ä½ ï¼Œä½ åªèƒ½å˜ç€æ³•çš„å°è¯•å„ç§è¾“å…¥ï¼Œæ¥å¯»æ±‚æœ€ç»ˆä½ æƒ³è¦çš„ç»“æœã€‚åæ¥æœç´¢å¼•æ“åŠ å…¥äº†è”æƒ³åŠŸèƒ½ï¼Œè¿™ç€å®æ˜¯ä¸€å¤§è¿›æ­¥ï¼Œæå¤§åœ°æé«˜äº†æœç´¢æ•ˆç‡ã€‚æœ‰çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯¹äºæƒ³æŸ¥è¯¢çš„æŸä¸€é—®é¢˜çš„æé—®æ–¹å¼æ˜¯å¾ˆæ¨¡ç³Šçš„ï¼Œè¿™ä¸ªæ—¶å€™å½“ä½ è¾“å…¥äº†ä¸€äº›å…³é”®è¯ï¼Œå‘ç°æœç´¢å¼•æ“ä¼šæ ¹æ®ä½ çš„è¾“å…¥ç»™ä½ ä¸€äº›åç»­å†…å®¹çš„å»ºè®®ï¼Œä¼šè®©ä½ æ›´å®¹æ˜“çš„æ‰¾åˆ°è‡ªå·±æƒ³è¦çš„ç­”æ¡ˆã€‚</p>
<h1 id="æœ¬æ–‡ç›®çš„"><a href="#æœ¬æ–‡ç›®çš„" class="headerlink" title="æœ¬æ–‡ç›®çš„"></a>æœ¬æ–‡ç›®çš„</h1><p>ä¸Šä¸€ç¯‡æˆ‘åœ¨ã€Šç”¨Pythonåœ¨Hadoopä¸Šè·‘MapReduceã€‹ä¸­ä»‹ç»äº†ä¸€äº›å…³äºå¦‚ä½•åˆ©ç”¨<code>Hadoop Streaming</code>è¿è¡ŒPythonç‰ˆMapReduceçš„ç®€å•æ“ä½œï¼Œå¦‚ä½•å®ç°è¯é¢‘ç»Ÿè®¡å°±åƒæ˜¯MapReduceä¸­çš„<em>Hello World</em>ï¼Œä¸è¿‡åšå®Œäº†å…¥é—¨æ•™ç¨‹ï¼Œä¸ºäº†æ·±å…¥å­¦ä¹ ï¼Œè¿˜å¾—éœ€è¦æ›´å¤šçš„ç»ƒä¹ ã€‚</p>
<p>åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘å°†ä¼šå¸¦å„ä½å®ç°ä¸€ä¸ªå¾ˆç®€å•çš„æœç´¢è”æƒ³åŠŸèƒ½ï¼Œæ¯”è¾ƒç²—ç³™ï¼Œä½†æ˜¯çœ‹èµ·æ¥ä¹ŸæŒºåƒé‚£ä¹ˆå›äº‹çš„~</p>
<a id="more"></a>
<hr>
<h1 id="æ­£æ–‡"><a href="#æ­£æ–‡" class="headerlink" title="æ­£æ–‡"></a>æ­£æ–‡</h1><p>ä¸ºäº†å®ç°<code>autocomplete</code>ï¼Œé¦–å…ˆéœ€è¦ææ¸…æ¥šå®ƒèƒŒåçš„åŸç†ï¼Œæœç´¢å¼•æ“ç©¶ç«Ÿæ˜¯æ ¹æ®ä»€ä¹ˆæ¥ç»™å‡ºæç¤ºçš„ï¼Ÿæ¯”å¦‚æˆ‘è¾“å…¥ä¸€ä¸ª<code>autocomplete</code>ä¹‹åï¼Œä¸ºä»€ä¹ˆåé¢æ¨èçš„æ˜¯<em>python</em>ï¼Œ<em>algorithm</em>ä¹‹ç±»çš„ï¼Œè€Œä¸æ˜¯<em>Naruto</em>ï¼Œ<em>One Piece</em>è¿™äº›å‘¢ï¼Ÿ</p>
<p>æ— è®ºæ˜¯ç™¾åº¦è¿˜æ˜¯è°·æ­Œï¼Œå…¶å®åœ¨å¤§å®¶ç”¨å®ƒä»¬çš„æœç´¢å¼•æ“æ”¶é›†ä½ éœ€è¦çš„ä¿¡æ¯çš„æ—¶å€™ï¼Œå®ƒä»¬ä¹ŸåŒæ ·åœ¨æ”¶é›†ä¿¡æ¯ã€‚å®ƒä»¬æ”¶é›†äº†å¤§é‡çš„ç”¨æˆ·æœç´¢çš„è¾“å…¥ä¿¡æ¯ï¼ŒåŒæ—¶è¿˜åœ¨æŠ“å–å„ç§ç½‘é¡µå†…å®¹çš„ä¿¡æ¯ï¼Œç®€å•æ¥è¯´ï¼Œæœç´¢å¼•æ“é€šè¿‡æŸç§ç®—æ³•å°†å„ç§æ”¶é›†åˆ°çš„èµ„æ–™ç»¼åˆåˆ°ä¸€èµ·ï¼Œæœ€ç»ˆç»™å‡ºäº†ä¸€ä¸ªè¾“å…¥è”æƒ³çš„åˆ—è¡¨ï¼Œè¿™å°±æ˜¯è‡ªåŠ¨è¡¥å…¨åŠŸèƒ½ã€‚</p>
<p>ç§ä¸‹é‡Œä½œä¸ºå­¦ä¹ MapReduceçš„é¡¹ç›®ï¼Œæˆ‘ä»¬è‚¯å®šä¸å¯èƒ½å»è¯•å›¾å®ç°çœŸæ­£çš„æœç´¢å¼•æ“ã€‚ä¸è¿‡åšä¸€ä¸ªç®€é™‹ç‰ˆçš„ï¼Œå¸®åŠ©è‡ªå·±ç†è§£<code>autocomplete</code>èƒŒåçš„å®ç°åŸç†ï¼Œä»¥åŠå¦‚ä½•åˆ©ç”¨MapReduceæ¥å®ç°ï¼Œä¹Ÿæ˜¯è¶³å¤Ÿçš„ã€‚</p>
<hr>
<h2 id="N-Gram"><a href="#N-Gram" class="headerlink" title="N-Gram"></a>N-Gram</h2><p>å¯¹äºautocompleteèƒŒåå®ç°çš„åŸç†ï¼Œå¾ˆé‡è¦çš„ä¸€ç‚¹å°±æ˜¯N-Gramï¼Œ<a href="http://blog.sciencenet.cn/blog-713101-797384.html" target="_blank" rel="external">è¿™ç¯‡æ–‡ç« </a>æœ‰ç®€æ˜çš„ä»‹ç»ï¼Œä¸¾ä¸ªä¾‹å­å¥½äº†ï¼š<code>implement search autocomplete in python</code></p>
<ul>
<li>è¿™å¥è¯å¦‚æœæŒ‰2-Gramåˆ’åˆ†çš„è¯ï¼Œå°±æ˜¯<code>implement search</code>ï¼Œ<code>search autocomplete</code>ï¼Œ<code>autocomplete in</code>ï¼Œ<code>in python</code>ï¼›</li>
<li>é‚£ä¹ˆæŒ‰ç…§3-Gramåˆ’åˆ†çš„è¯ï¼Œå°±æ˜¯<code>implement search autocomplete</code>ï¼Œ<code>search autocomplete in</code>ï¼Œ<code>autocomplete in python</code>ï¼›</li>
<li>æŒ‰ç…§4-Gramåˆ’åˆ†çš„è¯ï¼Œå°±æ˜¯<code>implement search autocomplete in</code>ï¼Œ<code>search autocomplete in python</code>ï¼›</li>
<li>æŒ‰ç…§5-Gramåˆ’åˆ†çš„è¯ï¼Œå°±æ˜¯ä¸€æ•´å¥è¯ï¼Œä¸ä½œä»»ä½•åˆ‡å‰²ã€‚</li>
</ul>
<p>è¿™é‡Œæˆ‘æ²¡æœ‰ç»™å‡º1-Gramçš„ä¾‹å­ï¼Œå„ä½å¯ä»¥æ€è€ƒä¸€ä¸‹æ˜¯ä¸ºä»€ä¹ˆï¼Œè¿™é‡Œå…ˆå–ä¸ªå…³å­ï¼Œä¸‹é¢ä¼šæåˆ°åŸå› ã€‚è¿™é‡Œæˆ‘ä»¬å…ˆå›å¤´æ€è€ƒä¸€ä¸‹æœç´¢å¼•æ“ç»™å‡ºçš„è”æƒ³è¯æ±‡ï¼Œæ¯”å¦‚æˆ‘è¾“å…¥äº†ä¸€ä¸ª<code>autocomplete</code>ï¼Œé‚£ä¹ˆåé¢ä½ è§‰å¾—æ˜¯ç»™å‡º<code>in python</code>çœ‹ä¸Šå»æ›´è‡ªç„¶è¿˜æ˜¯<code>Transformer</code>æ›´åˆç†ï¼Ÿæ˜¾ç„¶æ˜¯å‰è€…å¯¹ä¹ˆï¼Œå¦‚æœç»™å‡ºäº†åè€…ï¼Œä½ å¯èƒ½ä¼šæƒ³ï¼š<code>autocomplete Transformer</code>æ˜¯ä»€ä¹ˆé¬¼ï¼Ÿï¼éš¾é“æ˜¯æŸç§æ–°å‹å˜å½¢é‡‘åˆšä¹ˆï¼Ÿæ²¡å¬è¿‡å•Šï¼é‚£ä¹‹æ‰€ä»¥ä¼šæœ‰è¿™æ ·çš„æ„Ÿè§‰ï¼Œæ˜¯å› ä¸ºä»æˆ‘ä»¬å¹³æ—¶è·å–çš„ä¿¡æ¯ä¸­ï¼Œæˆ‘ä»¬å¯¹äº<code>autocomplete</code>è¿™ä¸ªè¯åé¢çš„è¡”æ¥è¯æ¥æ”¶åˆ°çš„ä¹Ÿæ˜¯<code>in python</code>è¿œè¿œå¤šäº<code>Transformer</code>ï¼Œå¯¹å§ï¼Ÿæ‰€ä»¥è¯´åˆ°è¿™é‡Œå°±å¤§æ¦‚æœ‰ç‚¹æ˜æ™°äº†ï¼Œæœç´¢å¼•æ“å¯¹äºè”æƒ³è¯æ±‡çš„æ¨èä¹Ÿæœ‰è¿™æ–¹é¢çš„è€ƒè™‘ï¼Œæˆ‘ä»¬ç»™è¾“å…¥ä¸€ä¸ªæˆ–å¤šä¸ªå¼•å¯¼è¯ï¼Œ<code>autocomplete</code>åŠŸèƒ½å°†åé¢æœ€æœ‰å¯èƒ½å‡ºç°çš„å‡ ç§é€‰æ‹©å±•ç°ç»™æˆ‘ä»¬ã€‚æ‰€ä»¥è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆç”¨åˆ°N-Gramçš„åŸå› ï¼Œè¿™é‡Œå…¶å®å°±æ˜¯ä¸€ä¸ªå¥å­åˆ†å‰²çš„è¿‡ç¨‹ã€‚</p>
<p>é‚£ä¹ˆè¿™é‡Œå°±å¼•å‡ºäº†ä¸‹ä¸€ä¸ªé—®é¢˜ï¼šæ˜¯è¯¥åŸºäºä¸€å¥è¯æœ€åä¸€ä¸ªè¯æ¥é¢„æµ‹åé¢çš„æ¨èï¼Œè¿˜æ˜¯æ ¹æ®æ›´å¤šçš„è¯ç”šè‡³ä¸€æ•´å¥æ¥é¢„æµ‹ä¸‹é¢çš„å‡ºç°å‘¢ï¼Ÿ</p>
<p>è¿˜ç»§ç»­ä»¥ä¸Šé¢çš„ä¾‹å­è¯´å¥½äº†ã€‚å‡è®¾æˆ‘å·²ç»è¾“å…¥äº†<code>implement search autocomplete in</code>ï¼Œå¦‚æœæ˜¯æŒ‰ç…§æœ€åä¸€ä¸ªå‡ºç°çš„è¯æ¥è¿›è¡Œè”æƒ³ï¼Œé‚£ä¹ˆ<code>in</code>åé¢å…¶å®å¯ä»¥è·Ÿå¾ˆå¤šå¾ˆå¤šå†…å®¹ï¼Œéƒ½ä¸ä¼šè¿å’Œï¼Œå¯¹å§ï¼Ÿæ¯”å¦‚<code>in box</code>ï¼Œ<code>in air</code>ï¼Œ<code>in heart</code>ç­‰ç­‰ï¼Œä½†å¦‚æœæŠŠè¿™äº›è”æƒ³æ”¾åˆ°ä¸€æ•´å¥ä¸­ï¼Œæ˜¾ç„¶æ˜¯ä¸å¤ªåˆç†çš„ã€‚å› æ­¤ï¼Œæˆ‘ä»¬åœ¨å®ç°<code>autocomplete</code>çš„æ—¶å€™ï¼Œå…¶å®æ˜¯<strong>åŸºäºN-Gramé¢„æµ‹N-Gram</strong>ã€‚</p>
<p>é‚£åˆ°è¿™é‡Œï¼Œå…¶å®<code>autocomplete</code>çš„å®ç°çš„å¤§è‡´æ€è·¯å°±åº”è¯¥æœ‰äº†ã€‚æˆ‘ä»¬éœ€è¦å°†å¤§æ‰¹é‡çš„æ–‡æ¡£ç”¨N-Gramçš„å¤„ç†æ–¹å¼è¿›è¡Œåˆ‡å‰²ï¼Œç»Ÿè®¡ç›¸åŒçŸ­è¯­å‡ºç°çš„é¢‘æ¬¡ï¼Œæ„å»ºN-Gramçš„æ¨¡å‹ï¼Œç„¶åæ‰¾å‡ºæ¯ä¸ªçŸ­è¯­ä¹‹åå‡ºç°é¢‘æ¬¡æœ€é«˜çš„å‡ ä¸ªè¯æ±‡ä½œä¸ºé¢„æµ‹ä¿å­˜ä¸‹æ¥ã€‚æœ€ç»ˆå°†ç»“æœå­˜å…¥æ•°æ®åº“ï¼Œä»¥æ–¹ä¾¿ä¹‹åè°ƒç”¨ã€‚ä¸‹é¢æˆ‘ä»¬å°±æ¥çœ‹çœ‹å¦‚ä½•ä¸€æ­¥æ­¥å…·ä½“å®ç°ã€‚</p>
<hr>
<h2 id="MapReduceå®ç°"><a href="#MapReduceå®ç°" class="headerlink" title="MapReduceå®ç°"></a>MapReduceå®ç°</h2><h3 id="N-Gramæ¨¡å‹æ„å»º"><a href="#N-Gramæ¨¡å‹æ„å»º" class="headerlink" title="N-Gramæ¨¡å‹æ„å»º"></a>N-Gramæ¨¡å‹æ„å»º</h3><p>åœ¨è¿™æ¬¡çš„ä»£ç å®ç°ä¸­ï¼Œæˆ‘ä»¬éœ€è¦ç”¨åˆ°ä¸¤ä¸ªmapperå’Œreducerã€‚é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦ä¸€å¯¹mapperå’Œreducerå°†è¾“å…¥çš„æ–‡æ¡£è¿›è¡Œåˆ‡å‰²ã€‚</p>
<p><code>n_gram_mapper.py</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> sys</div><div class="line"><span class="keyword">import</span> string</div><div class="line"><span class="keyword">import</span> re</div><div class="line">    </div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">(N_Gram)</span>:</span></div><div class="line">    <span class="keyword">for</span> line <span class="keyword">in</span> sys.stdin:</div><div class="line">        <span class="comment"># å»é™¤æ‰€æœ‰çš„æ ‡ç‚¹ç¬¦å·</span></div><div class="line">        translator = str.maketrans(string.punctuation, <span class="string">" "</span> * len(string.punctuation))</div><div class="line">        line = line.translate(translator).strip().lower()</div><div class="line">        </div><div class="line">        <span class="comment"># å»é™¤æ‰€æœ‰çš„æ•°å­—</span></div><div class="line">        line = re.sub(<span class="string">"\d"</span>, <span class="string">" "</span>, line)</div><div class="line">        </div><div class="line">        <span class="comment"># æŒ‰ç…§ç©ºæ ¼æˆ–è€…\tæ¥åˆ‡å‰²</span></div><div class="line">        words = re.split(<span class="string">"\\s+"</span>, line)</div><div class="line">        <span class="keyword">if</span> len(words) &lt; <span class="number">2</span>:</div><div class="line">            <span class="keyword">continue</span></div><div class="line">            </div><div class="line">        <span class="keyword">for</span> i, word <span class="keyword">in</span> enumerate(words):</div><div class="line">            result = word</div><div class="line">            <span class="keyword">for</span> j, next_word <span class="keyword">in</span> enumerate(words[i+<span class="number">1</span>:], <span class="number">1</span>):</div><div class="line">                <span class="keyword">if</span> j &lt; N_Gram:</div><div class="line">                    result += <span class="string">" "</span></div><div class="line">                    result += next_word</div><div class="line">                    print(<span class="string">"&#123;&#125;\t&#123;&#125;"</span>.format(result, <span class="number">1</span>))</div><div class="line">                    </div><div class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</div><div class="line">    main(<span class="number">5</span>)</div></pre></td></tr></table></figure>
<p>å¦‚æœä½ æƒ³æ„å»ºä¸€ä¸ª<strong>N=5</strong>çš„N-Gramæ¨¡å‹ï¼Œé‚£ä¹ˆåœ¨mapperé‡Œï¼Œå°±éœ€è¦å°†2åˆ°5çš„åˆ†å‰²æ–¹å¼éƒ½è¾“å‡ºã€‚è¿˜è®°å¾—ä¸Šé¢æˆ‘æœ‰ç•™ä¸€ä¸ªæ‚¬å¿µï¼Œä¸ºä»€ä¹ˆä¸è€ƒè™‘1-Gramä¹ˆï¼Ÿå› ä¸ºæ˜¾ç„¶1-Gramæ˜¯æ²¡æœ‰ç”¨çš„ï¼Œå®ƒå¹¶ä¸èƒ½å‘Šè¯‰æˆ‘ä¸€ä¸ªçŸ­è¯­åé¢å¯èƒ½å‡ºç°çš„è¯æœ‰ä»€ä¹ˆã€‚</p>
<p><code>n_gram_reducer.py</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> sys</div><div class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> groupby</div><div class="line"><span class="keyword">from</span> operator <span class="keyword">import</span> itemgetter</div><div class="line">    </div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">parse_output</span><span class="params">(std_input)</span>:</span></div><div class="line">    <span class="comment"># åˆ©ç”¨generatorèŠ‚çœMapReduceå†…å­˜ä½¿ç”¨ç©ºé—´</span></div><div class="line">    <span class="keyword">for</span> line <span class="keyword">in</span> std_input:</div><div class="line">        <span class="keyword">yield</span> line.strip().split(<span class="string">"\t"</span>)</div><div class="line">        </div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></div><div class="line">    data = parse_output(sys.stdin)</div><div class="line">    <span class="keyword">for</span> word, group <span class="keyword">in</span> groupby(data, itemgetter(<span class="number">0</span>)):</div><div class="line">        <span class="keyword">try</span>:</div><div class="line">            total_count = sum(int(count) <span class="keyword">for</span> word, count <span class="keyword">in</span> group)</div><div class="line">            print(<span class="string">"&#123;&#125;\t&#123;&#125;"</span>.format(word, total_count))</div><div class="line">        <span class="keyword">except</span> ValueError:</div><div class="line">            <span class="keyword">continue</span></div><div class="line">            </div><div class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</div><div class="line">    main()</div></pre></td></tr></table></figure>
<p>è¿™å›çš„reduceræˆ‘ç”¨åˆ°äº†<code>generator</code>æ¥è°ƒç”¨æ•°æ®ï¼Œè¿™æ ·åšå¯ä»¥æœ‰æ•ˆèŠ‚çœå†…å­˜å ç”¨ç©ºé—´ã€‚å› ä¸ºéšç€è¾“å…¥æ•°æ®é‡çš„è¶Šæ¥è¶Šå¤§ï¼Œå³ä¾¿æ˜¯5-Gramï¼Œä¾ç„¶ä¹Ÿæ˜¯ä¸ªå¾ˆåºå¤§çš„è®°å½•æ•°é‡ã€‚ä¸‹é¢çš„ä¸»å‡½æ•°éƒ¨åˆ†ï¼Œæˆ‘ä¹Ÿæ”¾å¼ƒäº†ä¹‹å‰çš„ç®€å•ç”¨æ³•ï¼Œç”¨groupbyå¯ä»¥æ˜æ˜¾æå‡ä»£ç çš„é˜…è¯»é€»è¾‘ï¼Œå¯¹<code>itertools.groupby</code>ä¸å¤ªç†Ÿæ‚‰çš„æœ‹å‹å¯ä»¥çœ‹<a href="https://docs.python.org/3/library/itertools.html" target="_blank" rel="external">è¿™ä»½å®˜æ–¹æ–‡æ¡£</a>ã€‚</p>
<h3 id="N-Gramæµ‹è¯•ç»“æœ"><a href="#N-Gramæµ‹è¯•ç»“æœ" class="headerlink" title="N-Gramæµ‹è¯•ç»“æœ"></a>N-Gramæµ‹è¯•ç»“æœ</h3><p>åšä¸‹ä¸€æ­¥ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆæ¥æœ¬åœ°æµ‹è¯•ä¸€ä¸‹è¿™ä¸€å¯¹mapperå’Œreduceræ˜¯å¦å¥½ç”¨ã€‚</p>
<p>æµ‹è¯•æ–‡æ¡£ï¼šæˆ‘ç›´æ¥æŠŠ<a href="https://en.wikipedia.org/wiki/MapReduce" target="_blank" rel="external">MapReduce</a>çš„Wikié‡Œå¤´ä¸€æ®µå…³äºå®ƒçš„è¯´æ˜è§£é‡Šï¼Œç²˜è´´ä¸‹æ¥ä½œä¸ºæµ‹è¯•æ–‡æ¡£ç”¨ã€‚
<figure class="highlight console"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line">root@hadoop:~/src/p2py# cat input/file2.txt | ./n_gram_mapper.py | sort | ./n_gram_reducer.py</div><div class="line">a cluster	1</div><div class="line">a good	1</div><div class="line">a good mapreduce	1</div><div class="line">a good mapreduce algorithm	1</div><div class="line">a map	1</div><div class="line">a map procedure	1</div><div class="line">a map procedure method	1</div><div class="line">a map procedure method that	1</div><div class="line">a mapreduce	1</div><div class="line">a mapreduce program	1</div><div class="line">a mapreduce program is	1</div><div class="line">a mapreduce program is composed	1</div><div class="line">...</div><div class="line">and reduce	3</div><div class="line">and reduce capabilities	1</div><div class="line">and reduce functions	2</div><div class="line">...</div><div class="line">map and	3</div><div class="line">map and reduce	3</div><div class="line">map and reduce capabilities	1</div><div class="line">map and reduce functions	2</div><div class="line">...</div></pre></td></tr></table></figure></p>
<p>æˆ‘è¿™é‡Œå°±æˆªå–ä¸€éƒ¨åˆ†ç»“æœï¼Œå®åœ¨å¤ªé•¿äº†â€¦â€¦</p>
<h3 id="æ„å»ºé¢„æµ‹æ¦‚ç‡çš„æ¨¡å‹"><a href="#æ„å»ºé¢„æµ‹æ¦‚ç‡çš„æ¨¡å‹" class="headerlink" title="æ„å»ºé¢„æµ‹æ¦‚ç‡çš„æ¨¡å‹"></a>æ„å»ºé¢„æµ‹æ¦‚ç‡çš„æ¨¡å‹</h3><p>æˆ‘ä»¬ç°åœ¨å·²ç»æœ‰äº†N-Gramåˆ‡å‰²åçš„ç»“æœäº†ï¼Œä¸‹ä¸€æ­¥å°±æ˜¯è¦åœ¨æ­¤åŸºç¡€ä¸Šåˆ†ææ¯ä¸€ä¸ªè¯æ±‡æˆ–è€…çŸ­è¯­åé¢å¯èƒ½å‡ºç°çš„å†…å®¹ï¼Œè¿™é‡Œå…¶å®å¯ä»¥ç†è§£æˆæ„å»ºä¸€ä¸ªæ¦‚ç‡æ¨¡å‹ï¼Œå¾ˆç®€å•ä¸€ä¸ªæ¦‚ç‡æ¨¡å‹ã€‚</p>
<p>ä¸¾ä¾‹è¯´æ˜ï¼Œæˆ‘ä»¬å…ˆæ¥çœ‹åˆšæ‰çš„ç»“æœç”Ÿæˆçš„ä¸€éƒ¨åˆ†
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">and data	1</div><div class="line">and development	1</div><div class="line">and fault	3</div><div class="line">and generating	1</div><div class="line">and less	1</div><div class="line">and providing	1</div><div class="line">and reduce	3</div><div class="line">and scatter	1</div><div class="line">and sorting	1</div></pre></td></tr></table></figure></p>
<p>å…ˆä»…ä»…åˆ†æandä¹‹åå¯èƒ½å‡ºç°çš„è¯æ±‡ï¼Œæ‰€æœ‰çš„æƒ…å†µéƒ½åœ¨è¿™é‡Œæ‘†ç€äº†ã€‚é‚£è¿™æ—¶å€™autocompleteä¼šå¦‚ä½•ç»™å‡ºæ¨èå‘¢ï¼Ÿå¾ˆæ˜¾ç„¶çš„ï¼Œfaultå’Œreduceä¼šæ”¾åˆ°å¤´ä¸¤ä¸ªæ¨èå¯¹å§ï¼Œä¸ºä»€ä¹ˆï¼Ÿè¿™å…¶å®å°±æ˜¯ä¸ªæ¦‚ç‡çš„é—®é¢˜ï¼šandåæ¥ä¸€ä¸ªè¯åœ¨æ–‡ä¸­å‡ºç°äº†<code>1+1+3+1+1+1+3+1+1=13</code>æ¬¡ï¼Œé‚£faultå’Œreduceæ¨èçš„æ¦‚ç‡å°±æ˜¯<code>3/13</code>ï¼Œå‰©ä¸‹çš„æ‰€æœ‰éƒ½æ˜¯<code>1/13</code>çš„æ¦‚ç‡ã€‚å¯¹äº<code>autocomplete</code>ç³»ç»Ÿæ¥è¯´ï¼Œè¿™æ„å‘³ç€å½“ç”¨æˆ·è¾“å…¥äº†andä¹‹åï¼Œå®ƒè®¤ä¸ºç”¨æˆ·æ›´æœ‰å¯èƒ½ç»§ç»­è¾“å…¥çš„æ˜¯faultå’Œreduceï¼Œå› ä¸ºä»å®ƒä»¥å¾€ç»éªŒï¼ˆç³»ç»Ÿæ‰€å¾—åˆ°çš„è¾“å…¥ï¼‰æ¥çœ‹ï¼Œfaultå’Œreduceå‡ºç°çš„é¢‘æ¬¡æ›´å¤šä¸€äº›ï¼Œç›¸æ¯”è¾ƒäºå…¶ä»–çš„ç»“æœã€‚å› æ­¤ï¼Œä¸‹ä¸€æ­¥å·¥ä½œï¼Œæˆ‘ä»¬éœ€è¦å¾—åˆ°ä¸€ä¸ªç±»ä¼¼äº<code>and&lt;\t&gt;data=1</code>è¿™æ ·çš„æ•°æ®è®°å½•æ ·å¼ï¼Œæ¥ç»Ÿè®¡æ‰€æœ‰çš„çŸ­è¯­ä¹‹åè·Ÿéšçš„è¯æ±‡ä»¥åŠå®ƒå‡ºç°çš„é¢‘æ¬¡ã€‚è¿™é‡Œæˆ‘ä»¬ä¹‹æ‰€ä»¥ä¸ç”¨æ¦‚ç‡æ¥è¿›è¡Œè®°å½•ï¼Œæ˜¯å› ä¸ºä»åˆšæ‰çš„è®¡ç®—è¿‡ç¨‹æ¥çœ‹ï¼Œè¯é¢‘å’Œæ¦‚ç‡æ˜¯æ­£ç›¸å…³çš„ï¼Œé‚£ä¹ˆå°±æ²¡å¿…è¦å¤šç®—ä¸€æ­¥è®°å½•æ¦‚ç‡äº†ã€‚</p>
<p><code>prob_mapper.py</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> sys</div><div class="line"><span class="keyword">import</span> string</div><div class="line">    </div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">(threshold)</span>:</span></div><div class="line">    <span class="keyword">for</span> line <span class="keyword">in</span> sys.stdin:</div><div class="line">        words_phrase, count = line.strip().split(<span class="string">"\t"</span>)</div><div class="line">        <span class="keyword">if</span> int(count) &lt; threshold:</div><div class="line">            <span class="keyword">continue</span></div><div class="line">            </div><div class="line">        words = words_phrase.strip().split(<span class="string">" "</span>)</div><div class="line">        <span class="keyword">if</span> len(words) &lt; <span class="number">2</span>:</div><div class="line">            <span class="keyword">continue</span></div><div class="line">            </div><div class="line">        print(<span class="string">"&#123;&#125;\t&#123;&#125;"</span>.format(<span class="string">' '</span>.join(words[:<span class="number">-1</span>]), words[<span class="number">-1</span>] + <span class="string">"="</span> + count))</div><div class="line">        </div><div class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</div><div class="line">    main(<span class="number">2</span>)</div></pre></td></tr></table></figure>
<p>mapperçš„å·¥ä½œå…¶å®å¾ˆç®€å•ï¼ŒåŸºæœ¬æ²¡æœ‰ä»€ä¹ˆéœ€è¦è¯´æ˜çš„ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™é‡Œæˆ‘åŠ å…¥äº†ä¸€ä¸ªthresholdå‚æ•°ï¼Œæ„ä¹‰æ˜¯ä¸ºäº†ç­›é€‰æ‰ä¸€éƒ¨åˆ†å‡ºç°é¢‘æ¬¡å¤ªä½çš„ç»“æœã€‚åˆšæ‰ä¸¾çš„ä¾‹å­é‡Œï¼Œæ¯ä¸ªç»“æœå‡ºç°çš„é¢‘æ¬¡å…¶å®éƒ½ä¸é«˜ï¼Œè¿™æ ·thresholdè‚¯å®šæ˜¯æ²¡ç”¨çš„ï¼Œä½†å®é™…ç”Ÿäº§ä¸­ï¼Œæ¯”å¦‚åƒGoogleå’Œç™¾åº¦è¿™æ ·çš„è¶…å¤§è§„æ¨¡çš„æœç´¢å¼•æ“ï¼Œæ¯å¤©å¯èƒ½æŠ“å–çš„æ•°æ®é‡ååˆ†åºå¤§ã€‚äº‹å®ä¸Šï¼Œæˆ‘ä»¬æ¯æ¬¡åœ¨æœç´¢æ¡†ä¸­è¾“å…¥å†…å®¹ï¼Œå¾—åˆ°çš„è”æƒ³å…¶å®éƒ½åœ¨äºŒåæ¡ä»¥å†…ï¼Œä¸€èˆ¬æ¥è¯´ä¸ä¼šç»™å¤ªå¤šçš„ï¼Œå¤ªå¤šçš„è¯ï¼Œç”¨æˆ·ç­›é€‰èµ·æ¥ä¹Ÿæ˜¯ä¸ªéº»çƒ¦ã€‚é‚£å¯¹äºé‚£äº›åŸºæœ¬å¾ˆå°‘å‡ºç°çš„è¯ç»„ç»„åˆï¼Œä¹Ÿå°±æ²¡å¿…è¦å­˜å‚¨ä¸‹æ¥ï¼Œè¢«æœç´¢åˆ°çš„æ¦‚ç‡å¤ªä½ï¼Œå¦‚æœå…¨éƒ¨éƒ½è®°å½•ä¸‹æ¥ï¼Œå¯¹æ•°æ®åº“çš„å­˜å‚¨å®¹é‡æ˜¯ä¸ªå¾ˆå¤§çš„è´Ÿæ‹…ã€‚</p>
<p><code>prob_reducer.py</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> sys</div><div class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> groupby</div><div class="line"><span class="keyword">from</span> operator <span class="keyword">import</span> itemgetter</div><div class="line">    </div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">parse_output</span><span class="params">(std_input)</span>:</span></div><div class="line">    <span class="keyword">for</span> line <span class="keyword">in</span> std_input:</div><div class="line">        <span class="keyword">yield</span> line.strip().split(<span class="string">"\t"</span>)</div><div class="line">        </div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">(n_gram)</span>:</span></div><div class="line">    data = parse_output(sys.stdin)</div><div class="line">    <span class="keyword">for</span> starting_phrase, group <span class="keyword">in</span> groupby(data, itemgetter(<span class="number">0</span>)):</div><div class="line">        result = &#123;&#125;</div><div class="line">        <span class="keyword">for</span> _, word_count <span class="keyword">in</span> group:</div><div class="line">            word, count = word_count.split(<span class="string">"="</span>)</div><div class="line">            count = int(count)</div><div class="line">            <span class="keyword">if</span> count <span class="keyword">not</span> <span class="keyword">in</span> result:</div><div class="line">                result[count] = []</div><div class="line">            result[count].append(word)</div><div class="line">            </div><div class="line">        i = <span class="number">0</span></div><div class="line">        <span class="keyword">for</span> key, value <span class="keyword">in</span> result.items():</div><div class="line">            <span class="keyword">if</span> i &lt; n_gram:</div><div class="line">                <span class="keyword">for</span> word <span class="keyword">in</span> value:</div><div class="line">                    print(<span class="string">"&#123;&#125;,&#123;&#125;,&#123;&#125;"</span>.format(starting_phrase, word, key))</div><div class="line">                    i += <span class="number">1</span></div><div class="line">                    </div><div class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</div><div class="line">    main(<span class="number">4</span>)</div></pre></td></tr></table></figure>
<p><code>starting_phrase</code>ä»£è¡¨çš„æ˜¯ç”¨æˆ·è¾“å…¥çš„éƒ¨åˆ†ï¼Œ<code>following_word</code>ä»£è¡¨çš„æ˜¯åé¢å¯èƒ½å‡ºç°çš„è¯æ±‡ï¼Œ<code>count</code>é¡¾åæ€ä¹‰å°±æ˜¯æŒ‡è¯é¢‘äº†ã€‚åœ¨reducerä¸­ï¼Œæˆ‘ä»¬å…ˆæŒ‰ç…§è¯é¢‘çš„ä¸åŒå°†å¯èƒ½å‡ºç°çš„è¯æ±‡åˆ†ç»„æ”¾ç½®ï¼Œç„¶åå†æ ¹æ®æˆ‘ä»¬éœ€è¦çš„N-Gramå¤§å°æ¥ä¾æ¬¡è¾“å‡ºã€‚è¿™é‡Œçš„å‚æ•°n_gramå’Œä¹‹å‰n_gram_mapperé‡Œçš„n_gramæ„æ€ä¸€æ ·ï¼Œä½†å–å€¼å¯ä»¥ä¸åŒã€‚</p>
<hr>
<h3 id="é¢„æµ‹æ¦‚ç‡çš„æµ‹è¯•ç»“æœ"><a href="#é¢„æµ‹æ¦‚ç‡çš„æµ‹è¯•ç»“æœ" class="headerlink" title="é¢„æµ‹æ¦‚ç‡çš„æµ‹è¯•ç»“æœ"></a>é¢„æµ‹æ¦‚ç‡çš„æµ‹è¯•ç»“æœ</h3><p>ä¸‹é¢æˆ‘ä»¬æ¥çœ‹çœ‹æœ¬åœ°æµ‹è¯•ç»“æœå§ï¼Œå°±ç”¨ä¸Šä¸€æ­¥n_gram_reducerå¾—å‡ºçš„ç»“æœç»§ç»­æ“ä½œã€‚</p>
<figure class="highlight console"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line">root@hadoop:~/src/p2py# cat result.txt | ./prob_mapper.py | ./prob_reducer.py </div><div class="line">and,fault,3</div><div class="line">and fault,tolerance,3</div><div class="line">and,reduce,3</div><div class="line">and reduce,functions,2</div><div class="line">big,data,2</div><div class="line">communication,cost,2</div><div class="line">fault,tolerance,3</div><div class="line">is,a,2</div><div class="line">map,and,3</div><div class="line">map and,reduce,3</div><div class="line">map and reduce,functions,2</div><div class="line">mapreduce,framework,3</div><div class="line">method,that,2</div><div class="line">method that,performs,2</div><div class="line">model,and,2</div><div class="line">model,is,2</div><div class="line">not,the,2</div><div class="line">of,the,4</div><div class="line">of the,mapreduce,2</div><div class="line">of the mapreduce,framework,2</div><div class="line">optimizing,the,2</div><div class="line">reduce,functions,2</div><div class="line">such,as,2</div><div class="line">that,performs,2</div><div class="line">the,mapreduce,4</div><div class="line">the mapreduce,framework,3</div><div class="line">the,various,2</div></pre></td></tr></table></figure>
<p>å› ä¸ºä¹‹å‰åœ¨mapperé‡Œæˆ‘ä»¬å°†thresholdè®¾ç½®ä¸º2ï¼Œè¿™é‡Œæˆ‘ä»¬å°±å¯ä»¥çœ‹åˆ°ç»“æœä¸­åªæœ‰è¯é¢‘ä¸å°äº2æ¬¡çš„ã€‚</p>
<h3 id="è¿è¡Œåœ¨Hadoopä¸Š"><a href="#è¿è¡Œåœ¨Hadoopä¸Š" class="headerlink" title="è¿è¡Œåœ¨Hadoopä¸Š"></a>è¿è¡Œåœ¨Hadoopä¸Š</h3><p>åˆšæ‰åœ¨æœ¬åœ°è·‘è¿‡äº†ä¹‹åï¼Œä¸‹é¢æ¥è¿›è¡ŒHadoopä¸Šçš„æµ‹è¯•ã€‚ä¸ºäº†æ–¹ä¾¿å¿«æ·ï¼Œæˆ‘ç¼–å†™äº†ä¸€ä¸ªscriptæ¥è¿è¡Œä¸¤å¯¹mapperå’Œreducerï¼Œæœ€åæŠŠå¾—åˆ°çš„æ•°æ®ä»HDFSé‡Œå¯¼å‡ºåˆ°æœ¬åœ°ã€‚
<figure class="highlight console"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line">root@hadoop:~/src/p2py# ./run_script.sh </div><div class="line">    </div><div class="line">Cleaning old results in /output...</div><div class="line">17/10/10 01:30:20 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.</div><div class="line">Deleted /output</div><div class="line">    </div><div class="line">Running python in Hadoop by hadoop streaming...</div><div class="line">    </div><div class="line">packageJobJar: [/tmp/hadoop-unjar5398292596529368576/] [] /tmp/streamjob5913697815224381390.jar tmpDir=null</div><div class="line">17/10/10 01:30:22 INFO client.RMProxy: Connecting to ResourceManager at hadoop-master/172.18.0.2:8032</div><div class="line">17/10/10 01:30:22 INFO client.RMProxy: Connecting to ResourceManager at hadoop-master/172.18.0.2:8032</div><div class="line">17/10/10 01:30:23 INFO mapred.FileInputFormat: Total input paths to process : 1</div><div class="line">...</div><div class="line">17/10/10 01:30:49 INFO streaming.StreamJob: Output directory: /output/first</div><div class="line">    </div><div class="line">Running 2nd mapper and reducer...</div><div class="line">    </div><div class="line">packageJobJar: [/tmp/hadoop-unjar6814698868258273333/] [] /tmp/streamjob6470458846508985375.jar tmpDir=null</div><div class="line">17/10/10 01:30:51 INFO client.RMProxy: Connecting to ResourceManager at hadoop-master/172.18.0.2:8032</div><div class="line">17/10/10 01:30:51 INFO client.RMProxy: Connecting to ResourceManager at hadoop-master/172.18.0.2:8032</div><div class="line">17/10/10 01:30:52 INFO mapred.FileInputFormat: Total input paths to process : 1</div><div class="line">...</div><div class="line">17/10/10 01:31:13 INFO streaming.StreamJob: Output directory: /output/second</div><div class="line">    </div><div class="line">Moving outputs from HDFS to local...</div><div class="line">    </div><div class="line">Got the output!</div></pre></td></tr></table></figure></p>
<p>ä¸€åˆ‡é¡ºåˆ©è¿è¡Œï¼æœ€ç»ˆç»“æœä¹Ÿè¢«æˆåŠŸå¯¼å‡ºåˆ°æœ¬åœ°ã€‚</p>
<hr>
<h2 id="å¯¼å…¥æ•°æ®åº“"><a href="#å¯¼å…¥æ•°æ®åº“" class="headerlink" title="å¯¼å…¥æ•°æ®åº“"></a>å¯¼å…¥æ•°æ®åº“</h2><p>å…¶å®åˆ°ä¸Šä¸€å°èŠ‚ï¼ŒMapReduceçš„å·¥ä½œå°±éƒ½åšå®Œäº†ï¼Œä½†ä¸ºäº†è®©<code>autocomplete</code>å¯ä»¥å±•ç°å‡ºåº”æœ‰çš„æ•ˆæœï¼Œè¿™é‡Œè¿˜éœ€è¦å°†åˆšæ‰ç”Ÿæˆçš„æ•°æ®å¯¼å‡ºåˆ°æ•°æ®åº“ä¸­ï¼Œä»¥ä¾¿ä¹‹åå’ŒWebç»“åˆæ¥ä½“ç°åŠŸèƒ½ã€‚</p>
<p>æ•°æ®åº“æˆ‘ç”¨çš„æ˜¯MySQLï¼Œå¤§å®¶å¯ä»¥ä»»æ„é€‰æ‹©ã€‚ä¸‹é¢æ˜¯æˆ‘çš„æ•°æ®åº“æ“ä½œä»£ç ï¼š
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> sys</div><div class="line"><span class="keyword">import</span> MySQLdb <span class="keyword">as</span> mdb</div><div class="line">    </div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">read_data</span><span class="params">(file)</span>:</span></div><div class="line">    <span class="keyword">for</span> line <span class="keyword">in</span> file.readlines():</div><div class="line">        <span class="keyword">yield</span> line.strip().split(<span class="string">","</span>)</div><div class="line">        </div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">(input_data)</span>:</span></div><div class="line">    <span class="keyword">with</span> mdb.connect(<span class="string">'localhost'</span>, <span class="string">'username'</span>, <span class="string">'password'</span>, <span class="string">'dbname'</span>) <span class="keyword">as</span> cur:</div><div class="line">        cur.execute(<span class="string">"DROP TABLE IF EXISTS output"</span>)</div><div class="line">        cur.execute(</div><div class="line">            <span class="string">"CREATE TABLE output(starting_phrase VARCHAR(250), following_word VARCHAR(250), count INT)"</span>)</div><div class="line">        <span class="keyword">with</span> open(input_data, <span class="string">'r'</span>) <span class="keyword">as</span> file:</div><div class="line">            <span class="keyword">for</span> starting_phrase, following_word, count <span class="keyword">in</span> read_data(file):</div><div class="line">                cur.execute(</div><div class="line">                    <span class="string">"INSERT INTO output(starting_phrase, following_word, count) \</span></div><div class="line"><span class="string">                     VALUES('&#123;&#125;', '&#123;&#125;', &#123;&#125;)"</span>.format(starting_phrase, following_word, count))</div><div class="line">                     </div><div class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</div><div class="line">    main(<span class="string">"output"</span>)</div></pre></td></tr></table></figure></p>
<p>æ•°æ®åº“ä¸­æ˜¾ç¤ºçš„ç»“æœï¼š
<img src="/images/autocomplete/database.png" alt="database"></p>
<hr>
<h2 id="å±•ç¤ºç»“æœ"><a href="#å±•ç¤ºç»“æœ" class="headerlink" title="å±•ç¤ºç»“æœ"></a>å±•ç¤ºç»“æœ</h2><p>æˆ‘ç®€å•åšäº†ä¸€ä¸ªWebå±•ç¤ºçš„é¡µé¢ï¼ŒåŸºäºAjaxå’ŒPHPï¼Œè¿æ¥æ•°æ®åº“åï¼Œæµ‹è¯•ç»“æœå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š
<img src="/images/autocomplete/ggif.gif" alt="test"></p>
<hr>
<h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>æœ¬æ–‡ä»é›¶å¼€å§‹ï¼Œä¸å¤ªè¯¦ç»†çš„ä»‹ç»äº†<code>autocomplete</code>çš„å·¥ä½œåŸç†ï¼Œä»¥åŠå¦‚ä½•åˆ©ç”¨Pythonå’ŒMapReduceæ¥å¤„ç†æ•°æ®ã€‚ç›¸æ¯”è¾ƒJavaå®ç°è¿™äº›å†…å®¹è€Œè¨€ï¼ŒPythonç¡®å®éœ€è¦æ³¨æ„æ›´å¤šçš„ç»†èŠ‚ï¼Œæ¯•ç«ŸJavaæ˜¯HadoopåŸç”Ÿç¯å¢ƒï¼Œconfigurationçš„é…ç½®çœŸçš„æ˜¯æ–¹ä¾¿ã€‚ä¹‹å‰åšwordcountæ—¶æ²¡æœ‰è§‰å¾—Python+Hadoop Streamingçš„æ–¹å¼æœ‰ä»€ä¹ˆé—®é¢˜ï¼Œå› ä¸ºPythonå¤©ç”Ÿçš„ç®€æ´ç‰¹è´¨ï¼Œæ„Ÿè§‰æ¯”Javaå•°é‡Œå•°å—¦çš„èˆ’æœå¤šäº†ã€‚ä½†è¿™æ¬¡çš„ä»£ç å®ç°ä¸Šå°±çœ‹å‡ºç«¯å€ªäº†ï¼ŒPythonä¸‹æ›´å¤šçš„ç»†èŠ‚éƒ¨åˆ†éœ€è¦å¼€å‘è€…è‡ªå·±å†™ä»£ç å»ç»´æŠ¤ï¼Œå°±åƒä¸åŒçš„mapperï¼Œreducerä¹‹é—´çš„æ•°æ®ä¼ è¾“ï¼Œè¿˜æœ‰è¾“å‡ºåˆ°æ•°æ®åº“ä¿å­˜ã€‚</p>
<p>ä¸€è·¯ä»å¤´çœ‹åˆ°è¿™é‡Œçš„æœ‹å‹ï¼Œæ„Ÿè°¢ä½ çš„é˜…è¯»ï¼Œå¦‚æœæœ‰ç–‘æƒ‘ï¼Œæ¬¢è¿ğŸ‘‡ä¸‹é¢ç•™è¨€ï¼Œå¦‚æœæ–‡ç« ä¸­æœ‰ä»€ä¹ˆä¸å¯¹çš„åœ°æ–¹ï¼Œä¹Ÿæ¬¢è¿æ‰¹è¯„å’ŒæŒ‡æ­£ã€‚</p>
<hr>
<h1 id="Related-Links"><a href="#Related-Links" class="headerlink" title="Related Links"></a>Related Links</h1><ol>
<li><a href="http://blog.sciencenet.cn/blog-713101-797384.html" target="_blank" rel="external">N-gramçš„åŸç†ã€ç”¨é€”å’Œç ”ç©¶</a></li>
</ol>

                </div>
                
                    <div class="article-tags tags">
                        
                            <a href="/tags/Python/">
                                Python
                            </a>
                            
                            <a href="/tags/Hadoop/">
                                Hadoop
                            </a>
                            
                            <a href="/tags/MapReduce/">
                                MapReduce
                            </a>
                            
                    </div>
                    

                        
                            <div class="art-item-footer">
                                
                                        
                                            <span class="art-item-right">nextï¼š<a href="/2017/10/02/Data-analysis-in-Python-by-Pandas/" rel="next"  title="Data analysis in Python by Pandas">
						Data analysis in Python by Pandas
					</a><i class="icon icon-chevron-thin-right"></i></span>
                                            
                            </div>
                            
            </section>
            
                <section id="comments">
                    <div id="disqus_thread"></div>

                    <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
                </section>
                
    
</article>
<script>
    window.subData = {
        title: 'ç”¨Pythonåœ¨Hadoopä¸Šå®ç°æœç´¢è‡ªåŠ¨è¡¥å…¨',
        tools: true
    }

</script>

      </div>
      <aside class='l_side'>
        
  <section class='m_widget about'>
    
        <img class='avatar waves-image' src='/images/avatar.png' />
        
            <div class='header'>
                Yuan Zhang
            </div>
            <div class='content'>
                <div class='desc'>
                    Information -&gt; Knowledge -&gt; Wisdom
                </div>
            </div>
</section>


  <section class='m_widget links'>
<div class='header'>Links</div>
<div class='content'>
    <ul class="entry">
    
    </ul>
</div>
</section>

  <section class='m_widget categories'>
<div class='header'>Categories</div>
<div class='content'>
    
    <ul class="entry">
    
        <li><a class="flat-box" href="/categories/Big-Data/"><div class='name'>Big Data</div><div class='badget'>2</div></a></li>
    
        <li><a class="flat-box" href="/categories/Data-analysis/"><div class='name'>Data analysis</div><div class='badget'>1</div></a></li>
    
        <li><a class="flat-box" href="/categories/general/"><div class='name'>general</div><div class='badget'>2</div></a></li>
    
    </ul>
    
</div>
</section>

  
<div class="m_widget tagcloud">
    <div class="header">Tags</div>
    <div class='content'>
        <a href="/tags/Blog/" style="font-size: 14px; color: #808080">Blog</a> <a href="/tags/Data-analysis/" style="font-size: 14px; color: #808080">Data analysis</a> <a href="/tags/Docker/" style="font-size: 14px; color: #808080">Docker</a> <a href="/tags/First/" style="font-size: 14px; color: #808080">First</a> <a href="/tags/Hadoop/" style="font-size: 17px; color: #404040">Hadoop</a> <a href="/tags/Heroku/" style="font-size: 14px; color: #808080">Heroku</a> <a href="/tags/MapReduce/" style="font-size: 17px; color: #404040">MapReduce</a> <a href="/tags/Netlify/" style="font-size: 14px; color: #808080">Netlify</a> <a href="/tags/Pandas/" style="font-size: 14px; color: #808080">Pandas</a> <a href="/tags/Python/" style="font-size: 20px; color: #000">Python</a> <a href="/tags/migrate/" style="font-size: 14px; color: #808080">migrate</a> <a href="/tags/static-site/" style="font-size: 14px; color: #808080">static site</a>
    </div>
</div>



      </aside>
      <script>setLoadingBarProgress(60);</script>
    </div>
  </div>
  <footer id="footer" class="clearfix">

	<div class="social-wrapper">
  	
      
        <a href="https://github.com/rocheers" class="social github"
          target="_blank" rel="external">
          <span class="icon icon-github"></span>
        </a>
      
        <a href="https://twitter.com/rocheers" class="social twitter"
          target="_blank" rel="external">
          <span class="icon icon-twitter"></span>
        </a>
      
        <a href="/atom.xml" class="social rss"
          target="_blank" rel="external">
          <span class="icon icon-rss"></span>
        </a>
      
    
  </div>
  
<!--  <div>Theme <a href='https://github.com/stkevintan/hexo-theme-material-flow' class="codename">MaterialFlow</a> designed by <a href="http://keyin.me/" target="_blank">Kevin Tan</a>.</div>-->
  
</footer>


  <script>setLoadingBarProgress(80);</script>
  
    <script>
        var disqus_shortname = 'yuanhome';
        
            var disqus_config = function () {
                this.page.url = 'http://yuannow.com/2017/10/09/Implement-Search-Auto-Complete-by-Python-Hadoop/';
                this.page.identifier = '_posts/Implement-Search-Auto-Complete-by-Python-Hadoop.md';
            };
        
        (function() { // DON'T EDIT BELOW THIS LINE
            var d = document,
                s = d.createElement('script');
            s.src = "//yuanhome.disqus.com/embed.js";
            s.setAttribute('data-timestamp', +new Date());
            (d.head || d.body).appendChild(s);
        })();

    </script>

    <script id="dsq-count-scr" src="//yuanhome.disqus.com/count.js" async></script>


<script src="//apps.bdimg.com/libs/jquery/2.1.4/jquery.min.js"></script>
<script src='//cdn.bootcss.com/node-waves/0.7.5/waves.min.js'></script>
<script src="//cdn.bootcss.com/scrollReveal.js/3.3.2/scrollreveal.min.js"></script>
<script src="/js/jquery.fitvids.js"></script>
    <script>
        var GOOGLE_CUSTOM_SEARCH_API_KEY = "";
        var GOOGLE_CUSTOM_SEARCH_ENGINE_ID = "";
        var ALGOLIA_API_KEY = "";
        var ALGOLIA_APP_ID = "";
        var ALGOLIA_INDEX_NAME = "";
        var AZURE_SERVICE_NAME = "";
        var AZURE_INDEX_NAME = "";
        var AZURE_QUERY_KEY = "";
        var BAIDU_API_ID = "";
        var SEARCH_SERVICE = "hexo";
        var ROOT = "/" || "/";
        if (!ROOT.endsWith('/')) ROOT += '/';

    </script>
<script src="/js/search.js"></script>
<script src="/js/app.js"></script>

  <script>setLoadingBarProgress(100);</script>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ["$","$"], ["\\(","\\)"] ],
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
            processEscapes: true
        }
    });
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax();
        for (var i = 0; i < all.length; ++i)
            all[i].SourceElement().parentNode.className += ' has-jax';
    });
</script>
<script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
</body>
</html>
